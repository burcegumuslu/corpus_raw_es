{"title": "PDF", "author": "PDF", "url": "http://deeea.urv.cat/public/PROPOSTES/pub/pdf/1515pub.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "id": "PDF", "license": "PDF", "body": "PDF", "comments": "PDF", "commentsbody": "PDF", "raw_text": "PDF", "text": "     \n  \n \n   \nMONITORIZACI\u00d3N WIRELESS DE CONSTANTES \nVITALES DE UN BEB\u00c9 \n \n \n     \nTITULACI\u00d3N: INGENIER\u00cdA AUTOM\u00c1 TICA Y ELECTR\u00d3NICA INDUSTRIAL \n \n \n \nAUTOR:  Miguel Mar\u00eda Garc\u00eda Jim\u00e9nez \nDIRECTOR:  Enrique Cant\u00f3 Navarro \n  \nFECHA: Mayo / 2011. \n \n  \nMonitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   2         \n INDICE:  \n1 Introducci\u00f3n y Objetivos ....................................................................................... 4 \n1.1 Introducci\u00f3n................................................................................................... 4 1.2 Antecedentes.................................................................................................. 5 1.3 Objetivo del Proyecto .................................................................................... 8 \n2 Memoria descriptiva.............................................................................................. 9 \n2.1 Nociones sobre la Temperatura Corporal...................................................... 9 \n2.1.1 Definici\u00f3n .............................................................................................. 9 \n2.1.2 Zonas de Lectura ................................................................................. 10 \n2.1.3 Valores, Alteraciones y Terminolog\u00eda................................................. 10 \n2.2 M\u00f3dulo 1: Equipo Inal\u00e1mbrico c on Sensor de Temperatura....................... 12 \n2.2.1 Diagrama de Bloques........................................................................... 12 \n2.3 Medici\u00f3n de la Temperatur a Corporal. Sensores. ....................................... 14 \n2.3.1 Termopares .......................................................................................... 14 2.3.2 RTD\u2019s. ................................................................................................. 18 2.3.3 Termistores .......................................................................................... 22 2.3.4 Acondicionamiento de la Se\u00f1al. .......................................................... 26 2.3.5 Sensores de Temperatur a con Semiconductores. ................................ 27 \n2.3.6 Elecci\u00f3n Final...................................................................................... 30 \n2.4 Comunicaci\u00f3n Wireless entre M\u00f3dulos....................................................... 33 \n2.4.1 ZigBee ................................................................................................. 33 2.4.2 IEEE 802.15.4 ..................................................................................... 35 \n2.4.2.1 Arquitectura de los Protocolos........................................................ 36 2.4.2.2 Nivel F\u00edsico..................................................................................... 36 2.4.2.3 Nivel Enlace de Datos..................................................................... 37 \n2.4.3 Especificaci\u00f3n Zigbee.......................................................................... 38 2.4.4 Dispositivos que Constituyen una Red Zigbee.................................... 39 2.4.5 Comunicaciones y Descubrimie ntos de Dispositivos.......................... 40 \n2.4.6 Modos de Funcionamiento .................................................................. 40 2.4.7 Modelo de Redes Zigbee ..................................................................... 43 2.4.8 Otros Medios de Transmisi\u00f3n de Datos y Elecci\u00f3n Final ................... 46 \n2.5 M\u00f3dulos Zigbee en el Mercado................................................................... 51 \n2.5.1 Elecci\u00f3n Final...................................................................................... 52 \n2.6 El Microcontrolador .................................................................................... 54 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   32.6.1 Funci\u00f3n ................................................................................................ 54 \n2.6.2 Requisitos ............................................................................................ 54 2.6.3 Alternativas.......................................................................................... 56 2.6.4 Elecci\u00f3n Final...................................................................................... 56 \n2.7 M\u00f3dulo 2: Equipo de Sobremesa ................................................................ 58 \n2.7.1 Funciones:............................................................................................ 58 2.7.2 Diagrama de Bloques: ......................................................................... 58 2.7.3 El m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica. ........................................... 59 2.7.4 El m\u00f3dulo LCD. .................................................................................. 59 \n2.7.5 Pulsadores............................................................................................ 63 \n2.7.6 Zumbador ............................................................................................ 64 2.7.7 Alimentaci\u00f3n ....................................................................................... 64 \n2.8 Manual de Funcionamiento ......................................................................... 67 \n3 MEMORIA DE C\u00c1LCULO................................................................................ 68 \n3.1 Diagrama de Flujo M\u00f3dulo 1: Equi po Inal\u00e1mbrico con Sensor de T\u00aa......... 68 \n3.2 Diagrama de Flujo M\u00f3dulo 2: M\u00f3dulo de Sobremesa ................................ 74 3.3 Bater\u00eda M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico ...................................................... 83 3.4 Datos experimentales................................................................................... 85 \n4 PLANOS.............................................................................................................. 86 5 PRESUPUESTO.................................................................................................. 93 \n5.1 Mediciones .................................................................................................. 93 5.2 Cuadro de Precios Unitarios........................................................................ 93 5.3 Cuadro de Precios Descompuestos.............................................................. 95 5.4 Presupuesto.................................................................................................. 99 5.5 Resumen del Presupuesto .......................................................................... 100 \n6 CONCLUSIONES............................................................................................. 101 7 ANEXOS........................................................................................................... 103 \n7.1 Programa en CCS M\u00f3dulo 1...................................................................... 103 7.2 Programa en CCS M\u00f3dulo 2...................................................................... 109 7.3 Ficheros ..................................................................................................... 127 \n \n \n   Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   41 Introducci\u00f3n y Objetivos \n1.1 Introducci\u00f3n \nHan pasado alrededor de 2.500 a\u00f1os desd e que se fund\u00f3 la primera Escuela de \nMedicina Occidental. Muchos han sido los m\u00e9di cos e investigadores que han ido desde la \nanestesia a la vacuna, pasando por el endosco pio y los antibi\u00f3ticos. Numerosos han sido \nlos inventos y descubrimientos que se han producido en el \u00faltimo siglo y medio que han \npermitido sentar las bases de la actual ciencia m\u00e9dica. \n Para muchos,  estos avances han pasado inadvertidos a lo largo de los a\u00f1os debido al \ntrepidante ritmo tecnol\u00f3gico que le ha dado la  tecnolog\u00eda. Hace s\u00f3lo unos ciento cincuenta \na\u00f1os parec\u00eda casi un sue\u00f1o realizar una operaci \u00f3n quir\u00fargica sin que el  paciente sufriera. \nHoy en d\u00eda, las intervenciones resultan menos traum\u00e1ticas y lo s per\u00edodos postoperatorios se \nhan reducido notablemente gracias a la presenci a de la tecnolog\u00eda en el ejercicio de la \nmedicina.  \n Se han aplicado cada vez m\u00e1s y m\u00e1s tec nolog\u00edas para logr ar las condiciones \n\u00f3ptimas en cualquier intervenci\u00f3n quir\u00fargica. Se est\u00e1n utilizando los avances no s\u00f3lo para \ncurar sino tambi\u00e9n para prevenir enfermedades  as\u00ed como para todo tipo de investigaciones \nm\u00e9dicas, las cuales, gracias a la tecnolog\u00eda ha n realizado importantes descubrimientos. Los \nexpertos se han ocupado de la incorporaci\u00f3n de los avances t ecnol\u00f3gicos en la pr\u00e1ctica de \nla medicina, por lo que se prev\u00e9 un cambio radical en la ciencia m\u00e9dica del futuro. \n En la actualidad, la tecnolog\u00eda m\u00e9dica ha  traspasado la frontera de hospitales y \ncentros de salud y d\u00eda a d\u00eda se incorporan nue vos equipos que mejoran la calidad de vida \nde los ciudadanos. \n Estos equipos basan su \u00e9xito en su senci llez de uso, la calidad y precisi\u00f3n de sus \nmedidas y su bajo coste. Como ejemplos, pode mos citar los medidores de tensi\u00f3n arterial \nde mu\u00f1eca, term\u00f3metros digitales, medidor es de glucosa en sangre, puls\u00edmetros, \naud\u00edfonos\u2026 \n En el presente proyecto, se implementar\u00e1 un dispositivo de medici\u00f3n de \ntemperatura de bajo coste y wireless, que perm itir\u00e1 conocer la temperatura de una persona, \nadulta o beb\u00e9,  a distancia.  \n \n \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   51.2 Antecedentes \nLa temperatura corporal es una de las cons tantes vitales que nos indica el estado de \nsalud de una persona, ya sea en su estado adulto o durante la ni\u00f1ez. \n La fiebre (temperatura corporal elevada)  es uno de los s\u00edntomas que nos indican \nenfermedad. Existen en el mercado muchos tipos de term\u00f3metros para medir la temperatura, adem\u00e1s de diferentes m\u00e9todos , cada uno ofrece ventajas y desventajas de \nacuerdo a la edad, colaboraci\u00f3n y personalidad de la persona o ni\u00f1o a la que se va a medir \nla temperatura. \n Los term\u00f3metros que podemos en contrar son los siguientes: \n \nTemperatura t\u00e1ctil. \nEs la medici\u00f3n de la temperatura utili zando el tacto tocando a la persona, este \nm\u00e9todo no ofrece ninguna garant\u00eda acerca del nive l exacto de la temperatura, simplemente \nes una forma de saber si tiene fiebre para luego usar un term\u00f3metro para la medici\u00f3n.  \n \nTerm\u00f3metro de vidrio. \nEstos term\u00f3metros ya no se encuentran en el mercado, aunque su utilizaci\u00f3n estuvo \nmuy extendida hasta su prohibici\u00f3n. Pueden medi r la temperara de forma precisa y de f\u00e1cil \nmedici\u00f3n, pero requieren mayor tiempo para ha cer las mediciones (oral y rectal 3 minutos, \naxilar 8 a 10 minutos). Al ser de vidrio pueden romperse con facilidad, por lo que no son \naconsejados debido a que el vidrio roto y su contenido de mercurio (t\u00f3xico) son da\u00f1inos \npara la salud, tienen la punta s\u00f3lida y son de dif\u00edcil lectura porque se debe buscar el \u00e1ngulo \nen el cual se puede visualizar la banda de mercurio. \n \n \nFigura 1.  Term\u00f3metro de vidrio \n \nTerm\u00f3metros digitales \nSirven para medir la fiebre de forma precis a, r\u00e1pida, segura y f\u00e1 cil de leer y f\u00e1cil \nmedici\u00f3n. Precisa porque utilizan sensores de temperatura; r\u00e1pida porque basta un \nminuto para obtener la medida; segura porque  cuentan con una punta flexible, donde se \nubica el sensor, lo que les da  menor probabilidad a romperse y no contienen mercurio; y \nf\u00e1ciles de leer porque cuentan con una pant alla digital que muestra la temperatura \nobtenida de la medici\u00f3n.   \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   6\n \nFigura 2. Term\u00f3metro digital  \n \nTerm\u00f3metros de o\u00eddo \n Son los m\u00e1s costosos, estos term\u00f3metros miden el calor emitido en el t\u00edmpano y \nel tejido circundante en el interior del conduc to auditivo por medio de un infrarrojo, se \nobtiene una medici\u00f3n precisa siempre y cuando  se haya colocado correctamente dentro \ndel canal auditivo, de lo contra rio, el infrarrojo no podr\u00e1 medi r la temperatura o arrojar\u00e1 \nun dato err\u00f3neo. El tiempo de la medici\u00f3n es el  m\u00e1s r\u00e1pido, y son f\u00e1cile s de leer al contar \ncon una pantalla digital.   \n \nFigura 3.  Term\u00f3metro de o\u00eddo \n \n Term\u00f3metros de tira pl\u00e1stica \nEs un dispositivo que se coloca en la frente de los ni\u00f1os y dan valores de \ntemperatura poco confiables, son de f\u00e1cil lectura pero al igua l que el m\u00e9todo de medici\u00f3n \nde la temperatura t\u00e1ctil, le i ndican si el ni\u00f1o tiene fiebre, y es un anticipo al  uso de otro \ntipo de term\u00f3metro. \n \n \nFigura 4.  Term\u00f3metros de tira pl\u00e1stica \n \nTerm\u00f3metros de chupete \nDispositivo que se coloca en los chupone s de los beb\u00e9s, sus valores tambi\u00e9n son \npoco confiables, al igual que la temperatura t\u00e1ctil y los term\u00f3metros de tira pl\u00e1stica s\u00f3lo \nindican si el ni\u00f1o tiene fiebre \n  \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   7\n \nFigura 5.  Term\u00f3metro de chupete \n \n Term\u00f3metro infrarrojo \n Este tipo de term\u00f3metros no necesitan del contacto f\u00edsico para medir la \ntemperatura. En pocos segundos, a partir de  sensores infrarrojos permiten obtener un \nvalor de la temperatura de la piel sobre la cu al est\u00e1n dirigidos.  La  distancia a la que se \ndebe encontrar el term\u00f3metro var\u00ed a entre los 0\u20195 cm. a los 10 cm. \n \n \nFigura 6.  Term\u00f3metro infrarrojo \n \nA pesar de existen multitud de tipos de term\u00f3metros, todos tienen un elemento \ncom\u00fan de funcionamiento: \n - En personas enfermas o ni\u00f1os, es necesaria la presencia de un \nadulto para realizar la medici\u00f3n. \n - La lectura de la medici\u00f3n se realiza al lado de la persona de la cual \nse quiere saber su temperatura. \n \n    \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   81.3 Objetivo del Proyecto \nTodos los padres han vivido alguna vez la siguiente situaci\u00f3n: despertarse a media \nnoche para encontrar a su hijo parado al lado de su cama, rojo, acalorado y sudando. La \nfrente de su peque\u00f1o est\u00e1 caliente. De inme diato, sospechan que su hijo tiene fiebre. \n A partir de ese momento, la m\u00e1xima preo cupaci\u00f3n de los padres es vigilar la \ntemperatura corporal de su hijo. Esto implica de spertar al ni\u00f1o varias veces para tomarle la \ntemperatura. \n \nActualmente, todos los term\u00f3metros existentes en el mercado necesitan de un \nadulto para medir la temperatura en ni\u00f1os y en bebes. Durante el d\u00eda, la necesidad de estar \ncon el ni\u00f1o para medir su temperatura puede parecer no muy importante, sin embargo, por la noche, implica que tanto el ni \u00f1o como el adulto, deben despertarse varias veces a lo \nlargo de la noche para controla r la temperatura. Este hecho, hace que tanto los padres como \nlos ni\u00f1os no consigan descansar, co menzando el nuevo d\u00eda m\u00e1s agotados. \n \nEn el presente proyecto, se desea impl ementar un dispositivo que monitorice la \ntemperatura corporal de un beb\u00e9 o un ni\u00f1o , y que env\u00ede esta medici\u00f3n mediante un \nsistema inal\u00e1mbrico a otro di spositivo el cual avisar\u00e1 a los padres cuando el ni\u00f1o \npresente fiebre. \n \nPara conseguir este cometido, se desarrollar\u00e1n dos dispositivos, un equipo de \nsobremesa y un equipo a bater\u00eda, ambos se  comunicar\u00e1n de manera inal\u00e1mbrica. \n El dispositivo de sobremesa actuar\u00e1 de interfaz con los usuarios. Su misi\u00f3n es \nrecibir la informaci\u00f3n que le env\u00ede el equipo de bater\u00eda, mostrarla por pantalla y avisar en \ncaso de fiebre. \n El dispositivo de bate r\u00eda se encontrar\u00e1 en permanente contacto con el ni\u00f1o, realizar\u00e1 \nla medici\u00f3n de temperatura y la e nviar\u00e1 al dispositivo de sobremesa. \n En ambos equipos, se buscar\u00e1 su bajo c onsumo, bajo coste, peque\u00f1as dimensiones \ny alta precisi\u00f3n y resoluci\u00f3n, si endo estas caracter\u00eds ticas m\u00e1s cr\u00edticas en el caso del \ndispositivo a bater\u00edas. \n \n   \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   92 Memoria descriptiva \n2.1 Nociones sobre la Temperatura Corporal \n2.1.1 Definici\u00f3n \nLa temperatura es una magnitud que refleja el nivel t\u00e9rmico de un cuerpo, es decir, \nsu capacidad para ceder energ\u00eda calor\u00edfica. La temperatura de pende del movimiento de las \nmol\u00e9culas que componen a la sustancia, si \u00e9s tas est\u00e1n en mayor o menor movimiento, ser\u00e1 \nmayor o menor su temperatura respectivamente, es decir, estar\u00e1 m\u00e1s o menos caliente. El \ncalor es la energ\u00eda que se pierde o gana en  ciertos procesos. Por tanto, los t\u00e9rminos de \ntemperatura y calor, aunque relaci onados entre s\u00ed, se refieren  a conceptos diferentes: la \ntemperatura es una propiedad de un cuerpo y el calor es un flujo de energ\u00eda entre dos \ncuerpos a diferentes temperaturas. \n \nLa temperatura corporal es la medida del grado de calor de un organismo, y \ndesempe\u00f1a un papel importante para determinar  las condiciones de supervivencia de los \nseres vivos. As\u00ed, los seres humanos necesitan un rango muy limitado de temperatura corporal para poder sobrevivir, y tienen que estar protegidos de temperaturas extremas. \n \nLa temperatura corporal es el equilibrio entre la producci\u00f3n de calor por el cuerpo y \nsu p\u00e9rdida. El centro termorregulador est\u00e1 s ituado en el hipot\u00e1lamo. Cuando la temperatura \nsobrepasa el nivel normal se activan mecanis mos como vaso dilata ci\u00f3n, hiperventilaci\u00f3n y \nsudoraci\u00f3n que promueven la p\u00e9rd ida de calor. Si por el cont rario, la temperatura cae por \ndebajo del nivel normal se activan mecan ismos como aumento del metabolismo y \ncontracciones espasm\u00f3dicas que producen los escalofr\u00edos. \n \nPara poder hablar de temperatura normal del cuerpo, debemos establecer una \ndiferencia entre la temperat ura de los tejidos profundos del cuerpo y la temperatura \ncut\u00e1nea. Esto justifica establecer una divisi \u00f3n: temperatura interna, con una temperatura \nconstante y fuertemente regulada; y temperatur a cut\u00e1nea de los tejidos perif\u00e9ricos, cuya \ntemperatura puede oscilar dentro de unos l\u00edmites amplios, dependiendo tanto de la \ntemperatura del ambiente como del grado de defensa ante la p\u00e9rdida de calor y de las \nactividades particulares. De este modo, el t\u00e9 rmino temperatura corporal no debe emplearse \nsin tener en cuenta en qu\u00e9 parte del cuerpo tiene lugar la medici\u00f3n. \n \n- Temperatura perif\u00e9rica o s uperficial: es la de los constituyentes del revestimiento \nperif\u00e9rico, como la piel, el tejido subcut\u00e1neo y las porcione s superficiales de las masas \nmusculares cuya funci\u00f3n principal es la de ma ntener una temperatura central constante. La \ntemperatura perif\u00e9rica muestra considerable s variaciones, subie ndo y bajando seg\u00fan el \nmedio ambiente. La temperatura media de la pi el para una persona promedio en un cuarto \ncon temperatura ambiente de 25\u00baC es de 33\u00baC.  La temperatura de la piel se puede medir \nmediante termocuplas o termistores mont ados en contacto con la epidermis. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   10- Temperatura central: la temperatura centr al representa la te mperatura media en \n\u00e1reas corporales profundas centrales (ejemp los: cerebro, coraz\u00f3n, pulmones, \u00f3rganos \nabdominales). Se encuentra constituida por la s regiones del cr\u00e1neo, tor\u00e1cica, abdominal, \np\u00e9lvica y las porciones m\u00e1s pr ofundas de las masas muscular es de las extremidades. Los \nseres humanos somos homeot\u00e9rmicos lo que sign ifica que la temperatura corporal interna \nse mantiene casi constante. En condiciones normales, la temperatura interna del cuerpo \nfluct\u00faa entre 36\u20195\u00baC y 37\u20195\u00baC. \n \n2.1.2 Zonas de Lectura \nOral: sublingual utilizando el cl\u00e1sico term\u00f3metro de mercurio durante un tiempo \naproximado de cuatro minutos. Se debe tener en cuenta la \u00faltima ingesta; se puede tomar la \ntemperatura m\u00ednimo 15 minutos despu\u00e9s de la ingesta. La temperatur a oral se puede medir \nen todos los pacientes, excepto, en los que es t\u00e1n inconscientes, sufren confusi\u00f3n mental, \nconvulsiones, afecciones de nariz, boca o ga rganta y los ni\u00f1os menores de 6 a\u00f1os. \n \nRectal: lubricar el term\u00f3metro y proteger  la intimidad del paciente. El resultado \ntiende a ser 0\u20195\u00baC a 0\u20197\u00baC mayor que la temp eratura oral. La temperatura rectal es \nrecomendable para el paciente menor de 6 a\u00f1os, a menos, que se  le haya practicado cirug\u00eda \nrectal o presente alg\u00fan tipo de  anormalidad en el recto. \n \nEl canal auditivo: por su proximidad del canal auditivo del hipot\u00e1lamo, la \ntemperatura timp\u00e1nica puede utilizarse como cr iterio para la estimaci\u00f3n de la temperatura \ninterna. De menor precisi \u00f3n que la toma rectal. \n \nAxilar: es recomendable en adultos y ni\u00f1os mayores de 6 a\u00f1os, se deja el \nterm\u00f3metro durante 5 minutos. El resultado es 0\u20195\u00baC menor que la temperatura oral. \n \n2.1.3 Valores, Alteraciones y Terminolog\u00eda \nEn la tabla 1 , se muestra los valores normales de temperatura seg\u00fan la edad. \n \n \nTabla 1.  Valores de la temp eratura seg\u00fan la edad \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   11Los factores que var\u00edan la temperatur a var\u00edan seg\u00fan diversos par\u00e1metros: \n- Edad: los ni\u00f1os son m\u00e1s susceptibles a las variaciones clim\u00e1ticas. En los ancianos \nla hipotermia se da por la p\u00e9rdida de gr asa subcut\u00e1nea, dieta inadecuada, cese de \nactividad y disminuci\u00f3n de los controles termorreguladores. \n- Ejercicio: por aumento en la producci\u00f3n de calor \n- Hormonas: en las mujeres la progesterona  secretada durante la ovulaci\u00f3n aumenta \nla temperatura. \n- Estr\u00e9s: la estimulaci\u00f3n del sistema nervioso simp\u00e1tico aumenta el metabolismo y la \nproducci\u00f3n de calor. \n- Medio ambiente: las variaciones extremadas de la temperatura ambiental alteran los \nsistemas termorreguladores de las personas. \n \nCuando la temperatura corporal alcanza valo res anormales se presentan una serie de \nreacciones: \n- Pirexia o hipertermia: temp eratura por encima del l\u00edmite superior normal. Se \npresenta aumento de la frecuencia cardiaca, escalofr\u00edos, piel p\u00e1lida y fr\u00eda y lechos \nungueales cian\u00f3ticos, por vasoconstricci\u00f3n. \n- Hipotermia: temperatura corporal por debajo  del limite inferior normal. Se puede \npresentar somnolencia e incluso coma, lo cual, favorece la inadecuada producci\u00f3n de calor y la aparici\u00f3n de hipotensi\u00f3n, dism inuci\u00f3n de la diures is, desorientaci\u00f3n, \nsensaci\u00f3n de fr\u00edo y piel p\u00e1lida y fr\u00eda. \n \nA la hipertermia se le denomina fiebre. Seg\u00fan la intensidad de la temperatura se puede \ndistinguir entre:  \n - Febr\u00edcula: temper atura hasta los 38\u00baC \n - Fiebre moderada: temperatura entre 38 y 39\u00baC  - Fiebre alta: temperatura superior a 39\u00baC.  \nSeg\u00fan la forma de la curva t\u00e9rmica: - Fiebre continua: oscilaci\u00f3n diaria inferior a un grado \n- Fiebre remitente: oscilacione s diarias mayores de un grado \n- Fiebre intermitente: la temperatura descie nde hasta lo normal, para luego ascender \nnuevamente. \n- Fiebre recurrente: episodios febriles (fiebr e por encima de 38\u20193\u00baC) alternados con \nperiodos de temperatura normal por d\u00edas o semanas. \n \nMediante el presente proyecto, se pretende  monitorizar la temperatura corporal, \ndetectar los episodios febriles o de hipote rmia y avisar a la persona encargada de \ncuidar a la persona enferma. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   122.2 M\u00f3dulo 1: Equipo Inal\u00e1mbrico con Sensor de Temperatura \nEl m\u00f3dulo aut\u00f3nomo sensor ser\u00e1 el enca rgado de realizar la medici\u00f3n de la \ntemperatura y transmitirla, es el m\u00f3dulo que se encontrar\u00e1 siempre en el bebe al cual se quiere monitorizar la temperatura. \n En su dise\u00f1o se han tenido en cuenta las siguientes necesidades: \n- Se alimentar\u00e1 mediante un sistema de bater\u00edas y su consumo ser\u00e1 m\u00ednimo. Durante \nm\u00e1s del 90% de su tiempo se encontrar\u00e1  funcionando en modo de bajo consumo y \n\u00fanicamente se activar\u00e1n todas sus funciones para realizar la medici\u00f3n de \ntemperatura y enviar los da tos a otro dispositivo.  \n- Su tama\u00f1o ser\u00e1 el menor posible, ya que se  situar\u00e1 en el usuario y su dise\u00f1o debe \nser tal que no provoque mole stias al llevarlo encima. \n- En su dise\u00f1o deben considerarse los m\u00edni mos componentes posibles para minimizar \nel consumo y el espacio. \n- Controlar\u00e1 el estado de la bater\u00eda y deber\u00e1 enviar un aviso de bater\u00eda baja al \nusuario. \n- El sensor de temperatura ser\u00e1 lo m\u00e1s exact o y preciso posible en su medida y debe \npoder funcionar en modo de bajo consumo. \n- El sistema inal\u00e1mbrico a utilizar debe se r de bajo consumo. La distancia m\u00e1xima a \ntransmitir ser\u00e1 de unos 30 metros y la tasa de datos de transferencia ser\u00e1 baja. \n \n2.2.1 Diagrama de Bloques \n En la figura 7 se puede observar el diagrama funcional de bloques del M\u00f3dulo \nAut\u00f3nomo Sensor. \n \nbater\u00eda uCsensor T\u00aa\nSist. Wireless\n \nFigura 7. Diagrama funcional de bloques Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   13Sus principales componentes ser\u00e1n: \n \n- El sensor de temperatura. Debe ser un  sensor de peque\u00f1o tama\u00f1o, que permita dos \nmodos de funcionamiento, modo norma l y modo de bajo consumo. Lo m\u00e1s \nintegrado posible para que su consumo sea m\u00ednimo. \n - El sistema de comunicaci\u00f3n wireless. La elecci\u00f3n del sistema de comunicaci\u00f3n ser\u00e1 \nimportante ya que ser\u00e1 el recurso que c onsuma m\u00e1s potencia. Se buscar\u00e1 un sistema \nde bajo consumo, capaz de entablar com unicaci\u00f3n con otro dispositivo a 30 metros \ny su tasa de transferencia no tiene porque ser muy elevada. \n \n- El microprocesador. Se encargar\u00e1 de gest ionar los modos de funcionamiento del \nm\u00f3dulo. Se encargar\u00e1 de tomar el dato de  temperatura proveniente del sensor y \nenviarlo al sistema de comunicaci\u00f3n wireless  para su env\u00edo al otro dispositivo. \nTambi\u00e9n debe gestionar el estado de la ba ter\u00eda y enviar la informaci\u00f3n de bater\u00eda \nbaja al modulo de sobremesa. \n \n- La bater\u00eda: proporcionara la alimentaci \u00f3n a todo el sistema. Debe ser lo m\u00e1s \npeque\u00f1a posible y que propor cione una autonom\u00eda sufici ente. En funci\u00f3n de las \nnecesidades de consumo y tensi\u00f3n de funcionamiento del resto de dispositivos se decidir\u00e1 sus caracter\u00edsticas.  \n \n               Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   142.3 Medici\u00f3n de la Temperatura Corporal. Sensores. \nSe puede realizar la medici\u00f3n de la temper atura corporal de diferentes maneras que \nvar\u00edan de acuerdo al costo del equipo, precisi\u00f3n, linealidad y rango. \nA continuaci\u00f3n expondr\u00e9 los princi pales tipos de sensores.  \n2.3.1 Termopares \nLos termopares son los sensores de temperatura utilizados con mayor frecuencia \nporque son sensores precisos, relativamente econ\u00f3micos, que pueden operar en un amplio \nrango de temperaturas. \n \nEl termopar fue descubierto por Thomas Seebeck en 1831. \u00c9l descubri\u00f3 que una \ncorriente el\u00e9ctrica flu\u00eda en un circuito cerrado de dos metale s distintos cuando una de las \nuniones era calentada. La magnitud y direcci\u00f3n de la corriente son funci\u00f3n de la diferencia \nde temperatura de las uniones y de las propie dades t\u00e9rmicas de los metales usados en el \ncircuito. A este fen\u00f3meno se le conoce como efecto Seebeck. \n \n \nFigura 8.  Corriente provocada por el Efecto Seebeck \n \nSi abrimos este circuito, obtenemos una diferencia de potencial peque\u00f1a \n(milivoltios), la cual es directamente proporci onal a la temperatura de la uni\u00f3n y a la \ncomposici\u00f3n de los dos metales. \n \n \nFigura 9.  Metales distintos creando un temopar Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   15\n \nFigura 10.  Los termopares son econ\u00f3micos y pueden operan en un amplio rango de \ntemperaturas.  \n \nExisten diferentes tipos de termopares as ignados con letras may\u00fasculas que indican \nsu composici\u00f3n de acuerdo al American \u001fnaci onal Standards Institute (ANSI). Los tipos \nde termopares m\u00e1s comunes incluyen B, E, K, N, R, S y T. \n \n \nTabla 2.  Diferentes tipos de termopares \n \nLas curvas de calibraci\u00f3n para los diferent es tipos de termopares son las descritas \nen la siguiente tabla: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   16\n \nFigura 11.  Curvas de calibraci\u00f3n \n \nMedici\u00f3n. \nLa diferencia de potencial, en un term opar, no puede ser medida directamente \ndebido a que la uni\u00f3n termopar con el instru mento de medida crea un nuevo circuito \ntermoel\u00e9ctrico. \nPor ejemplo, si conectamos un volt\u00edmetro a un termopar tipo T (cobre-constantan) \npara conocer su diferencia de potencial. \n \nFigura 12. Conexi\u00f3n volt\u00edmetro \n \nEl circuito equivalente que obt endr\u00edamos ser\u00eda el siguiente: \n \nFigura 13. Circuito equivalente \n \nSe quiere conocer el valor de V1, pero al conectar el volt\u00edm etro estamos creando \ndos uniones m\u00e1s U2 y U3. Debido a que U3  es del mismo metal (cobre-cobre), la Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   17diferencia de potencial de V3 es cero vo ltios (V3=0=. Sin embargo, U2 que es una uni\u00f3n \nde cobre-constantan crea una V2 en oposici\u00f3n a V1, por lo que la lectura resultante del \nvolt\u00edmetro V ser\u00e1 proporcional a la diferencia  de temperaturas U1 y U2. Es necesario \nconocer U2 para determinar V1, \n Una manera de determinar U2 es colocar f\u00edsicamente esta uni \u00f3n dentro de un ba\u00f1o \nde hielo, forzando entonces a que su temperatura sea 0\u00baC y estableciendo U2 como la \nUni\u00f3n de referencia (Uni\u00f3n fr\u00eda). \n \nFigura 14. Uni\u00f3n de referencia U2 por junta fr\u00eda \n \nDe esta manera la tensi\u00f3n le\u00edda en el volt\u00edmetro ser\u00e1 directamente proporcional a la \ntemperatura de U1, ya que la te mperatura de U2 es igual a cero. \nEn el primer ejemplo se ha  utilizado un termopar tipo T, pero si usamos un termopar \ntipo J (hierro-constantan), en este caso tendr\u00edamos una uni\u00f3n m\u00e1s que afectar\u00eda la \nmedici\u00f3n. Por supuesto que una so luci\u00f3n ser\u00eda colocar U2 y U3 dentro del ba\u00f1o de hielo y \nel problema est\u00e1 resuelto. \nPero existe otra soluci\u00f3n, \u00e9sta consiste en tener U2 y U3 a una misma temperatura \nconocida y aisladas el\u00e9ctricamente. Esto se logra con un bloque isot\u00e9rmico cuya \ntemperatura tiene que ser medida mediante  otro sensor, normalmente un termistor o \nPT100. \n \n \nFigura 15. Bloque de temperatura con PT100 \n \nSi el termistor o PT100 determinan la te mperatura de referencia de U2 y U3, se \npuede determinar entonces la tensi\u00f3n el\u00e9ctrica de referencia de esas uniones (Vref), por lo \ntanto V1 ser\u00e1 la diferencia de V menos la Vref. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   18Para este procedimiento de compensaci\u00f3n por uni\u00f3n fr\u00eda, exis ten dos t\u00e9cnicas:  \n- compensaci\u00f3n por hardware - compensaci\u00f3n por software. En la compensaci\u00f3n por hardware , se inserta una fuente vari able de voltaje dentro del \ncircuito para cancelar los voltajes termoel\u00e9ctrico s par\u00e1sitos. La fuente variable de voltaje \ngenera un voltaje de compen saci\u00f3n de acuerdo con la temper atura ambiente, para as\u00ed poder \nadicionar el voltaje correcto para cancelar las se\u00f1ales termoel\u00e9ctricas indeseadas. Cuando \nse cancelan estas se\u00f1ales par\u00e1s itas, la \u00fanica se\u00f1al que mide el  dispositivo de adquisici\u00f3n de \ndatos es el voltaje desde la uni\u00f3n del term opar. Con la compensaci\u00f3n por hardware, la \ntemperatura en los terminales del sistema de adquisici\u00f3n de datos es irrelevante ya que los \nvoltajes par\u00e1sitos del termopar se han cancelado.  La mayor desventaja de la compensaci\u00f3n \npor hardware es que cada tipo de termopar de be poseer un tipo sepa rado de circuito que \npueda adicionar el voltaje correcto de compen saci\u00f3n; este hecho hace que el circuito sea \nbastante costoso. La compens aci\u00f3n por hardware es genera lmente menos exacta que la \ncompensaci\u00f3n por software.  \nEn la compensaci\u00f3n por software el c\u00e1lculo de  la tensi\u00f3n de referencia y a su vez el \nc\u00e1lculo de la diferencia de tensiones es re alizado por un microproces ador. Este \u00faltimo es \nsin duda el procedimiento de medici\u00f3n de termopares m\u00e1s com\u00fan. \n2.3.2  RTD\u2019s. \nLas termorresistencias son sensores de temperatura basados en el cambio de \nresistividad que sufren las estructuras de los metales con la temperatura, la cual es aproximadamente lineal para ciertos metales. \n Una termo resistencia, o RTD, se fabri ca para tener un valor Ro nominal a una \ntemperatura dad (p.e. 100 ohms a 0\u00baC). Al medir su resi stencia a una temperatura \ndesconocida y al compararla con Ro, se puede conocer la difere ncia de resistencia. Como \nla caracter\u00edstica de la resist encia en funci\u00f3n de la temperatura es tambi\u00e9n conocida, el \ncambio de temperatura desde el punto inicial ser\u00e1 conocida. \nLos materiales usados como RTDs\u2019s son: \n- cobre \n- balco (aleaci\u00f3n de hierro-n\u00edquel) \n- tungsteno \n- iridio \n- Platino. \nDebido a su baja resistividad, el oro y la plata no son usados como RTD\u2019s. El \ntungsteno posee alta resistividad, pero se le reserva para muy alta temperatura, al ser \nmuy quebradizo y dif\u00edcil de maquinar. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   19\n \nEl cobre se usa a veces como RTD. Su baja resistividad hace que el elemento sea \nm\u00e1s largo que uno de platino, pero su linealid ad y bajo costo lo hacen una alternativa \necon\u00f3mica. Su l\u00edmite de operaci\u00f3n es de 120\u00baC. \nLos elementos de n\u00edquel o aleaciones de n\u00edquel son m\u00e1s no lineales y tienden a \nmodificar su valor de re sistencia con el tiempo. \n \nFigura 16. Curva R-T de varios metales. \n \nEl platino es el m\u00e1s popular de las RTD\u2019 s, debido a su caracter\u00edstica muy cercana a \nla linealidad en un rango amplio de temperatur as, estable a largo plazo. El costo de los \nPRTD\u2019s (RTD de platino) se  vieron reducidos al implemen tarse en pel\u00edcula delgada. \n \nLas princ\u00edpiales caracter\u00edsticas encontradas en el  platino son: \n- Estabilidad qu\u00edmica: resistencia a la oxidaci\u00f3n y corrosi\u00f3n \n- Facilidad de manufactura \n- Disponibilidad de alambre de alta pureza \n- Buena reproducibilidad de caracter\u00edsticas el\u00e9ctricas. \n \nEsta \u00faltima permite el poder reemplazar el elemento sensor sin tener que recalibrar \nun instrumento. Los valores t\u00edpicos son de 100, 500 y 1000 ohms. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   20 \nLas RTD\u2019s se identifican por el metal del que se componen (seg\u00fan la tabla \nperi\u00f3dica) y la resistencia que presen tan a 0\u00baC. Ejemplo: Pt100, Pt1000, Ni120, Cu200, \netc. \nSeg\u00fan la precisi\u00f3n, se distinguen dos tipos: \n- Clase A: \u00b1 0\u201915 \u00baC a 0\u00baC \n- Clase B: \u00b1 0\u201930 \u00baC a 0\u00baC \nLuego presentan una degradaci\u00f3n de la pr ecisi\u00f3n hacia los extremos del rango. Por \nejemplo, seg\u00fan el est\u00e1ndar IEC751, para clase B, se tiene: \n \nTabla 3. Precisi\u00f3n para clase B \n \nConstructivamente las RTD se pue den encontrar de dos formas: \n- Construcci\u00f3n tipo Meyer. Consisten en enro llar sobre una cruz de mica una bobina \nhelicoidal de platino, y montar  el conjunto dentro de un tubo de vidrio. Al ser el \ncoeficiente de dilataci\u00f3n de la mica muy bajo, el esfuerzo sobre el alambre ser\u00e1 \nbajo, evitando la variaci\u00f3n de resist encia por estiramiento, obteniendo as\u00ed un \ndispositivo estable. A su vez, al estar bobinado a la vez de enrollado, se maximiza \nsu resistencia para un tama\u00f1o dado. \n- RTD de pel\u00edcula delgada de platino. La longitud de alambre y di\u00e1metro para \ncontrolar el valor de Ro se reemplaza por una estructura meandro muy delgada sobre un substrato (hasta de 3 micrones), de all\u00ed las bajas corrientes de medici\u00f3n \npermitidas.  \n \nEl RTD de pel\u00edcula delgada ofr ece un dispositivo peque\u00f1o, que responde \nr\u00e1pidamente a los cambios bruscos de temp eratura y reduce la cap taci\u00f3n de ruido por \ncampos magn\u00e9ticos variables, problema s  que poseen los del tipo bobinado. El \ninconveniente frente a los bobina dos es que son menos estables. \n \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   21\n \nFigura 17. RTD de pel\u00edcula delgada \n \nEn el caso de la RTD de platino, su funci \u00f3n como sensor se basa en la dependencia \ncon la temperatura de la resistividad del metal. La relaci\u00f3n existente puede ser descrita por el siguiente polinomio caracter\u00edstico: \n  (1) \ndonde: \n R(T) = Resistencia medida.  Ro = Resistencia nominal a 0\u00baC \nLas constantes est\u00e1n definidas por el es t\u00e1ndar internacional (DIN EN 60751) para \nsensores de platino: \n(2) \nEl coeficiente b es tan peque\u00f1o que para  la mayor\u00eda de las aplicaciones puede \nconsiderarse una relaci\u00f3n lineal entre R(T) y T. \n \nMedici\u00f3n. \n La medida de una RTD se puede realizar de diferentes m\u00e9todos. En todos ellos, es \nnecesaria un circuito de acondicionamiento de la se\u00f1al. \n  \nMedici\u00f3n por m\u00e9todo de cero: puente de tres hilos. \n(3) Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   22El valor del RTD a la temperatura de calibr aci\u00f3n del puente ser\u00e1 el valor de R3. Se \nbusca que R1, R2 y R3 tengan coeficientes de variaci\u00f3n de resistencia con la temperatura \nnulo a la temperatura de trabajo. \n \nMedici\u00f3n de temperatura con RTD por comparaci\u00f3n. \nEn este m\u00e9todo se compara la magnitud de sconocida con otra de la misma especie \nconocida. El patr\u00f3n y la inc\u00f3gnita coexisten en la medici\u00f3n. Puede se r de deflexi\u00f3n o cero. \nEl m\u00e9todo por fuentes de corriente es de deflexi\u00f3n, al obtener una tensi\u00f3n de salida \nproporcional a la diferencia de resistencia en tre RTD y Ro, que bien podr\u00eda actuar sobre un \ninstrumento calibrado en \u00baC. \nEl esquema b\u00e1sico se r\u00eda el siguiente: \n \nFigura 18.  Esquema b\u00e1sico comparaci\u00f3n \n \nAl circular corriente por el sensor, se produce un e rror por autocalentamiento. \n2.3.3 Termistores \nLos termistores aprovechan la dependencia que presenta la resistencia el\u00e9ctrica de \ncualquier material conductor con la temperatura.  En el caso de los termistores, se utilizan \nmateriales semiconductores de alta sensibilid ad, espec\u00edficamente dise\u00f1ados para que su \nresistencia dependa agudamente de la temper atura del elemento. Existen termistores de \ncoeficiente positivo PTC (su resistencia aument a con la temperatura)  o negativo NTC (su \nresistencia disminuye con la temperatura), siendo este \u00faltimo m\u00e1s t\u00edpico y de bajo costo. \n \n \nFigura 19.  Distintas formas de los termistores NTC y PTC Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   23 \nEn los termistores se observan relaciones de la resistencia con la temperatura que \nno son lineales, sino m\u00e1s bien de car\u00e1cter exponencial. Para termistores comerciales \ncomunes, la relaci\u00f3n es del tipo \n() ( )\u23a5\n\u23a6\u23a4\n\u23a2\n\u23a3\u23a1\u2212\u22c5\u03a7\n\u22c5==011\n0TTeTTR TR  \n         ( 4 )  \n \nDonde \u201cR(T)\u201d es la resistencia (en ohms) observada a la temperatura \u201cT\u201d, la que \ndepende de un primer par\u00e1metro dado por la  resistencia a una temperatura conocida \n\u201cR(T=To)\u201d, t\u00edpicamente 25\u00baC, y de un segundo par\u00e1metro de ajuste \u201cx\u201d. \n \n \nFigura 20.  Curva caracter\u00edstica de los termistores \n En el caso de los termistore s, dado que se mide resist encia, se debe cuidar, en \nprimer lugar, que la resisten cia de los cables de conexi\u00f3n  (que tambi\u00e9n cambia con la \ntemperatura) no incida sobre la medici\u00f3n y, en segundo luga r, que la corriente que circule \npor el elemento para medir su resistencia sea lo suficientemente peque\u00f1a como para \ncalentar s\u00f3lo m\u00ednimamente el propio sens or. A ese fin se utilizan sistemas de \ncompensaci\u00f3n que incorporan cables id\u00e9nticos pero  sin el sensor, en el brazo adyacente de \nun puente de Wheastone, am\u00e9n de circular  una corriente nula  por el sensor. \n \nLos termistores al igual que cualquier  dispositivo construido en base a \nsemiconductores tienen algunos par\u00e1metros que deben ser considerados  para su elecci\u00f3n. \nLos t\u00e9rminos que con mayor frecuencia se emplean son: \n- Resistencia a potencia cero: Resistencia del termistor cuando no existe efecto de \nautocalentamiento. \n- Variaci\u00f3n de la resistencia con la temper atura: Sensitividad, t\u00edpicamente de 4W/\u00baC. \n- Estabilidad: Capacidad de un termistor para  mantener sus caracter\u00edsticas dentro del \nrango 0\u201903\u00baC/a en un periodo de 12 a\u00f1os. \n- Autocalentamiento: Potencia disipada en el termistor Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   24- Temperatura de operaci\u00f3n m\u00e1xima: Temperat ura m\u00e1xima en la cual el termistor \nconservar\u00e1 su operaci\u00f3n con caracter\u00ed sticas de estabilidad aceptables. \n Las principales caracter\u00edsticas que poseen son: \n- Alta sensibilidad \n- Alto coeficiente t\u00e9rmico \n- Envejecen \n- Tienen un tiempo de respuesta variable \n- Sufren de autocalentamiento \n- No son lineales \n- Son de tama\u00f1o reducido \n- Son susceptibles a contaminaci\u00f3n \n-  \n \nFigure 21. Resistencia contra Temperatura para un Termistor T\u00edpico y RTD \n \nMedici\u00f3n. \nLos termistores son dispositivos sensibles, se les debe administrar una corriente de \nexcitaci\u00f3n y luego leer el voltaje a trav\u00e9s de  los terminales. Si el calor adicional no se \npuede disipar, el calentamient o causado por la corriente de excitaci\u00f3n puede incrementar la \ntemperatura del elemento de detecci\u00f3n. El auto calentamiento generalmente cambia la resistencia del termistor, provocando errore s en las medidas. Los efectos del auto \ncalentamiento se pueden disminuir al admi nistrar una baja corriente de excitaci\u00f3n. \nLa manera m\u00e1s f\u00e1cil de conectar un RTD o termistor a un dispositivo de medida es \ncon una conexi\u00f3n de 2 cables. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   25\n \nFigura 22. Medida RTD/Termistor de 2 Cables \n  \nCon este m\u00e9todo, los dos cables que alimenta n al RTD o termistor con su corriente \nde excitaci\u00f3n tambi\u00e9n se usan para medir el voltaje en el sens or. Debido a la baja \nresistencia nominal de los RTDs, la precis i\u00f3n de las medidas se puede ver afectada \nsignificativamente por la resistencia del cable. Por ejemplo, los cables con una resistencia \nde 1 W conectados a un RTD de platino de  100 W causan un error de medida del 1%. \nUn m\u00e9todo de conexi\u00f3n de 3 cables o 4 cables puede eliminar los efectos de \nresistencia del cable. La conexi\u00f3n coloca las terminales en una trayectoria de alta \nimpedancia a trav\u00e9s del dispositivo de medi da, eliminando de manera efectiva los errores \ncausados por la resistencia del cable. No es necesario usar un m\u00e9todo de conexi\u00f3n de 3 o 4 \ncables para termistores ya que \u00e9stos generalmente tienen valores de resistencia nominal \nm\u00e1s altos que los RTDs. A continuaci\u00f3n se muestra un diagrama de conexi\u00f3n de 4 cables. \n \n \nFigura 23. Medida RTD de 4 Cables  \n \nLas se\u00f1ales de salida del RTD y del termisto r por lo general est\u00e1 n en el rango de los \nmilivoltios, lo cual los hace sensibles al ruido. Los filtros paso bajo son usados \ncom\u00fanmente en sistemas de adquisici\u00f3n de datos de RTD y termistor para eliminar de \nforma efectiva el ruido de alta frecuencia en las medidas. Por ejemplo, los filtros paso bajo \nson \u00fatiles para eliminar el ruido de l\u00ednea de potencia de 50 Hz que se  presenta com\u00fanmente \nen la mayor\u00eda de los laboratorios y plantas. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   262.3.4 Acondicionamiento de la Se\u00f1al. \nSe requiere acondicionamiento de se\u00f1ales para realizar medidas de temperatura \nprecisas y confiables. Al dise \u00f1ar el sistema de medidas adecuado para un sensor de \ntemperatura, se debe considerar amplificac i\u00f3n, aislamiento, filtros, excitaci\u00f3n, precisi\u00f3n, \nresoluci\u00f3n y compensaci\u00f3n de junta fr\u00eda (CJC). \nAmplificaci\u00f3n \nLas se\u00f1ales de salida des los sensores de  temperatura son gene ralmente en rangos \nde milivoltios, as\u00ed que se debe amplificar la se\u00f1al y prevenir el ruido en su sistema de \nmedidas. Se debe escoger una ganancia que optimice los l\u00edmites de entrada del convertidor anal\u00f3gico a digital (ADC) del hardware. Para mejorar significativamente el rendimiento \ndel ruido de su sistema, se puede amplificar lo s voltajes de bajo nivel cerca de la fuente de \nse\u00f1al o punto de medida. \nAislamiento \nLos termopares que son montados o so ldados directamente a un material \nconductivo, como el acero o el agua, introducen otra fuente de ruido. Esta configuraci\u00f3n \nhace a los termopares particularmente sensib les al voltaje en modo com\u00fan y a lazos a \ntierra. El aislamiento ayuda a prevenir lazos a tierra y pu ede mejorar dr\u00e1sticamente el \nrechazo de voltaje en modo com\u00fan. \nFiltrado \nLos filtros paso bajo se utilizan com\u00fanmen te para eliminar de manera efectiva el \nruido de alta frecuencia en medidas de temperaturas. Por ejemplo, los filtros paso bajo son \n\u00fatiles para eliminar el ruido de l\u00ednea de poten cia de 60 Hz que se presenta com\u00fanmente en \nvarios laboratorios y plantas. \nExcitaci\u00f3n \nYa que los RTDs y termistores son disposi tivos sensibles, se les debe administrar \nuna corriente de excitaci\u00f3n y luego leer el volta je a trav\u00e9s de los te rminales. Si el calor \nadicional no se puede disipar, el calentam iento causado por la corriente de excitaci\u00f3n \npuede incrementar la temperatura del elemento de detecci\u00f3n. El auto calentamiento cambia \nla resistencia del RTD o termistor,  provocando errores en las medidas.. \nPrecisi\u00f3n y Resoluci\u00f3n \nAl seleccionar el sensor y el hardware de adquisici\u00f3n de datos adecuados, se deben \nconocer los requerimientos de precisi\u00f3n y reso luci\u00f3n para su aplicac i\u00f3n. Sin embargo los \nfiltros y la amplificaci\u00f3n pueden mejorar signifi cativamente la precisi\u00f3n de las medidas de \ntermopares, de RTDs y de termistores. Adem\u00e1s  de las consideraciones de los sensores, el \nhardware de adquisici\u00f3n de da tos y acondicionamiento de se\u00f1al debe igualar la precisi\u00f3n y \nla resoluci\u00f3n requerida. \nCompensaci\u00f3n de Junta Fr\u00eda (CJC) \nCJC es una tecnolog\u00eda requerida para medida s precisas de termopa res. Un voltaje es \ngenerado en la conexi\u00f3n entre el termopar y el terminal de su dispositivo de adquisici\u00f3n de \ndatos. CJC mejora la precisi\u00f3n de sus medidas al proporcionar la temperatura en esta uni\u00f3n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   27y al aplicar la correcci\u00f3n apr opiada. Es importante conocer c\u00f3mo funciona la CJC porque \nel error introducido por el sensor CJC se co mpone de cualquier error existente en su \nmedida. Al calcular la precisi\u00f3n del sistema , este error puede ser si gnificante y debe ser \nconsiderado \n \nEliminaci\u00f3n de Ruido \n Las se\u00f1ales de los sensores  generalmente  est\u00e1n en el rango de los milivoltios, lo \ncual los hace sensibles al ruido. Los filtros paso bajo se utilizan  com\u00fanmente en los \nsistemas de adquisici\u00f3n de datos de termopares para eliminar de manera efectiva el ruido \nde alta frecuencia. \n Tambi\u00e9n se puede reducir el ruido amplif icando los voltajes de bajo nivel cerca de \nla fuente de se\u00f1al. \n Otras fuentes de ruidos son debidas a que  por ejemplo los termopares, se suelen \nmontar o soldar en materiales conductivos, ha ci\u00e9ndolos particularment e sensibles al ruido \nen modo com\u00fan y a los lazos de tierra. Un bue n aislamiento ayuda a prevenir que ocurran \nlazos a tierra y puede mejora r dr\u00e1sticamente el rechazo  de ruido en modo com\u00fan. \n \n2.3.5 Sensores de Temperatur a con Semiconductores. \nLa corriente de conducci\u00f3n de una uni\u00f3n p-n polarizada directamente, responde \nexponencialmente con la tensi\u00f3n de forma dir ecta, e inversa con la temperatura. Si se \nrecuerda la ecuaci\u00f3n caracter\u00edsti ca de funcionamiento de un diodo. \n(5) \ndonde: \n q=carga del electr\u00f3n  k=constante de boltman  T=temperatura  Isat=corriente de saturaci\u00f3n  \nDe esta ecuaci\u00f3n, se desprende que a corrient e constante, la tensi\u00f3n var\u00eda a raz\u00f3n de \n-2\u20192m por cada grado cent\u00edgrado (\u00baC), consid erando el diodo forma do por la uni\u00f3n base-\nemisor de un transistor bipolar. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   28\n(6) \n \nPero adem\u00e1s de la variaci\u00f3n con T, mantie ne una fuerte dependencia de Isat con la \ntemperatura, lo que hace que no sea directamen te utilizable debido a la compleja forma de \ndependencia con la temperatura. Si se toman N transistores id\u00e9nticos al primero sobre lo \nque se reparte igualitariamen te la misma corriente Ic. \n(7) \nSi se toma la tensi\u00f3n diferencia entr e ambos conjuntos, se  tendr\u00e1 una tensi\u00f3n \nproporcional a la temperatura absoluta pe ro sin tener dependencia alguna con Isat. \n (8) Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   29De esta manera, puede cons truirse un circuito contenie ndo N+1 transistores NPN, \nun espejo de corriente PNP y una resistencia es table con la temperatura, como se muestra \nen la figura siguiente, cuya corriente ser\u00e1 proporcional a la temperatura absoluta, como lo \nser\u00e1 igualmente la ca\u00edda de tensi\u00f3n sobre la re sistencia R (que representa la diferencia entre \nV y Vn de las ecuaciones anteriores). \n \nLos sensores basados en este sistema puede n dar su salida seg\u00fan la siguiente tabla: \n \nTabla 4. Tipo de salidas para los sensores \n \nLos sensores de temperatura con salida en co rriente se basan en el  circuito descrito \nen la figura anterior, a estos sensores se les denomina sensor de temperatura band-gap. Este \ntipo de sensores no necesitan calib raci\u00f3n alguna o ajuste externo. \n \nLa incorporaci\u00f3n de dispositivos digitales in tegrados junto con el sensor reduce el \nn\u00famero de componentes externos en las apli caciones. As\u00ed, existen circuitos como el \nMCP9804 de Microchip que pr oporcionan un salida  digital I2C como salida de \ntemperatura. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   30\n \nFigura 24. Diagrama de bloques sensor integrado \n \n2.3.6 Elecci\u00f3n Final \nEn base a las necesidades del proyecto y a las caracter\u00edsticas de los diferentes \nsensores descritos se ha escogido para desarrol lar el proyecto el sensor de temperatura de \nMicrochip MCP9804. \n \nEl MCP9804 es un sensor de temperatura basado en semiconductores del tipo band-\ngap. La ventaja del uso de semiconductores en el sensado de temperatura es su capacidad \nde integraci\u00f3n. En el caso del MCP 9804, viene integrado con un convertidor \nanal\u00f3gico/digital y con una comunicaci\u00f3n I2C. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   31El uso de un termopar, RTD o termistor imp lica la existencia de un circuito para \nacondicionar la se\u00f1al. \n \nTipo de sensorAcondicionamiento \nde se\u00f1al necesariaExactitud Sensibilidad\nAmplificaci\u00f3n\nFiltroUni\u00f3n friaCompensaci\u00f3n\nAmplificaci\u00f3n\nFiltroCorriente de \nexcitaci\u00f3n\nAmplificaci\u00f3nFiltroCorriente de excitaci\u00f3nTermopar Buena Buena\nRTD La mejor Muy buena\nTermistor Muy buena La mejor\nIntegrado lineal \nMCP9804Muy buena Buena No necesita \nacondicionamiento de \nse\u00f1al\n \nTabla 5. Comparativa sensores T\u00aa \n \nEn el presente proyecto el us o de un circuito acondicionador  de se\u00f1al presenta varios \ninconvenientes. \n- Se a\u00f1ade un circuito acondicionador a la placa del dispositivo inal\u00e1mbrico. \n- Se debe controlar el circuito acondiciona dor para que mientras  n o  e s t \u00e9  e n  u s o  \nconsuma la m\u00ednima energ\u00eda. \n- El hecho de utilizar m\u00e1s componentes di scretos incrementa la complejidad del \ncircuito, lo hace m\u00e1s susceptible a fa llos y hace m\u00e1s dif\u00edcil su reparaci\u00f3n. \n- Un circuito acondicionador aumenta el precio del sistema sensor. \n \nEn la siguiente tabla se muestra el preci o aproximado de los diferentes sensores. \n \nTipo Sensor Precio (euros) Intercambiabilidad Estabilidad Circuito Acond. TOTAL\nMCP9804 1.59 excelente buena 0 1.59\nTermopar tipo T 4.27 buena media 1 5.27\nTermistor 0.7 mala media 1 1.7\nRTD - PT100 3.65 excelente buena 1 4.65  \nTabla 6. Comparativa precios diferentes sensores \n \nComo se puede observar, el sensor m\u00e1s ec on\u00f3mico es el termistor, sin embargo, la \nnecesidad de acondicionar su se\u00f1al lo rele ga al segundo puesto, sie ndo el MCP9804 el m\u00e1s \necon\u00f3mico. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   32Existen sensores de temperatura basados  en semiconductores m\u00e1s econ\u00f3micos, sin \nembargo su se\u00f1al de temperatur a es anal\u00f3gica, lo que hace necesaria un acondicionamiento \nde la se\u00f1al, siendo el precio final similar al MCP9804. \nEn definitiva, el uso del MCP9804 presenta  muchas ventajas frente al resto de \nsensores, entre las que podemos destacar: \n- facilidad de \u00ednter cambiabilidad, en caso de fallo del sensor \n- Alta precisi\u00f3n y resoluci\u00f3n \n- No necesita acondicionar la se\u00f1al de sa lida. Salida digital de temperatura. \n- Disminuye la complejidad del sistema y aumenta su fiabilidad. \n- Presenta modo de funcionamiento en ba jo consumo, necesario en sistemas a \nbater\u00eda. \n- El conjunto sensor se encuen tra entre los m\u00e1s econ\u00f3micos \n                      Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   332.4 Comunicaci\u00f3n Wireless entre M\u00f3dulos \nZigBee constituye una de las partes importantes de este proyecto puesto que ser\u00e1 el \nmedio de transmisi\u00f3n elegido para el env\u00edo de los datos, una vez medidos con el sensor de \ntemperatura. \n  Como se ver\u00e1 m\u00e1s adelante, ZigBee puede ser usado para una gran variedad de \naplicaciones, como podemos observar en la Figura  25, pero en este caso  su utilizaci\u00f3n es \npara fines de monitorizaci\u00f3n corporal. \n \n \nFigura 25. Aplicaciones tecnolog\u00eda Zigbee \n En este apartado se tratar\u00e1 de forma amplia  y espec\u00edfica el funcionamiento de este \ntipo de conexi\u00f3n, partiendo de una defini ci\u00f3n de ZigBee y posteriormente estudiando \ntanto sus principales caracter\u00edsticas como su funcionamiento en una red ZigBee. \n \nOtro punto a tener en cuenta es el porqu\u00e9  de su elecci\u00f3n teniendo otros tipos de \nposibilidades. Para ello se realizar\u00e1 una comparaci\u00f3n con otros medios de transmisi\u00f3n \nmuy parejos a ZigBee. A partir de dicha comparativa podremos entender y asimilar que \nun medio ZigBee para este tipo de  proyecto es lo m\u00e1s adecuado. \n \n2.4.1 ZigBee \nZigBee es el nombre de la especificaci\u00f3n de  un conjunto de protocolos de alto nivel \nde comunicaci\u00f3n inal\u00e1mbrica. Esta esp ecificaci\u00f3n define una soluci\u00f3n para \ncomunicaciones inal\u00e1mbricas de bajo coste y consumo. \n \nEl principal objetivo que pretende satisf acer una red de comunicaci\u00f3n ZigBee es la \nde comunicar aplicaciones que requieren comunicaciones seguras, con baja tasa de env\u00edo y maximizaci\u00f3n de la vida \u00fatil de sus bater\u00edas. La red, en su conjunto, utilizar\u00e1 una cantidad Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   34muy peque\u00f1a de energ\u00eda de forma que cada dispositivo individual pueda tener una \nautonom\u00eda de hasta 5 a\u00f1os antes de necesitar  un recambio en su sistema de alimentaci\u00f3n. \n La ZigBee Alliance es el grupo encargado de  su desarrollo. La primera versi\u00f3n 1.0 \nfue aprobada el 14 de diciembre de 2004. En  diciembre de 2006 se aprob\u00f3 el protocolo \nZigBee 2006, y actualmente se est\u00e1 trabajando en nuevas versiones. \n \nEl medio de transmisi\u00f3n ZigBee trabaja sobr e la banda ISM para usos  industriales, \ncient\u00edficos y m\u00e9dicos; en concreto, 868MHz  en Europa, 915MHz en Estados Unidos y \n2.4GHz en todo el mundo. Al ser \u00e9ste \u00faltimo libre en todo el mundo, las empresas optan \npor esta opci\u00f3n a la hora de dise\u00f1ar. En el ra ngo de frecuencias de 2.4GHz se definen hasta \n16 canales, cada uno de ellos con un ancho de banda de 5MHz. \n La pila de protocolos ZigBee, tambi\u00e9n c onocida como ZigBee Stac k, se basa en el \nnivel f\u00edsico (PHY) y el cont rol de acceso al medio (MAC) definidos en el est\u00e1ndar IEEE \n802.15.4, que desarrolla estos niveles para redes in al\u00e1mbricas de \u00e1rea personal de baja tasa \nde transferencia (LR-WPAN, Low Rate - Wireless Personal Area Network ). La \nespecificaci\u00f3n ZigBee completa este est\u00e1ndar a\u00f1adiendo cuatro componentes principales: \n \n- Nivel de red. \n- Nivel de aplicaci\u00f3n \n- Objetos de dispositivo ZigBee (ZDO, ZigBee Device Objects). \n- Objetos de aplicaci\u00f3n defi nidos por el fabricante. \n Adem\u00e1s de a\u00f1adir dos capas de alto nivel (n ivel de red y de aplicaci\u00f3n) a la pila de \nprotocolos, el principal cambio es la adici \u00f3n de los ZDO ya que son los responsables de \nllevar a cabo una serie de  cometidos, entre los que se encuentran el mantenimiento de los \nroles de los dispositivos, la gesti\u00f3n de petic iones de uni\u00f3n a una red, el descubrimiento de \notros dispositivos y la seguridad.  \n Tambi\u00e9n hacer referencia a lo s objetos de aplicaci\u00f3n defini dos por el fabricante puesto \nque permiten la personalizaci\u00f3n y adapt aci\u00f3n, y favorecen la integraci\u00f3n total. \n \nDicha ZigBee Stack ser\u00e1 un elemento a tener en cuenta m\u00e1s adelante puesto que los \ndispositivos que se usen para implementa r nuestro proyecto deber\u00e1n ser totalmente \ncompatibles con ZigBee y de este modo poder programar la pila de protocolos. \n \nEn la Figura 26 vemos de forma esquematizada los distintos niveles del est\u00e1ndar \n802.15.4 y de la especificaci\u00f3n ZigBee. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   35\n \nFigura 26. Niveles est\u00e1ndar 802.15.4 \n \n2.4.2 IEEE 802.15.4 \nAntes de estudiar la especificaci\u00f3n ZigBee,  trataremos los niveles definidos por el \nest\u00e1ndar IEEE 802.15.4 espec\u00edfico para conexiones inal\u00e1mbricas tales como la nuestra. El \nest\u00e1ndar no define niveles superiores ni subcap as de interoperabilidad. Existen extensiones, \ncomo la especificaci\u00f3n ZigBee, que comple mentan al est\u00e1ndar en la propuesta de \nsoluciones completas.  \n IEEE 802.15.41 es la base sobre la que se de fine la especificaci\u00f3n de ZigBee, cuyo \nprop\u00f3sito es ofrecer una soluci\u00f3n completa para  este tipo de redes construyendo los niveles \nsuperiores de la pila de protoc olos que el est\u00e1ndar no cubre.  \n El prop\u00f3sito del est\u00e1ndar  es definir los niveles de red b\u00e1sicos para dar servicio a un \ntipo espec\u00edfico de red inal\u00e1mbrica de \u00e1rea personal (WPAN) centrada en la habilitaci\u00f3n de comunicaci\u00f3n entre dispositivos con bajo coste y velocidad. Se enfatiza el bajo coste de \ncomunicaci\u00f3n con nodos cercanos y sin infraestr uctura, o con muy poca, para favorecer \na\u00fan m\u00e1s el bajo consumo.  \n En su forma b\u00e1sica se concibe un \u00e1rea de  comunicaci\u00f3n de 10 metros con una tasa \nde transferencia de 250kbps. Como se ha indicado, la caracter\u00edstica fundamental de \n802.15.4 entre las WPAN\u2019s es la obtenci\u00f3n de costes de fabricaci\u00f3n excepcionalmente  \nbajos por medio de la sencillez tecnol\u00f3gic a, sin perjuicio de la generalidad o la \nadaptabilidad.  \n Entre los aspectos m\u00e1s importantes se encuentra la adecuaci\u00f3n de su uso para \ntiempo real por medio de slots2 de tiempo garantizados, ev itaci\u00f3n de colisiones por \nCSMA/CA y soporte integrado a las com unicaciones seguras. Tambi\u00e9n se incluyen Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   36funciones de control de consumo de energ\u00ed a como calidad del enlace y detecci\u00f3n de \nenerg\u00eda.  \n \n2.4.2.1  Arquitectura de los Protocolos \nLa definici\u00f3n de los distintos niveles se basa en el modelo OSI. Aunque los niveles \ninferiores (f\u00edsico y enlace de datos) se definen en el est\u00e1ndar 802.15.4, se prev\u00e9 la \ninteracci\u00f3n con el resto de niveles por medio de un subnivel de Control de Enlace L\u00f3gico \nbasado en IEEE 802.2 (LLC, Logical Link Control ), que acceda al Control de Acceso al \nMedio (MAC) a trav\u00e9s de un subnivel de conv ergencia. La implementaci\u00f3n puede basarse \nen dispositivos externos o integrar lo todo en dispositivos aut\u00f3nomos. \n \n \nFigura27. Pila de protocolos modelo OSI \n2.4.2.2  Nivel F\u00edsico \nEl nivel f\u00edsico (PHY) propor ciona el servicio de tran smisi\u00f3n de datos sobre el \nmedio f\u00edsico propiamente dicho, as\u00ed como la interfaz con la entidad de gesti\u00f3n del nivel \nf\u00edsico, por medio de la cual se puede acceder a todos los servicios de gesti\u00f3n del nivel y \nque mantiene una base de datos con inform aci\u00f3n de redes de \u00e1rea personal relacionadas. \n \nDe esta forma, PHY controla el transcepto r de radiofrecuencia y realiza la selecci\u00f3n \nde canales junto con el control de consumo y de la se\u00f1al. Como ya se ha comentado con anterioridad, se opera en una de las tres  posibles bandas de frecuencia siguientes: \n \n- 868-868.8MHz: Europa. Permite de uno a tres canales. \n- 902-928MHz: Norte Am\u00e9rica. Permite  de diez a treinta canales. \n- 2400-2483.5MHz: Uso en todo el mundo. Permite hasta diecis\u00e9is canales. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   37\n \nFigura 28.  Banda de frecuencias \n La versi\u00f3n original del est\u00e1ndar (2003) es pecifica dos niveles f\u00edsicos basados en \nEspectro Ensanchado por Secuencia Directa (DSSS, Direct Sequence Spread Spectrum ).  \n \nUno de los dos niveles f\u00edsicos trabaja en las bandas de 868/ 915MHz con tasas de \ntransferencia de entre 20 y 40kbps ; el otro nivel trabaja en la  banda de 2450MHz con hasta \n250kbps. Posteriormente se realiz\u00f3 una revisi \u00f3n en el 2006 incrementando las tasas de \ndatos m\u00e1ximas de las bandas de 868/915MHz, pasando a transmitir hasta 100 y 250kbps. \n \nEn el nivel f\u00edsico podemos localizar cuatro ni veles f\u00edsicos distintos en base al m\u00e9todo \nde modulaci\u00f3n usado. Tres de estos cuatro niveles conservan el mecanismo DSSS: las \nbandas de 868-915MHz que usan modulaci\u00f3n en fa se binaria o por cuadratura en offset \n(OQPSK, Offset Quadrature Phase Shift Keying ). En la banda de 2450MHz se usa la \nt\u00e9cnica OQPSK.  \n \nAdicionalmente, se define una combinaci \u00f3n opcional de modulaci\u00f3n binaria y en \namplitud para las bandas de menores frecuencias , basadas por lo tanto en una difusi\u00f3n de \nespectro paralela, no secuencial (PSSS). Si se  usan \u00e9stas bandas de menor frecuencia, se \npuede cambiar din\u00e1micamente el nivel f\u00edsico usado entre los soportados.  \n \n2.4.2.3  Nivel Enlace de Datos \nEn este nivel encontramos el Control de  Acceso al Medio (MAC). \u00c9ste transmite \ntramas MAC usando para ello el canal f\u00edsico. Adem\u00e1s del servicio de datos, ofrece un interfaz de control y regula el  acceso al canal f\u00edsico y al balizado de la red. Tambi\u00e9n \ncontrola la validaci\u00f3n de las tramas y las asociaciones entre nodos, y garantiza slots de \ntiempo. Por \u00faltimo, ofrece puntos de enganche para servicios seguros.  \n \nEn el nivel de enlace de datos podemos localizar el Control de Enlace L\u00f3gico \n(LLC) que hace la funci\u00f3n de interfaz con los nive les superiores de la pila de protocolos.  \n \nEn la figura 29 podemos observar los ni veles definidos por el est\u00e1ndar 802.15.4 y \nlas capas intermedias que posibilitan la com unicaci\u00f3n con los niveles superiores definidos \npor un tipo de especificaci\u00f3n WPAN, como ZigBee. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   38\n \nFigura 29. Pila de protocolos del est\u00e1ndar IEEE 802.15.4 \n \n2.4.3 Especificaci\u00f3n Zigbee \n Nivel de RED \nLos cometidos principales del nivel de red son permitir el correcto uso del subnivel \nMAC, definido por el est\u00e1ndar 802.15.4, y ofr ecer un interfaz adecuado para su uso por \nparte del nivel inmediatamente superior, el  nivel de aplicaci\u00f3n. Sus capacidades son las \nt\u00edpicas de un nivel de red cl\u00e1sico.  \n Por una parte, la entidad de datos crea y gestiona las unidades de datos del nivel de \nred a partir del payload del nivel de aplicaci\u00f3n y realiza el ruteo en base a la topolog\u00eda de \nla red en la que el dispositivo se encuentra. Por otra parte, las funciones de control del \nnivel de red controlan la c onfiguraci\u00f3n de nuevos dispositi vos y el establecimiento de \nnuevas redes; puede decidir si  un dispositivo colindante pert enece a la red e identifica \nnuevos routers y vecinos. El control puede detectar as\u00ed mismo la presencia de receptores, lo que posibilita la comunicaci\u00f3n directa y la sincronizaci\u00f3n a nivel MAC.  \n \nNivel de APLICACI\u00d3N \nEl nivel de aplicaci\u00f3n es el m\u00e1s alto de finido por la especificaci\u00f3n y, por tanto, la \ninterfaz efectiva en tre el nodo ZigBee y sus usuarios. En \u00e9l  se ubican la mayor parte de los \ncomponentes definidos por la especificaci\u00f3n: tanto ZDO\u2019s, como sus procedimientos de \ncontrol y los objetos de aplicaci\u00f3n. \n \nComponentes principales \nEl ZDO se encarga de la definici\u00f3n del rol de un di spositivo como Coordinador \nZigBee o Dispositivo Final. Adem\u00e1s, el ZDO id entifica los dispositivos que se encuentran \na un salto en la red (dispositivos vecinos) y los servicios que ofrece n. Tras ello, puede \nproceder a establecer enlaces seguros con dispositivos externos y responder peticiones. \n \nEl subnivel de soporte a la aplicaci\u00f3n (APS, Application Support Sublayer ) es el \nsegundo componente b\u00e1sico del nive l. Como tal, ofrece una interfaz bien definida y Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   39servicios de control asociados. Trabaja como ne xo de uni\u00f3n entre el nivel de red y el resto \nde componentes del nivel de aplicaci\u00f3n. Mantie ne actualizadas las tablas de asociaciones \nen forma de base de datos, que puede utilizar se para encontrar dispositivos adecuados en \nbase a los servicios demandados y ofrecidos. Co mo puente entre dos niveles, encamina los \nmensajes a lo largo de la pila de protocolos. \n \n2.4.4 Dispositivos que Constituyen una Red Zigbee \nEn una red ZigBee podemos encontrar y detect ar tres tipos de dispositivos ZigBee \ndiferentes, seg\u00fan el papel que desarrollen en nuestra red. Estos dispositivos son los \nsiguientes: \n \n- Coordinador ZigBee ( ZigBee Coordinator , ZC): Consiste en el dispositivo m\u00e1s \ncompleto de los tres, puesto que sus func iones son las de cont rolar y coordinar la \nred y los caminos que deben seguir los dis positivos para conect arse entre ellos. \nDebemos encontrar obligatoriamente un ZC en cada red ZigBee. \n - Router ZigBee ( ZigBee Router , ZR): Su funci\u00f3n es la  de interconectar los \ndispositivos separados en la topolog\u00eda de  la red, adem\u00e1s de ofrecer un nivel de \naplicaci\u00f3n para la ejecuci\u00f3n de c\u00f3digo de usuario. \n \n - Dispositivo Final ( ZigBee End Device , ZED): En este dispositivo queda \nrepresentado las principales caracter\u00edsticas de ZigBee, como son el bajo consumo y \nel bajo coste. Los ZED poseen la funciona lidad necesaria para comunicarse con su \nnodo padre, que ya puede ser el Router Zi gBee o el Coordinador ZigBee, pero no \npuede transmitir informaci\u00f3n destinada a otros dispositivos. Es por ello, que este tipo de dispositivo puede estar \u201cdormido\u201d la mayor parte del tiempo aumentando as\u00ed la vida media de sus bater\u00edas. Un  ZED tiene requerimientos m\u00ednimos de \nmemoria y es por ello significativamente m\u00e1s barato. \n Vistas las funciones realizadas por los dis tintos tipos de dispositivos que forman una \nred ZigBee podemos clasificarlos, seg\u00fan su f uncionalidad, en dos tipos de nodo definidos \npor el est\u00e1ndar 802.15.4: \n \n- Dispositivo de Funcionalidad Completa (FFD, Full-Function Device ): Conocido \ntambi\u00e9n como nodo activo. Gracias a la memoria adicional y a la capacidad de \ncomputar puede funcionar como Coordinador  o Router ZigBee de una red de \u00e1rea \npersonal (PAN) o como un nodo normal. Implementa un modelo general de \ncomunicaci\u00f3n que le permite establecer un intercambio con cualquier otro \ndispositivo pudiendo encaminar mensaj es, en cuyo caso se le denomina \ncoordinador (coordinador de la PAN si es el responsable de  toda la red y no s\u00f3lo de \nsu entorno). Puede ser usado en dispositivos de red que act\u00faen de interface con los usuarios. \n \n- Dispositivo de Funcionalidad Reducida (RFD, Reduced-Function Device ): \nConocido tambi\u00e9n como nodo pasivo. Po see una capacidad y funcionalidad \nlimitada para garantizar un ba jo coste y una gran simplic idad, por ello s\u00f3lo pueden Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   40comunicarse con FFD\u2019s y nunca puede n ser coordinadores. B\u00e1sicamente \nconstituyen los sensores de la red. \n \n2.4.5 Comunicaciones y Descubrimientos de Dispositivos \nPara que los dispositivos que forman una aplicaci\u00f3n puedan comunicarse, deben \nutilizar un protocolo de aplicac i\u00f3n compartido. Estos acuerdos se agrupan en perfiles. En el \nmomento de establecer una comunicaci\u00f3n entr e los distintos dispositivos se realiza \nmediante pares de identificadores fuente y destino (identificadores de cluster ), agrupando \nlas parejas en tablas de asociaciones. Dichas tablas estar\u00e1n correctamente almacenadas en \nlos Coordinadores ZigBee.  \n En base a la informaci\u00f3n disponible, el  descubrimiento de dispositivos puede \nefectuarse utilizando varios m\u00e9t odos. En caso de conocer la di recci\u00f3n de red, se pide la \ndirecci\u00f3n IEEE utilizando unicast3 . Si no es as\u00ed, se pide por broadcast 4. Los Dispositivos \nFinales ZigBee responden a esta s peticiones con sus direccione s propias, mientras que los \nRouters y Coordinadores ZigBee env\u00edan tambi\u00e9n las direcciones de todos los dispositivos asociados a ellos.  \n \nLos identificadores de cluster favorecen la asociaci\u00f3n entre entidades \ncomplementarias por medio de tablas de as ociaci\u00f3n, mantenidas en los Coordinadores \nZigBee, ya que estas tablas siempre han de estar disponibles en una red. Los \nCoordinadores son los encargados de guardar las tablas ya que, de entre todos los nodos, \nson los que con mayor seguridad dispondr\u00e1n de  una alimentaci\u00f3n continua. Para establecer \nasociaciones entre diferentes dispositivos se necesita que se  haya formado un enlace de \ncomunicaci\u00f3n, tras ello se decide si es neces ario adjuntar un nuevo nodo a la red en base a \nla aplicaci\u00f3n y las pol\u00edticas de seguridad. Nada m\u00e1s establecerse la asociaci\u00f3n, pueden iniciarse las comunicaciones.  \n \nExisten dos modos de direccionamientos. Po r una parte, el direccionamiento directo \nutiliza la direcci\u00f3n de radio y el n\u00famero de endpoint 5; por otra parte, el direccionamiento \nindirecto necesita toda la informaci\u00f3n relevante (direcci\u00f3n, endpoint , cluster y atributo), y \nla env\u00eda al Coordinador de la red. El Coordina dor es el encargado de traducir su petici\u00f3n y \nproporcionarle los datos deseados. Este \u00faltimo direccionamiento es especialmente \u00fatil para \nfavorecer el uso de dispositivos muy sencillo s y minimizar el almacenamiento interno. \n \n2.4.6 Modos de Funcionamiento \nEl funcionamiento de ZigBee debe cumplir  la premisa del bajo consumo de sus \nnodos. Para ello un nodo ZigBee, tanto activo como pasivo, reduce su  consumo gracias a \nque puede permanecer \u201cdormido\u201d la mayor parte del tiempo, incluso muchos d\u00edas \nseguidos. Cuando decimos que el nodo permanece \u201c dormido\u201d nos referimos a que est\u00e1 a la \nespera de ser activado por parte del Router o del Coordinador ZigBee.  \n Cuando se requiere su uso, el nodo ZigB ee es capaz de despertar en un tiempo \n\u00ednfimo, para volverse a \u201cdormir\u201d cuando deje  de ser requerido. El tiempo que tarda un \nnodo cualquiera en despertarse es de aproxi madamente 15ms. Las redes ZigBee han sido \ndise\u00f1adas para conservar la potencia en lo s nodos esclavos (ZED),  de esta forma se \nconsigue el bajo consumo de potencia. La id ea del funcionamiento ZigBee consiste en que Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   41los dispositivos esclavos en todo moment o permanecen en modo \u201cdormido\u201d a no ser que \nsean activados, de tal forma que solo se \u201cdespiertan\u201d por una fracci\u00f3n de segundo para \nconfirmar que siguen en nuestra red de dispositi vos de la que forman parte, es decir, que \nsiguen \u201cvivos\u201d.  \n En las redes ZigBee, se pueden usar dos modos de funcionamiento diferentes: con \nbalizas o sin balizas. \n \nCon balizas \nEn este modelo de funcionamiento, el camino de transmisi\u00f3n y recepci\u00f3n est\u00e1 \npermanentemente controlado por un distribuidor  que se encarga de controlar el canal y \ndirigir las transmisiones. El distribuidor permite a todos los dispositivos saber cu\u00e1ndo \npueden transmitir.  \n \nPara el control del canal se utilizan las balizas, elementos que se usan para poder \nsincronizar todos los dispositivos que conforma n la red. Los intervalos de las balizas son \nasignados por el coordinador de la red (C oordinador ZigBee) y pueden variar desde los \n15ms hasta los 4 minutos.  \n \nEste modo es m\u00e1s recomendable cuando el  coordinador de red trabaja con una \nbater\u00eda. Los dispositivos que conforman la red escuchan a dicho coordinador durante el balizamiento (env\u00edo de mensajes  a todos los dispositivos - broadcast -, entre 0.015 y 252 \nsegundos). Un dispositivo que qu iere intervenir, lo  primero que tendr\u00e1 que hacer es \nregistrarse para el coordinador, y es entonces cuando mira si hay mensajes para \u00e9l. En el \ncaso de que no haya mensajes, este disposit ivo vuelve a \u201cdormir\u201d, y se despierta de \nacuerdo a un horario que ha establecido previa mente el coordinador. En cuanto el \ncoordinador termina el balizamiento, todos los di spositivos de la red vuelven a \u201cdormirse\u201d.  \n \nComo vemos, se trata de un mecanismo de  control del consumo de potencia en la \nred. \n \nSin balizas \nEn este tipo cada dispositivo es aut\u00f3no mo, pudiendo iniciar una  conversaci\u00f3n en la \ncual los otros dispositivos pueden interfer ir. A veces puede ocurrir que el nodo destino \npuede no o\u00edr la petici\u00f3n o que el dispositivo emis or pretenda transmitir cuando el canal est\u00e9 \nocupado, ocasionando posibles colisiones. Es po r ello que se debe utilizar un mecanismo \nde control de acceso al medio. Las redes si n balizas acceden al canal por medio del \nCSMA/CA. El CSMA/CA ( Carrier Sense Multiple Access with Collision Avoidance ) se \nbasa en la escucha del canal por parte del nodo que pretende transmitir, y de esta forma detecta si alg\u00fan otro nodo que compone la red est\u00e1 transmitiendo o tiene intenci\u00f3n de ello.  \n \nAl tratarse de un medio inal\u00e1mbrico, la de tecci\u00f3n de colisiones no es posible, por lo \ntanto para evitar dichas colisiones la estaci\u00f3n que quiera transmitir, si no hay tr\u00e1fico en el \ncanal, podr\u00e1 hacerlo pasado un cierto instante de  tiempo; en caso de ex istir tr\u00e1fico, deber\u00e1 \nesperar un cierto tiempo de espera m\u00e1s otro  cierto intervalo de tiempo aleatorio.  \n \nEste sistema se usa t\u00edpicamente en los si stemas de seguridad, en los cuales sus \ndispositivos duermen pr\u00e1cticamen te todo el tiempo. Pa ra que se les teng a en cuenta, estos \nelementos se \u201cdespiertan\u201d de forma regul ar para anunciar que siguen en la red.  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   42 \nCuando se produce un evento, como por  ejemplo que un sensor detecte alg\u00fan \nmovimiento, el sensor \u201cdespierta\u201d inst ant\u00e1neamente y transmite a la alarma \ncorrespondiente. Es en ese momento cuando el coordinador de re d recibe el mensaje \nenviado por el sensor y activa la  alarma pertinente. En este caso, el coordinador de red se \nalimenta de la red principal durante todo el tiempo. \n \nLos routers suelen estar activos todo el tiempo, por lo que requieren una \nalimentaci\u00f3n estable en general. Esto pe rmite redes heterog\u00e9neas en las que algunos \ndispositivos pueden estar transmitiendo todo el tiempo, mientras que otros s\u00f3lo transmiten \nante la presencia de est\u00edmulos externos. \n \nEn general, los protocolos ZigBee que no hacen uso de las baliza, minimizan el \ntiempo de actividad para evitar el uso de ener g\u00eda. En las redes con balizas, los nodos s\u00f3lo \nnecesitan estar despiertos mi entras se transmiten las baliz as (adem\u00e1s de cuando se les \nasigna tiempo para transmitir); si no hay ba lizas, el consumo de cada dispositivo ser\u00e1 \ndistinto ya que encontraremos nodos activos permanentemente y otros que s\u00f3lo lo est\u00e1n \nespor\u00e1dicamente. \n \nAcceso al medio \nEl medio f\u00edsico es un recurso al que se accede utilizando CSMA/CA. Las redes que \nno utilizan las balizas hacen uso de una variaci\u00f3n del mismo basada en la escucha del medio, temporizada por un algoritmo de backoff6 , salvo en el caso de las confirmaciones  \n(ACK, Acknowledgement ).  \n Estos mensajes de confirmaci\u00f3n puede n ser opcionales en algunos casos. La \nrecepci\u00f3n de una confirmaci\u00f3n certifica el \u00e9xito  de nuestro env\u00edo. En cualquier caso, si un \ndispositivo es incapaz de procesar una trama en un momento dado, no confirma su \nrecepci\u00f3n. Pueden realizarse  reintentos basados en timeout un cierto n\u00famero de veces, tras \nlo cual se decide si seguir intent \u00e1ndolo a dar error de transmisi\u00f3n.  \n El entorno de funcionamiento previsto para este tipo de redes exige que se \nmaximice la vida de la fuente de energ\u00eda,  por lo que se favorece n los protocolos que \nconducen a estos fines. Para ello, se program an comprobaciones peri\u00f3dicas de mensajes \npendientes, m\u00e1s o menos frecuente s seg\u00fan la aplicaci\u00f3n concreta.  \n En lo que respecta a la seguridad en la s comunicaciones, el subnivel MAC ofrece \nfuncionalidades que los niveles s uperiores pueden utilizar para lograr alcanzar el nivel de \nseguridad deseado. Estos niveles superiores pueden especificar claves sim\u00e9tricas para \nproteger los datos y restringir \u00e9stos a un grupo de dispositivos o a un enlace punto a punto.  \n Estos grupos se especifican en listas de  control de acceso. Adem\u00e1s, MAC realiza \ncomprobaciones de frescura ( freshness check ) entre recepciones sucesivas para asegurar \nque las tramas viejas cuyo contenido no se cons idera \u00fatil o v\u00e1lido ya, no transcienden a los \nniveles superiores. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   432.4.7 Modelo de Redes Zigbee \nLas redes est\u00e1n compuestas por grupos de dispositivos separados por distancias \nsuficientemente reducidas. Cada dispositivo posee un identificador \u00fanico de 64 bits, \naunque si se dan ciertas condiciones de entorn o en \u00e9ste pueden utilizarse identificadores \ncortos de 16 bits. Probablemente \u00e9stos se utilizar\u00e1n dentro del dominio de cada PAN \nseparadas.  \n \nUn aspecto a tener muy en cuenta son los tipos de topolog\u00edas de red que permite el \nest\u00e1ndar que soporta ZigBee. Su nivel de red permite tres topolog\u00edas distintas: \n \n- Topolog\u00eda en estrella. \n- Topolog\u00eda en \u00e1rbol. \n- Topolog\u00eda de malla. \n Toda red necesita al menos un dispositi vo coordinador (FFD), encargado de su \ncreaci\u00f3n, mantenimiento b\u00e1sico y control de sus par\u00e1metros. Seguidamente estudiaremos \nde forma detallada los distintos tipos de t opolog\u00edas de ZigBee, d\u00f3nde  se sit\u00faa en cada uno \nde ellos el coordinador de la red y cu\u00e1l es la topolog\u00eda m\u00e1s adecuada. \n \nTopolog\u00eda estrella \nEn redes en estrella el c oordinador se sit\u00faa en el ce ntro, y toda conexi\u00f3n que se \nquiera realizar entre los distintos nodos  de la red debe pasar por \u00e9ste.  \n \nUna red en estrella activa tiene un nodo cen tral activo que normalmente tiene los \nmedios para prevenir problemas. Se utiliza sobr e todo para redes locale s. La mayor\u00eda de las \nredes de \u00e1rea local que tienen un router , un switch o un hub7 siguen esta topolog\u00eda.  \n El nodo central, en el caso de  utilizar uno de estos dispos itivos, ser\u00eda el  router, el \nswitch o el hub por el que pasan todos los paquetes.  \n \nLas ventajas que nos puede aportar una red en estrella ser\u00eda la facilidad a la hora de \nimplementarla, adecuada para redes temporales , el fallo de un nodo perif\u00e9rico no influir\u00eda \nen el comportamiento del resto de la red y no hay problemas con colisiones de datos ya que cada estaci\u00f3n tiene su propia conexi\u00f3n al c oordinador central. En contrapartida, la \nutilizaci\u00f3n de una red en estrella nos lim ita tanto el n\u00famero de nodos que pueden estar \nconectados a la red, como la longitud del cab leado (en caso de ser una conexi\u00f3n cableada). \nTambi\u00e9n se debe tener muy en cuenta que los costes de mantenimientos pueden aumentar a \nlargo plazo, y que el fallo del nodo centra l puede echar abajo la red entera.  \n \nA causa de todo ello, podemos confirmar que una red en estrella puede ser poco \nfiable en el momento de reali zar transferencias de informaci\u00f3n \n \nTopolog\u00eda en \u00e1rbol \nTopolog\u00eda de red en la que lo s nodos est\u00e1n colocados en fo rma de \u00e1rbol. Para este \ntipo de topolog\u00eda el coordinador ser\u00e1 la ra \u00edz del \u00e1rbol. Desde una vista topol\u00f3gica, la \nconexi\u00f3n en \u00e1rbol es parecida a una serie de redes en estrella  interconectadas, salvo en que Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   44no tiene un nodo central. En cambio, tiene un  nodo de enlace troncal, generalmente \nocupado por un hub o switch , desde el que se ramifican los dem\u00e1s nodos.  \n \nEn redes de \u00e1rbol se permite el uso de Router ZigBee para interconectar los \ndistintos nodos de la red. As\u00ed mismo, la comuni caci\u00f3n en \u00e1rbol es estrictamente jer\u00e1rquica \ncon lo que puede utilizar opcionalmente tramas balizas. Una falla de un nodo no implica la \ninterrupci\u00f3n en las comunicaciones. Se compar te el mismo canal de comunicaciones.  \n Los problemas asociados a este tipo de topolog\u00eda radican en que los datos son \nrecibidos por todas las estaciones sin importar para quien vayan dirigidos. Por lo tanto es \nnecesario dotar a la red de un mecanismo que permita identificar al destinatario de los \nmensajes. Adem\u00e1s, debido a la presencia de un medio de transmisi\u00f3n compartido entre \nmuchas estaciones, pueden producirse interfer encias entre las se\u00f1ales cuando dos o m\u00e1s \nestaciones transmiten al mismo tiempo. La soluci\u00f3n al primero de estos problemas aparece con la introducci\u00f3n de un identificador de es taci\u00f3n destino. Para da rle soluci\u00f3n al segundo \nproblema, hay que mantener una coordinaci\u00f3n entre todas las estaciones, y para eso se \nutiliza cierta informaci\u00f3n de control en las tramas que controlan quien transmite en cada \nmomento (utilizaci\u00f3n de tramas ba lizas mencionadas anteriormente). \n \nTopolog\u00eda en malla \nLa topolog\u00eda m\u00e1s interesante es la topolog\u00ed a de malla. Consiste en que al menos \nuno de los nodos tendr\u00e1 m\u00e1s de dos conexion es. Con ello conseguimos que si, en un \nmomento dado, un nodo del camino falla y se cae, pueda seguir la comunicaci\u00f3n entre \ntodos los dem\u00e1s nodos debido a que se rehacen todos los caminos.  \n El establecimiento de una red de malla es  una manera de encaminar datos, voz e \ninstrucciones entre los nodos. Las redes de malla se diferencian de otras redes en que las \npiezas de la red (los nodos) est\u00e1n conectadas  unas con otras por uno u otro camino. Esta \nconfiguraci\u00f3n ofrece caminos redundantes por t oda la red, de modo que si falla un cable, \notro se har\u00e1 cargo del tr\u00e1fico.  \n Esta topolog\u00eda, a diferencia de las vistas  en apartados anteriores, no requiere de un \nservidor o nodo central, con lo que se reduce el mantenimiento. Un error en un nodo, sea \nimportante o no, no implica la ca\u00edda de toda la red.  \n Como ya se ha comentado anteriormente, las redes de malla son autogenerables. La \nred puede funcionar incluso cuando un nodo desapa rece o la conexi\u00f3n falla, ya que el resto \nde nodos evitan el paso por ese punto. Consecuen temente, se forma una red muy confiable.  \n \nGracias a las estructuras arbi trarias que permite la topol og\u00eda en malla , es posible \nllevar los mensajes de un nodo a otro por diferentes caminos. A consecuencia de este tipo de estructura no se pueden usar tramas balizas.  \n \nAl igual que en la topolog\u00eda en \u00e1rbol, las redes en malla permiten el uso de Routers \nZigBee para habilitar la comunicaci\u00f3n en el  nivel de red. \u00c9stos no son Coordinadores \nZigBee, pero pueden serlo de sus respectivos espacios de operaci\u00f3n personal definidos por \n802.15.4.  \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   45Aunque la facilidad de soluci\u00f3n de problem as y el aumento de la fiabilidad son \nventajas muy interesantes, estas redes resultan caras de instalar, ya que utilizan mucho \ncableado. \n En la siguiente figura, se puede apreciar las diferentes topolog\u00edas que puede tener \nuna red ZigBee. \n \n \nFigura 30. Topolog\u00edas de una red ZigBee \n  \n\u00c1rbol de clusters \nVistos los tipos de topolog\u00edas que pode mos manipular, encontramos que nuestro \nest\u00e1ndar menciona un tipo de red definido como \u201c\u00e1rbol de clusters \u201d. Para ello se usan redes \npunto a punto.  \n Las redes punto a punto pueden formar pa trones arbitrarios de conexionado, donde \nsu extensi\u00f3n se ve limitada \u00fanicamente por la distancia existente entr e cada par de nodos.  \n \nForman la base de redes ad hoc8 autoorganizativas. El est\u00e1ndar no define un nivel \nde red, por lo que no se sopor tan funciones de ruteo de form a directa, aunque si ha dicho \nnivel se le a\u00f1ade se pueden realizar  comunicaciones en varios saltos.  \n Las estructuras \u00e1rbol de clusters  est\u00e1n formadas por el conexionado entre nodos \nFFD y RFD. Puesto que se necesita de al menos un nodo FFD para poder conectar \ndiferentes RFD\u2019s, se aprovecha de ello para generar estructuras donde los nodos RFD\u2019s simbolizan las hojas de un \u00e1rbol, y donde la mayor\u00eda de los nodos son FFD\u2019s. A partir de \nlos \u00e1rboles de clusters podemos generar grandes redes de malla, cuyos nodos sean \u00e1rboles \nde clusters con un coordinador local para cada cluster , junto con un coordinador global.   \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   46\n \nFigura 31. \u00c1rbol de clusters \n \n2.4.8 Otros Medios de Transmisi\u00f3n de Datos y Elecci\u00f3n Final \nComo ya hemos podido comprobar, el desa rrollo de la tecnol og\u00eda de ZigBee se \ncentra en la sencillez y bajo coste de sus nodos y en el bajo nivel de transmisi\u00f3n de \ninformaci\u00f3n. Es por ello que su utilizaci\u00f3n en este proy ecto es la m\u00e1s adecuada en \ncomparaci\u00f3n con otras redes inal\u00e1mbricas semejantes de la familia WPAN, como por ejemplo Bluetooth.  \nZigBee vs. Bluetooth \nZigBee es muy similar a Bluetooth, pero con algunas diferencias: \n \n- Una red ZigBee puede constar de m\u00e1s de 65000 nodos distribuidos en subredes de \n255 nodos, frente a los 8 m\u00e1ximos de una subred (piconet9) Bluetooth. \n \n- Menor consumo el\u00e9ctrico que el de Bluet ooth. Este menor consumo se debe a que \nel sistema ZigBee, como ya se ha menci onado anteriormente, se queda la mayor \nparte del tiempo dormido, mientras que en  una comunicaci\u00f3n Blue tooth esto no se \npuede dar ya que suelen estar siempre transmitiendo y/o recibiendo. \n \nEn la siguiente tabla podemos ver en t\u00e9rm inos exactos el consumo de ZigBee y de \nBluetooth. \n \n \nTabla 6. Consumo ZigBee Vs Bluetooth \n \nLa velocidad ZigBee es menor a la de Bluetooth. ZigBee tiene una velocidad de \nhasta 250kbps, mientras que en Bluetooth es de hasta 1Mbps. Esta diferencia de valores es \nl\u00f3gica si tenemos en cuenta que ZigBee se basa  en una transmisi\u00f3n de  datos baja, y por lo \ntanto no nos afecta en gran medida en el mo mento de transmisi\u00f3n y recepci\u00f3n de datos. \n Vistas las principales diferencias entr e ZigBee y Bluetooth, podemos llegar a la \nconclusi\u00f3n de que uno es m\u00e1s apropiado que el  otro para ciertas aplicaciones. Haciendo \nreferencia a la diferencia de velocidades, Bluetooth se usa para aplicaciones con mayor \ncarga de informaci\u00f3n para transmitir, como  por ejemplo para tel\u00e9fonos m\u00f3viles e Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   47inform\u00e1tica casera; la velocidad de ZigBee se hace insuficiente para estas tareas, \ndesvi\u00e1ndolo a usos tales como la dom\u00f3tica, los productos dependientes de la bater\u00eda, \nart\u00edculos de jugueter\u00eda y sensores m\u00e9dicos, en lo s cuales la transferencia de datos es menor.  \n \u00c9ste \u00faltimo caso de utilizaci\u00f3n de ZigBee, los sensores m\u00e9dicos, nos garantiza que \nZigBee ser\u00e1 un medio id\u00f3neo para este proyecto que se basa en la transmisi\u00f3n de datos a \npartir de medidas capturadas por  un sensor de temperatura. \n \nWireless USB \nWireless USB es un protocolo de comuni caci\u00f3n inal\u00e1mbrica por radio con gran \nancho de banda, que combina la sencillez de us o de USB con la versatilidad de las redes \ninal\u00e1mbricas.  \n \nUtiliza como banda frecuencial la plataforma UWB ( Ultra-Wide Band ), operando \nen los rangos de frecuencia de 3.1 a 10.6GHz. Pu ede lograr tasas de transmisi\u00f3n de hasta \n480Mbps en rangos de tres metros y 110Mbps en rangos de diez metros.  \n \nGracias a su alta tasa de transferencia, Wireless puede usarse para aplicaciones que \nrequieren un flujo de transferencia elev ado. Wireless USB se utiliza en mandos de \nvideoconsola, impresoras, esc\u00e1neres, transm isi\u00f3n y visualizaci\u00f3n de v\u00eddeos, etc.  \n \nHaciendo una comparativa de los principale s aspectos de Wireless USB, Bluetooth, \nWi-Fi y ZigBee, como podemos comprobar en la  siguiente tabla, el rango de frecuencia en \nel que trabaja Wireless es superior al de lo s otros medios de transmisi\u00f3n, al mismo tiempo \nque su tasa de transferencia es m\u00e1s elevada.  Centr\u00e1ndonos en los valores de transferencia y \nutilizando la l\u00f3gica, a mayor tasa de transfer encia mayor ser\u00e1 el consumo, con lo cual no \nnos beneficia para el tipo de  proyecto que queremos llevar a cabo. ZigBee sigue siendo la \nmejor opci\u00f3n. \n \n \nTabla 7. Comparativa ZigBee \u2013 Bluetooth \u2013 Wireless USB \u2013 Wi-Fi  \n \nWi-Fi \nWi-Fi, al igual que el resto de medios que estamos analizando, consiste en un \nsistema de env\u00edo de datos sobre redes que utiliza ondas en lugar de cables ( wireless ). Se \nbasa en el est\u00e1ndar IEEE 802.11, y es por ello  que podemos encontrar diversos tipos de \nWi-Fi: \n \n- Los est\u00e1ndares IEEE 802.11 son f\u00e1cilmente aceptados debido a que usan la banda \nfrecuencial de 2.4GHz. \n- La velocidad de transferencia del medi o depende del est\u00e1ndar que se haga uso. \nPuede proporcionarnos una velocida d de 11Mbps (IEEE 802.11b) hasta 108Mbps \n(IEEE 802.11n), pasando por los 54Mbps del est\u00e1ndar IEEE 802.11g. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   48- En la actualidad ya se utiliza el est\u00e1ndar IEEE 802.11a, conocido como Wi-Fi5 ya \nque opera en la banda de 5GHz. Dich a banda frecuencial (5GHz) ha sido \nrecientemente habilitada. Al no existir ot ras tecnolog\u00edas como ZigBee o Bluetooth \nque hagan uso de ella, nos garantiza un m\u00ednimo de interferencias vecinas. Su alcance es algo menor que el de los est\u00e1ndares que trabajan a 2.4GHz. \n \nLa principal ventaja que nos proporciona Wi -Fi, aparte de las altas velocidades de \ntransferencia, es la capacidad de suministrar cobertura en un gran rango de distancia (capaz \nde alcanzar los 100 metros).  \n Por otra parte, la desventaja fundamental de estas redes existe  en el campo de la \nseguridad. Existen algunos programas capaces de capturar paquetes enviados y calcular la \ncontrase\u00f1a de la red, y de esta forma acceder a ella. Al igual que el resto de medios de transmisi\u00f3n wireless , la velocidad de transferencia se ve  disminuida al no utilizar cables.  \n Vistos los principales puntos que nos puede aportar la utilizaci \u00f3n de Wi-Fi (altas \nvelocidades de transmisi\u00f3n y gran cobertura) , se puede concluir que este tipo de medio \nquedar\u00eda fuera del tipo de transmisi\u00f3n que se pr etende llevar a cabo al  necesitar una mayor \nfuente de energ\u00eda para poder proporci onar dichas tasas de velocidades. \n \nWibree \nWibree resultar\u00eda ser una opci\u00f3n a tener en cu enta para su empleo en este proyecto \npuesto que sus principales caracter\u00edsticas y su s principios b\u00e1sicos son parejos a los ya \nvistos en ZigBee.  \nWibree es una nueva tecnolog\u00eda digital de radio interoperable para peque\u00f1os \ndispositivos. Consiste en una tecnolog\u00eda de  comunicaci\u00f3n inal\u00e1mbrica que nos ofrece \nconexi\u00f3n y comunicaci\u00f3n entre dispositivos m\u00f3v iles o computadores y otros dispositivos \nm\u00e1s peque\u00f1os. Su dise\u00f1o est\u00e1 pensado para que funcione con un consumo de energ\u00eda m\u00ednimo. \n Al igual que en ZigBee, Wibree opera a los 2.4GHz (banda ISM) haciendo posible \nla comunicaci\u00f3n entre dispositivos de pila de  bot\u00f3n y dispositivos Bluetooth. Su tasa de \ntransferencia es superior resp ecto a ZigBee: 250kbps de ZigB ee frente a 1Mbps de Wibree. \n Puesto que en este proyecto la cantidad de informaci\u00f3n a transmitir ser\u00e1 m\u00ednima \n(datos medidos por el sensor de temperatura), la tasa de transferencia tampoco interesa, en \nprimera instancia, que sea muy elevada. \n Wibree se dise\u00f1\u00f3 para dos modos distintos de implementaci\u00f3n:  \n- Wibree de implementaci\u00f3n \u00fanica: Esta implementaci\u00f3n est\u00e1 pensada para el \nfuncionamiento de dispositivos que requieren un consumo bajo de energ\u00eda, \npeque\u00f1os y de bajo costo, como por ejemplo relojes, sensores deportivos, teclados \ninal\u00e1mbricos, etc. \n - Wibree de implementaci\u00f3n modo dual (Bluetooth  \u2013 Wibree): Se dise\u00f1a para su uso \nen dispositivos Bluetooth donde Wibree se integra con Bluetooth y BluetoothRF, Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   49utilizando los dispositivos existentes y diri gidos especialmente a dispositivos como \ntel\u00e9fonos m\u00f3viles y computadoras personales. \n \nTinyOS \nTinyOS es un sistema operativo open source basado en componentes para redes de \nsensores inal\u00e1mbricas. Est\u00e1 dise\u00f1ado para  incorporar nuevas innovaciones r\u00e1pidamente y \npara funcionar bajo las importantes restricci ones de memoria que se dan en las redes de \nsensores. \n \nLas aplicaciones para TinyOS se escriben en nesC, un dialecto del lenguaje de \nprogramaci\u00f3n C optimizado para las limitaciones de memoria de las redes de sensores; \ndonde el lenguaje de programaci\u00f3n nesC consiste  en un conjunto de tareas y procesos que \ncolaboran entre s\u00ed. Existen, adem\u00e1s, varias herramientas que completan y facilitan su uso, \nescritas en su mayor\u00eda en Java y en Bash.  \n TinyOS proporciona interfaces, m\u00f3dulos y configuraciones espec\u00edficas, que \npermiten a los programadores construir progra mas como una serie de m\u00f3dulos que hacen \ntareas espec\u00edficas. Los m\u00f3dulos de TinyOS pr oporcionan interfaces para los tipos est\u00e1ndar \nde entradas y salidas de  hardware y sensores. \n A pesar de que TinyOS no sea una tecnolog\u00ed a para comunicaciones inal\u00e1mbricas, se \npuede tener en cuenta su u tilizaci\u00f3n para posib les configuraciones y programaciones de \nredes inal\u00e1mbricas. \n \n                 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   50Comparativa general \n \nTabla 8. Comparativa entre los distintos medios de transmisi\u00f3n de datos \n \nUna vez analizados los distintos medios de transmisi\u00f3n inal\u00e1mbricos podemos \nconcluir diciendo que cada uno de los medios se adapta mejor a un tipo de necesidades, \npero en este caso son primordial es el bajo consumo y la baja transmisi\u00f3n de datos, por lo \ntanto el medio que mejor se adapta es ZigBee. \n \n    \n \n   Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   512.5 M\u00f3dulos Zigbee en el Mercado. \nActualmente existen cerca de una veintena  de compa\u00f1\u00edas dedicadas entre otras \ncosas a la manufacturac\u00f3n de chips ZigBee, entre ellas, las m\u00e1s importantes son las \nsiguientes: Atmel Corporation,  Chipcon, Crossbow, Ember Co rporation, Freescale, etc. \nMaxStream al igual que otros fabricantes de sarrollan M\u00f3dulos ZigBee utilizando estos \nchips, MaxStream ha optado por la plataforma ZigBee de Freescale. \n \nEn este apartado se analizan distinto s m\u00f3dulos ZigBee a fin de comparar sus \nespecificaciones m\u00e1s relevantes. Entre las especificaciones se pueden mencionar a modo \nde ejemplo la corriente de transmisi\u00f3n, la corriente de recepci\u00f3n, la dimensi\u00f3n, los tipos de antenas, etc. \n \n \nTabla 9. Comparativa m\u00f3dulos Zigbee Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   52\n \nTabla 10. Comparativa m\u00f3dulos Zigbee \n \nAnalizando las tablas comparativas se pue de observar que lo s productos ZigBee de \nMaxStream son la mejor opci\u00f3n frente a otros m\u00f3dulos de la competencia. Cuentan con \nunas dimensiones reducidas, una f\u00e1cil integrac i\u00f3n, diferentes tipos de antenas seg\u00fan las \nnecesidades del usuario final, un consum o aceptable, una buena disponibilidad, y la \ncaracter\u00edstica m\u00e1s relevante es la concesi\u00f3n del cer tificado ZigBee. \n Adem\u00e1s, cabe destacar que existe bastante informaci\u00f3n, resultando ser un factor \nimportante al momento de elegir un \u00f3dulo ZigBee, ya que una buena documentaci\u00f3n \npermitir\u00e1 que el desarrollo del proyecto avance de forma continuada y fluida en el transcurso del tiempo.  \nLa familia de productos Xbee de MaxStream  ha recibido la homologaci\u00f3n ZigBee \nque concede ZigBee Alliance, superando rigurosas  pruebas hasta convertirse en uno de los \npocos productos en recibir la  exclusiva homologaci\u00f3n ZigBee. \n \n2.5.1 Elecci\u00f3n Final \nLa familia Xbee presenta 2 m\u00f3dulos, el Xbee y el Xbee-PRO. Las caracter\u00edsticas de \nambos son las siguientes: \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   53\n \nTabla 11.  Comparativa m\u00f3dulos Xbee y Xbee Pro \n \n Para el desarrollo de este  proyecto, se ha optado por escoger el modulo Xbee, con \nantena chip integrada. De los dos es el que m\u00e1s se ajusta por su bajo consumo y \ndimensiones.  \n Con antena chip integrada, los alcances de las especificaciones se reducen un 70%, \naun as\u00ed, siguen siendo m\u00e1s que suficiente s para el objetivo de este proyecto. \n \n  \n \n \n \n     Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   542.6 El Microcontrolador \n2.6.1 Funci\u00f3n \nEl microcontrolador se encargar\u00e1 de gest ionar los recursos y los componentes. Se \nencargar\u00e1 de temporizar los es tados de bajo consumo cuando no se necesite la temperatura \ny de despertar a los diferentes m\u00f3dulos cuando se requiera su uso. \n \n2.6.2 Requisitos \nEl microcontrolador escogido tendr\u00e1 que  comunicarse con el m\u00f3dulo Xbee de \nMaxStream y el sensor MCP9804 de Microchip. \n \nPartiendo de las caracter\u00edsticas de cada uno de los equipos se debe elegir el \nmicrocontrolador m\u00e1s adecuado. \n \nSensor MCP9804. \nTensi\u00f3n de alimentaci\u00f3n: desde 2\u20197 V a 5\u20195 V \n Entradas / salidas digitales necesarias:  \n \nFigura 32.  MCP9804 \n Para su comunicaci\u00f3n, el sensor  MCP9804 utiliza el protocolo I\n2C. \n SDA \u2013  PIN 1  SCL \u2013   PIN 2 La se\u00f1al de Alert (PIN 3) no se utilizar\u00e1 en esta aplicaci\u00f3n. Las se\u00f1ales A0, A1 y A2 (PIN 7, 6 y 5) se configurar\u00e1n por hardware. \n      Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   55M\u00f3dulo Xbee. \n \n \nFigura 33. M\u00f3dulo Xbee \n Tensi\u00f3n de alimentaci\u00f3n: desde 2\u20198 V a 3\u20194 V  Entradas / salidas digitales necesarias:  Para su comunicaci\u00f3n, el m\u00f3dulo XBee utiliza la UART \nDOUT \u2013  PIN 2 \n DIN \u2013   PIN 3  Para entrar en modo de bajo consumo y sali r del modo en bajo consumo se utiliza el \nPIN 9. \n SLEEP_RQ \u2013 PIN 9  El resto de entradas / salidas no se aplican en este proyecto. \n Por lo tanto el microcontrolador deber\u00e1 disponer:  \n- Capacidad para una comunicaci\u00f3n I\n2C \n- Capacidad para una comunicaci\u00f3n UART \n- Un pin digital para controlar el modo  de funcionamiento del m\u00f3dulo XBee. \n- Debe funcionar con una tensi\u00f3n de alim entaci\u00f3n comprendida entre 2\u20198V y 3\u20194V. \n- Debe poder trabajar en modo de bajo  consumo y despertarse por si solo \ntranscurrido un determinado periodo de tiempo. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   56PIN\n1S D A2S C L2D O U T3D I N9 SLEEP_RQI2C\nUARTRequisitos Microcontrolador\nM\u00f3dulo XbeeSensor MCP9804Dispositivo\n \nTabla 12. Requisitos del microcontrolador. \n \n2.6.3 Alternativas \nAunque existen m\u00faltiples fabricantes, los posibles microcontroladores se han \nbuscado dentro de la gama que el  fabricante MICROCHIP posee. \n El principal motivo de la decisi\u00f3n de us ar un microcontrolador de MICROCHIP es \nque suelen ser de bajo coste y ya disponemos de  las herramientas y equipos necesarios para \nsu programaci\u00f3n. \n El programa usado para su programaci\u00f3n ha si do el CCS y el hardware para cargar \nlos progamas el USB PIC BURNER. \n2.6.4 Elecci\u00f3n Final \nDentro de la amplia gama de microcont roladores que posee Mi crochip, tiene las \nversiones LF que trabajan a baja tensi\u00f3n. \n Para esta aplicaci\u00f3n, estas versiones son las m\u00e1s id\u00f3neas ya que trabajan a partir de \nlos 2V de tensi\u00f3n de alimentaci\u00f3n. El rest o de familias necesitan 4\u20192V como m\u00ednimo. \n Al ser un prototipo no se ha buscado ajusta r el microcontrolador a las necesidades \niniciales de dise\u00f1o, ya que limitar\u00eda al equipo en sus posibles mejoras, por lo que se ha \nbuscado un microcontrolador que facilitase la incorporaci\u00f3n de nuevas opciones al prototipo. \n Finalmente, el microcontrolador es cogido es el PIC 18LF2525. Es un \nmicrocontrolador de 24 pines, no excesivamen te grande, pero lo suficiente para poder \ndisponer de puertos libres pa ra posibles ampliaciones. \n Las caracter\u00edsticas de este microcont rolador son iguales a las del PIC 18F2525, \n\u00fanicamente cambia la tensi\u00f3n m\u00ednima de alimentaci\u00f3n. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   57\n \nTabla 13. Caracter\u00edsticas PIC18F2525. \n \n          Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   582.7 M\u00f3dulo 2: Equipo de Sobremesa \n2.7.1 Funciones: \nEl m\u00f3dulo 2 es el equipo encargado de r ealizar las funciones de interface con el \nusuario. Su principal misi\u00f3n ser\u00e1 la de most rar en todo momento la temperatura corporal \nque el m\u00f3dulo 1 est\u00e1 midiendo. \nA su vez, permitir\u00e1 que el usuario disponga de una serie de opciones para ajustarse \na las necesidades de este. \n \nEntre otras cosas deber\u00e1 permitir: \n \n- Conocer si el m\u00f3dulo 1 se encuen tra con bater\u00eda o sin bater\u00eda. \n- Programar la temperatura a la que quie re que el dispositivo de la alarma. \n \n2.7.2 Diagrama de Bloques: \n \nEl diagrama de bloques del m odulo 2 ser\u00e1 el siguiente: \nRegulador 3'2V uCLCD\nSist. WirelessRegulador 5V\nAC / DC\n \nFigura 34. Diagrama funcional de bloques M\u00f3dulo 2 \n Estar\u00e1 formado por:  \n- Un circuito de alimentaci\u00f3n. \nSe encargar\u00e1 de alimentar los diferentes  elementos con las tensiones adecuadas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   59 \n- El microcontrolador \nSe encargar\u00e1 de gestionar la informaci\u00f3n re cibida por los pulsa dores y el m\u00f3dulo de \ncomunicaci\u00f3n Xbee. Enviar\u00e1 la informaci \u00f3n al m\u00f3dulo LCD para mostrarlo por \npantalla y se podr\u00e1 configurar la aplicaci\u00f3n. \n - El m\u00f3dulo LCD \nSe encargar\u00e1 de mostrar la informaci\u00f3n que  le envia el microc ontrolador, tanto los \nmen\u00fas de configuraci\u00f3n, como la temperatura del m\u00f3dulo 1. \n \n- Pulsadores \nMediante unos pulsadores, el usua rio podr\u00e1 configurar el m\u00f3dulo 2. \n - Zumbador, \nEs el encargado de avisar al usuario cuando alguna alarma se activa. Como por \nejemplo: \n- Temperatura alta / baja del usuario. \n- Falta bater\u00eda en el m\u00f3dulo 1. \n -  El m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica  Es el encargado de recibir la informaci \u00f3n proporcionada por el m\u00f3dulo 1 y enviarla \nal microcontrolador. \n \n2.7.3  El m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica. \n Tal y como se ha evaluado en el m \u00f3dulo 1, el dispositivo inal\u00e1mbrico adecuada \npara la comunicaci\u00f3n en este tipo de aplicaci ones es un dispositivo que utilice la tecnolog\u00eda \nZigBee. \n  El m\u00f3dulo escogido es el Xbee de Maxstream,  la justificaci\u00f3n es la misma que para \nel m\u00f3dulo 1. \n \n2.7.4 El m\u00f3dulo LCD. \nLas pantallas de cristal l\u00edquido LCD o disp lay LCD para mensajes (Liquid Cristal \nDisplay) tienen la capacidad de mostrar cu alquier car\u00e1cter alfanum\u00e9rico, permitiendo \nrepresentar la informaci\u00f3n que genera cualqu ier equipo electr\u00f3nico de una forma f\u00e1cil y \necon\u00f3mica. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   60La pantalla consta de una matriz de caracteres (normalmente de 5x7 o 5x8 puntos) \ndistribuidos en una, dos, tres o cuatro l\u00edneas de 16 hasta 40 car\u00e1cteres cada l\u00ednea.  \n El proceso de visualizaci\u00f3n es gobernado por  un microcontrolador incorporado a la \npantalla, siendo el HITACHI 44780 el modelo  de controlador m\u00e1s utilizado. En la \nsiguiente figura se puede observa un LCD. \n \nFigura 1 : LCD de 2x16: est\u00e1 compuest o por 2 l\u00edneas de 16 car\u00e1cteres \n \nEn el presente proyecto se ha optado un un LCD de 2x16, ya que la cantidad de \ninformaci\u00f3n a mostrar es m\u00ednima. \n \nLas caracter\u00edsticas generales de un m\u00f3dulo LCD 16x2 son las siguientes: \n- Consumo muy reducido, del orden de 7\u20195 mW. \n- Pantalla de car\u00e1cteres ASCII, adem\u00e1s de los car\u00e1cteres japoneses kanji, car\u00e1cteres \ngriegos y s\u00edmbolos matem\u00e1ticos. \n- Desplazamiento de los car\u00e1cteres hacia la izquierda o a la derecha. \n- Memoria de 40 car\u00e1cteres por l\u00ednea de pa ntalla, visualiz\u00e1ndose 16 car\u00e1cteres por \nl\u00ednea. \n- Movimiento del cursor y c\u00e1mbio de su aspecto. \n- Permite que el usuario pueda programar 8 car\u00e1cteres. \n- Pueden ser gobernados de 2 formas principales: \n- Conexi\u00f3n con bus de 4 bits. \n- Conexi\u00f3n con bus de 8 bits. \n \nEn este caso, se ha optado por una conexi\u00f3n con bus de 4 bits. La ventaja frente al \nbus de 8 bits es su velocidad de transmisi\u00f3n de datos, sin em bargo, al ser la necesidad de \nvelocidad en la muestra de los datos en nue stra aplicaci\u00f3n baja, no es necesario una \nconexi\u00f3n de 8 bits. Adem\u00e1s, nos permite disponer de 4 pines m\u00e1s del microprocesador libres. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   61En la siguiente tabla, se presenta la de scripci\u00f3n de se\u00f1ales empleadas por el m\u00f3dulo \nLCD as\u00ed como el n\u00famero de patilla a la que corresponden. \n \nTabla 14.  Se\u00f1ales del m\u00f3dulo LCD \n \nEl m\u00f3dulo LCF posee una zona de memo ria RAM llamada DDRAM (Data Display \nRam) donde se almacenan los caracteres que se van a mostrar en la pantalla. \n Tiene una capacidad de 80 byt es, 40 por cada l\u00ednea, de los cuales s\u00f3lo 32 se pueden \nvisualizar a la vez (16 bytes por l\u00ednea). \n De las 80 posibles, las dos direccione s m\u00e1s importantes de  la DDRAM son: \n- Direcci\u00f3n 00h, que es el comienzo de la primera l\u00ednea \n- Direcci\u00f3n 40h, que es el comienzo de la segunda l\u00ednea. \n \nAdem\u00e1s de la DDRAM, el m\u00f3dulo LCD dis pone de una memoria interna no vol\u00e1til \nllamada CGROM donde se almacena una tabla con los 192 caracteres que pueden ser visualizados. \n Cada uno de los caracteres tiene su representaci \u00f3n binaria de 8 bits. Para visualizar un \ncar\u00e1cter debe recibir por el bus de  datos el c\u00f3digo correspondiente. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   62\n \nTabla 15.  Caracteres ASCII \n \nComo ya he comentado anteriormente, la  conexi\u00f3n del LCD al microcontrolador se \nrealizar\u00e1 mediante 4 bits, utilizaremos el puerto B del PIC para realizar esta conexi\u00f3n. \n Las conexiones son las siguientes: - Las 4 l\u00edneas superiores del m\u00f3dulo LCD, pines <DB7:DB4> se conectan a las 4 \nl\u00edneas del puerto B de la siguiente manera: \n- DB4 - PIN B4 \n- DB5 - PIN B3 \n- DB6 - PIN B2 \n- DB7 - PIN B1 \n- PIN RS del LCD a la l\u00ednea PIN B7 del PIC \n- PIN R/W del LCD a la l\u00ednea PIN B6 del PIC \n- PIN Enable del LCD a la l\u00ednea PIN B5 del PIC \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   63La siguiente figura muestra un ejemplo de  esquema de conexi\u00f3n del m\u00f3dulo LCD, \naunque no es la utilizada en el presente proyect o ya que en la figura se  utiliza el puerto D. \n \nFigura 35.  Conexi\u00f3n a 4 bits  \n \nPara su funcionamiento he utilizado la librer\u00eda que el compilador CCS ya incorpora \ncon subrutinas de control. \n \n2.7.5  Pulsadores \n Se han implementado 3 pulsadores mediante  los cuales el usuario puede acceder al \nmen\u00fa de la aplicaci\u00f3n y configurarla. \n  La denominaci\u00f3n de los pulsadores ser\u00e1:  \n- Pulsador 1 \u00c6  Menu / OK \n- Pulsador 2 \u00c6 Sig. + \n- Pulsador 3 \u00c6 Prev. \u2013 \n El circuito para implementar los pulsadores es el siguiente: \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   64R1\n10kPulsadorVCC\nPIN uC\n \nFigura 36. Esquema conexi\u00f3n pulsador \n \nPara evitar rebotes en la se\u00f1al durant e la pulsaci\u00f3n se implementa mediante \nsoftware un retardo en la siguiente lectur a del pulsador, evitando as\u00ed que en una misma \npulsaci\u00f3n se detecten varias. \n \n2.7.6 Zumbador \n El zumbador utilizado es un zumbador  (buzzer) electromec\u00e1nico. Se activar\u00e1 \nmediante un PIN del microcontrolador. Debido  a que la intensidad m\u00e1xima que puede \nproporcionar un pin a su salida es de 25 mA, utili zaremos un transistor NPN en la siguiente \nconfiguraci\u00f3n como interruptor. \n \nVCC\nQ1\nNPN BCER2\n1kPIN uCBUZZER1\n2\n \nFigura 37. Esquema conexi\u00f3n zumbador \n \n2.7.7 Alimentaci\u00f3n \nLos diferentes sistemas que forma el m\u00f3dulo se alimentan principalmente a 2 \ntensiones diferentes. \n El microcontrolador y el m\u00f3dulo Xbee y el zumbador se alimentan a 3,2 V mientras \nque el LCD se alimenta a 5 V. \n La tensi\u00f3n de alimentaci\u00f3n general la obt enemos de la red el\u00e9ctrica a 230V \u2013 50 Hz \ny mediante un transformador la pa samos 9 V de tensi\u00f3n continua. \n Mediante 2 reguladores de tensi \u00f3n obtenemos las tensiones deseadas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   65 El regulador LM317 es un regulador ajus table, con una tens i\u00f3n a su salida que \npuede ajustar entre los 1\u20192V y los 37V. Mediante el LM317 conseguimos la tensi\u00f3n de \n3\u20192V deseada. Su conexi\u00f3n t\u00edpica es la que ap arece en su hoja de caracter\u00edsticas y es la \nsiguientes: \n \n \nFigura 38. Montaje t\u00edpico LM317 \n \nDonde la tensi\u00f3n de salida Vou viene dada por la siguiente expresi\u00f3n: \n \n(9) \n \n Para la tensi\u00f3n de 5V, hemos elegi do el regulador L7805 que proporciona una \ntensi\u00f3n fija a su salida de 5V. \n  Su conexi\u00f3n t\u00edpica seg\u00fan su hoja de  caracter\u00edsticas es la siguiente: \n \n \nFigura 39. Montaje t\u00edpico 7805. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   66 Para evitar posibles conexiones incorrect as de la alimentaci\u00f3n, hemos colocado un \ndiodo en serie justo a la salida del transfor mador, as\u00ed evitamos la alimentaci\u00f3n inversa. \n     \n  \n \n \n                        Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   672.8 Manual de Funcionamiento \nPara operar con los equipos se deben segui r una serie de pasos que se enumeran a \ncontinuaci\u00f3n. \n 1- Conectar el m\u00f3dulo de sobremesa a la re d y poner el interrupt or en posici\u00f3n ON. \n2- La pantalla del LCD se encender\u00e1 y aparecer\u00e1n los comandos AT de \nconfiguraci\u00f3n del m\u00f3dulo Xbee. \n3- Una vez configurado aparecer\u00e1 sobre la pantalla el mensaje \u201cesperando dato\u201d. \n4- Una vez ha aparecido el mensaje \u201cesperando dato\u201d se procede a conectar el \ndispositivo inal\u00e1mbrico poniendo el  interruptor en posici\u00f3n ON. \n5- Tras unos segundo aparecer\u00e1 la temp eratura en la pantalla LCD. \n \nEn cualquier momento, y siempre despu\u00e9 s de configurarse el m\u00f3dulo Xbee del \ndispositivo de sobremesa, se puede entr ar al men\u00fa de confi guraci\u00f3n mediante el \npulsador \u201cMen\u00fa\u201d. \n El Men\u00fa presenta el sigu iente \u00e1rbol de submenus: \nMen\u00fa: \n 1- Alarma. Configura los par\u00e1metros de alarma de la temperatura. \n  1.1- T. Max. Dentro de este apartado se puede modificar el valor de \nalarma para la temperatura m\u00e1xima. \n  1.2- T. Min. Dentro de este apartado se puede modificar el valor de \nalarma para la temperatura m\u00ednima. \n  1.3- Act. Alarma. Dentro de este aparta do se puede activar o \ndesactivar la alarma sonora de temperatur a. Por defecto, cua ndo arranca el equipo \nest\u00e1 desactivada. \n  1.4- Salir. Sale del submenu alarma. \n 2- Term\u00f3metro. Dentro de este submenu se puede configurar el tiempo de \nmuestreo de la temperatura, un interval o de 5s m\u00ednimo a un intervalo de 60s. \n 3- Save conf. Dentro de este submenu se guarda la configuraci\u00f3n del \nusuario en la Eeprom del dispositivo. La si guiente vez que se enciende se carga la \n\u00faltima configuraci\u00f3n salvada. \n 4- Salir. Sale del men\u00fa. \n \n En caso de que una vez conectado el di spositivo de sobremesa pasen m\u00e1s de 2 \nminutos sin que se reciba se\u00f1al de dispositivo inal\u00e1mbrico, apar ece por pantalla la se\u00f1al de \n\u201cDispositivo no conectado o Baja Bateria\u201d. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   683 MEMORIA DE C\u00c1LCULO \nA partir de los elementos reflejados en la memoria descriptiva, se han desarrollado \ndos programas para los microcont roladores de los m\u00f3dulos 1 y 2. \nEl lenguaje utilizado es el CCS, ya que dispone de herramientas y librerias muy \n\u00fatiles y se trata de un le nguaje muy parecido al C. \nEl compilador utilizado es el  PCWHD versi\u00f3n 4.104 de CCS. \n \n3.1 Diagrama de Flujo M\u00f3dulo 1: Equipo  Inal\u00e1mbrico con Sensor de T\u00aa \n A continuaci\u00f3n se refleja el diagrama  de flujo del programa que gobierna el \nmicrocontrolador. \n En la primera y segunda figura se muestra el  diagrama de flujo de las interrupciones \ndel TIMER1 y de la UART. \n \nInicio interrupcion Timer1\nContador_timer ++\nSi contador_timer>tiempo_muestreo\nCargo Timer1muestrea_envia=1\ncontador_timer=0\nFin Interrupci\u00f3nSi\nNo\n \nFigura 40. Diagrama de flujo Interrupci\u00f3n TIMER1 \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   69 \nEl c\u00f3digo es el siguiente:  \n#int_TIMER1             //Vector de interrupci\u00f3n por TIMER1 \n(temporizador) \nvoid TIMER1_isr(void) {    contador_TIMER1++; \n if (contador_TIMER1>tiempo_de_muestreo) //500msx60=30s \nsegundos //(500ms*tiempo_de_muestreo =xx segundos) \n      {          muestrea_envia=1;          contador_TIMER1=0;       } \n   set_timer1(0x0BDC);  //Carga el timer1 \n} \n \nFuncionamiento: \nCada 500 ms se produce una interrupci\u00f3n por el Timer 1 del microcontrolador.  \nCuando entra en la interrupci\u00f3n, se increm enta un contador y se compara con el \ntiempo de muestreo preestablecido.  \nSi es mayor, entonces la variable muestrea_envia toma valor 1 y se pone a 0 el \ncontador. Esta variable, indi car\u00e1 al programa principal qu e puede muestrear la T\u00aa del \nsensor y enviarla al m\u00f3dulo de sobremesa. \nFinalmente, se carga el Timer1 con el valor 0x0BDC para que vuelva a generar una \ninterrupci\u00f3n a los 500 ms. \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   70Inicio Inte rrupci\u00f3n UART\nSi kbhit\ndato=getc()\ndato_recibido=1\nFin Interrupci\u00f3nSi\nNo\n \nFigura 41. Diagrama de flujo Interrupci\u00f3n UART \n \nEl c\u00f3digo es el siguiente: \n#int_rda           //Vector de interrupcion de la recepcion de \ndatos \nvoid rda_isr(void)     //por el usart {  \n   if (kbhit()) // si entra un dato \n   {          dato[indi]=getc();          aux[indi]=dato[indi];          indi++; \n         dato_recibido=1;      ; \n   } } \nFuncionamiento: \n Si se genera una interrupc i\u00f3n de la UART en primer l ugar miro si es debido a la \nentrada de un dato (if (kbhit)). \nSi se genera por la entrada de un dato, le o ese dato, hago una c opia en una variable \nauxiliar he indico al programa principal que he r ecibido un dato (dato_recibido=1). Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   71 \nEl siguiente diagrama de flujo muestra el programa principal. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   72Inicio\nInicio variables globales\nConfiguro Xbee\nSi \"recibo_dato=1\"\nDefino el tiempo de muestreo\nObtengo T\u00aa del sensor\nEnvio el dato\nConfiguro Timer1\nSi \"muestrea_envia=1\"\nuC modo bajo consumo Xbee modo normal\nObtengo T\u00aa del sensor\nEnvio el dato\nXbee bajo consumo\nmuestrea_envia=0\nMientras TrueSi\nSiNoNo\n \nFigura 42. Diagrama de flujo programa principal Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   73 El c\u00f3digo del programa principal es el siguiente: \nvoid main() \n{ \n   dato_recibido=0;    indice=0;    indi=0;    inicio_Xbee(); \n   while (dato_recibido==0) \n      {}    printf(\"z\");               // se\u00f1al para el coordinador de fin de \nconfiguracion \n   delay_ms(1000); \n   tiempo_de_muestreo=((aux[0]-48)*10)+(aux[1]-48); \n   delay_ms(1000);    muestrea();    envia();    inicio_TIMER1(); \n   do \n   {       if (muestrea_envia==1)       {          output_low(PIN_C5);  // PIN_C5 est\u00e1 conectado al SLEEP_RQ del \nXBee, si C5=0, lo despierta \n         delay_ms(20);        // El Xbee tarda 13'2 ms en despertarse, \nespero 20 ms \n         muestrea();          envia(); \n         output_high(PIN_C5); // Si C5=1->SLEEP_RQ=1, Xbee entra en modo \nsleep (<10 uA de consumo) \n         muestrea_envia=0;       }       else       { \n       SCS1=1; \n       SCS2=0;        IDLE=1;        sleep();            // Duermo el microcontrolador pero dejo \nfuncionando el TIMER1, cuando provoque interrupci\u00f3n despierta. \n      } \n   }while (TRUE); } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   74 \nFuncionamiento: \n En primer lugar iniciali zo las variables globales. \n Configuro el m\u00f3dulo Xbee mediante la  acci\u00f3n inicio_Xb ee(). Durante su \nconfiguraci\u00f3n, y para entrar en modo coma ndo, el m\u00f3dulo Xbee envia el comando +++ al \nm\u00f3dulo de sobremesa indicando que est\u00e1 conf igurando el m\u00f3dulo Xbee, cuando termina la \nconfiguraci\u00f3n envia el car\u00e1cter \u201cz\u201d, cuando \u00e9ste lo recibe, le env\u00eda un valor entero con el \ntiempo de muestreo deseado. \n En el bucle del while, se espera a recibi r este dato. Una vez recibido, se env\u00eda el \ncar\u00e1cter \u201cz\u201d al m\u00f3dulo de sobremesa para que sepa que se ha recibido correctamente el \nvalor del tiempo de muestreo, y de spu\u00e9s se actualiza ese valor. \n A continuaci\u00f3n, se activa el sensor, se toma el valor de la T\u00aa, se pone al sensor en \nbajo consumo y se env\u00eda ese valor por el m\u00f3dulo Xbee. \n Se configura el Timer1 para que genere  una interrupci\u00f3n cada 500 ms y se entra en \nun bucle cerrado infinito. \n En este bucle, se mira si la variable mues trea_envia toma el valor 1, si es as\u00ed, se \nsaca al m\u00f3dulo Xbee de su modo de bajo consumo,  se saca al sensor de su modo de bajo \nconsumo, se muestrea la T\u00aa, se pone al sensor en  modo de bajo consumo, se env\u00eda el dato y \nse vuelve a poner al m\u00f3dulo Xbee en modo de bajo consumo. Una vez enviado, \nmuestrea_envia vuelve a valer 0. \n La variable muestrea_envia toma el va lor 1 cuando el n\u00famero de interrupciones \nrealizadas por el timer 1 toma un valor supe rior a valor de tiempo de muestreo. En ese \nmomento, la interrupci\u00f3n pone muestrea_envia a 1 y vuelve a inicializar  el contador de \ninterrupciones. \n Si muestrea_envia est\u00e1 a 0, el microcont rolador entra en modo de bajo consumo. \n\u00danicamente despertar\u00e1 en la interrupci\u00f3n de l Timer1. Volver\u00e1 a an alizar el valor de \nmuestrea_envia, y si es 0 vol ver\u00e1 a modo de bajo consumo, sino, enviar\u00e1 la temperatura. \nEste ciclo lo realizar\u00e1 infinitamente. \n \nEl c\u00f3digo completo del programa se encuentra en el cap\u00edtulo de Anexos. \n \n3.2 Diagrama de Flujo M\u00f3dulo 2: M\u00f3dulo de Sobremesa \nPara representar el programa del m\u00f3dulo de  sobremesa se ha utilizado 3 diagramas \nde flujo. Los dos primeros representan los diagramas de flujo de las interrupciones \nprovocadas por el microcontrolador, mientras  que el \u00faltimo representa el desarrollo \nprincipal del programa. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   75Interrupci\u00f3n Timer1\nContador_timer1++\nSi (alarma=1) y (activar_alarma=1)\nSi contador_timer1>180\nCargo Timer1\nFin Interrupci\u00f3nDispositivo_no_conectado=1\nContador_timer1=0Si (contador_alarma=1)\nContador_alarma=0\nSuena alarmaContador_alarma=1\nDesactiva AlarmaNo\nNoSiSi\nSiNo\n \nFigura 43. Diagrama de flujo interrupci\u00f3n TIMER 1 \n \nEl c\u00f3digo es el siguiente: \n#int_TIMER1             //Vector de interrupci\u00f3n por TIMER1 \n(temporizador) \nvoid TIMER1_isr(void) { \n   contador_TIMER1++; \n   if ((alarma==1)&&(activar_alarma==1))       {          if (contador_alarma==1)             { \n            output_high(PIN_C2); \n            contador_alarma=0;             }          else          {             if (contador_alarma==0) \n               { \n               output_low(PIN_C2); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   76               contador_alarma=1; \n               } \n         }       }    if (contador_TIMER1>180) // 60 segundos (500ms*120=60 segundos)       { \n         disp_no_conectado=1; \n         contador_TIMER1=0;       }    set_timer1(0x0BDC);  //Carga el timer1 } \n \n Funcionamiento:  En el programa principal se carga el valor del Timer1 con el valor 0xBDC, con lo \nque conseguimos que se reali ce una interrupci\u00f3n cada 500 ms. \n Una vez dentro de la interrupci\u00f3n, se in crementa un contador. Cuando este contador \nes mayor al valor de 180, significa que no se ha recibido ning\u00fan mensaje del m\u00f3dulo \ninal\u00e1mbrico durante m\u00e1s de 60 segundos, por lo que se da la se\u00f1al de alarma de dispositivo \nno conectado. \n A su vez, si tenemos la alarma de te mperatura activada, cada 500 ms cambia el \nestado del zumbador, de activo a inactivo y viceversa, consiguiendo as\u00ed una se\u00f1al de \nalarma intermitente. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   77Inici Interrupci\u00f3n UART\nSi (comando=1)\ndato=getc()\naux=datodato=getc()\nrecibido=1\nFin Interrupci\u00f3nNoSi\n \nFigura 44. Diagrama de flujo interrupci\u00f3n UART \n \nEl c\u00f3digo es el siguiente: \n#int_rda                   //Vector de interrupcion de la recepcion \nde datos \nvoid rda_isr()     //por el usart {     if (comando==1)    { \n     if (kbhit()) \n      {       dato[indice]= getc();     //Se lee el dato recibido       indice++;       } \n   } \n   if (comando==0)    {      if (kbhit())       { \n         dato[indice]=getc(); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   78         aux[indice]=dato[indice]; \n         indice++; \n         recibido=1;       }    }   } \n \nFuncionamiento: \n Cuando se provoca la interrupci\u00f3n de la UAR T,  en primer lugar miro se el m\u00f3dulo \nse encuentra en modo comando, esto significa qu e est\u00e1 configurando el m\u00f3dulo Xbee. Si es \nas\u00ed, y tambien se da la condici\u00f3n de que la  interrupci\u00f3n es provocad a por una entrada de \ndatos, entonces guardo el dato en trante en la variable datos. \n  Si el m\u00f3dulo no se encuentra en modo co mando, y tambi\u00e9n se da la condici\u00f3n de \nque la interrupci\u00f3n es provocada por una entrada de datos, guardo ese dato en la variable \ndato, hago una copia de dato a una variable au xiliar, aux, e indico que  se ha recibido un \ndato. \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   79Inicio\nInicio LCD\nInicio variables\nInicio Xbee\nInicio Timer1\nSi (presiono Menu) Entro en menu()\nSi (recibido=1) Contador_timer1=0\nSi (dato[0]=+) ini_Xbee=0\nSi (dato[0]=x) Si (Xbee_ok=1) sensor_ok=0\nenvio t_muestreo\nini_Xbee=1sensor_ok=1\nenvio t_muestreo\nini_Xbee=1\nSi (dato[0]=z) sensor_ok=1\nSi Xbee_ok=1, sensor_ok=1, ini_Xbee=1\nescribe en LCD la T\u00aa\nEjecuta Alerta()\nSi dispositivo_no_conectado=1\nMientras (True)escribe en LCD\"No conectado\"\ndispositivo_no_conectado=0Si\nNo\nSi\nSi\nNo\nSi\nNo\nSi\nNoNo\nNoSi\n \nFigura 44. Diagrama de flujo programa Principal Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   80El c\u00f3digo es el siguiente: \nvoid main() \n{ \n   set_tris_c(00111000);   //0 = salida, 1 = entrada \n(Pin7,6,5,4,3,2,1,0) \n   int xbee_ok=0;    int sensor_ok=0; \n   int ini_xbee=0; \n   inicio_LCD();    inicio_variables();    inicio_Xbee();    inicio_TIMER1(); \n   do \n   {       // Si presiona el boton Menu (PIN C3) entra en Menu.       if (input(PIN_C3))          { \n         if (C3==-1) \n            C3++;          else{             opciones_menu();              } \n          }  \n      // Si recibo dato del sensor...       if ((recibido==1))          {             contador_TIMER1=0;      // El contador de sensor no \nconectado vuelve a cero.                                         \n            index=0;             // Si recibido la '+', indica que el Xbee del m\u00f3dulo \nsensor se est\u00e1 configurando \n            if (dato[0]=='+')                ini_xbee=0; \n            // Si recibido la 'x', envio t_muestreo e indico que el \nXbee del m\u00f3dulo sensor est\u00e1 configurado \n            if (dato[0]=='x')             {                if (xbee_ok==1) \n                  {   \n                     sensor_ok=0;                      printf(\"%d\",t_muestreo); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   81                     ini_xbee=1; \n                   } \n               else                   {                      xbee_ok=1;                      printf(\"%d\",t_muestreo); \n                     ini_xbee=1; \n                  }                for (index=0;index<8;index++)                {dato[index]='f';}             } \n            // Si recibido la 'z', el m\u00f3dulo sensor ha recibido el \ntiempo de muestreo \n            if (dato[0]=='z')             {                sensor_ok=1; \n               for (index=0;index<8;index++) \n                  {dato[index]='f';}             }             //Si del m\u00f3dulo sensor el Xbee y el sensor est\u00e1n \nconfigurados, recibo la temperatura y la muestro por pantalla. \n            if ((ini_xbee==1)&&(xbee_ok==1)&&(sensor_ok==1))  \n            {   \n               lcd_putc(\"\\f   Temp=\");                escribe_dato_lcd();                T_real=((aux[0]-48)*10)+(aux[1]-48)+((aux[3]-\n48)*0.1)+((aux[4]-48)*0.01); \n               alerta(); \n            }             index=0;             T_real=0;             delay_us(15); \n            recibido=0; \n            indice=0;          }     if (disp_no_conectado==1) \n      { \n      lcd_putc(\"\\fSENSOR NO CONECT\\n\");       lcd_putc(\"o BAJA BATERIA\\n\");       disp_no_conectado=0; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   82      } \n   }while (TRUE); \n} \n \nFuncionamiento: \nEn primer lugar, inicio va riables, el m\u00f3dulo LCD, el m\u00f3dulo Xbee y el timer 1. Este \n\u00faltimo lo configuro para que realice una interrupci\u00f3n cada 500 ms. \nUna vez configurado el timer 1 el programa en tra en un bucle infinito. Dentro de este \nbucle realiza secuencialmente varias acciones: \nSi se presiona el bot\u00f3n de men\u00fa, entonces entra en la opci\u00f3n men\u00fa. \nSi se ha recibido un dato, lo compara con varios caracteres: \n1- Si es un \u201c+\u201d, significa que el m\u00f3dul o inal\u00e1mbrico est\u00e1 configurando su m\u00f3dulo \nXbee.  \n2- Si es una \u201cx\u201d indica que el m\u00f3dulo in al\u00e1mbrico ha terminado de configurar su \nm\u00f3dulo Xbee, en ese momento se  envia el valor del tiempo de muestreo que se desea \nrealizar de la T\u00aa. \n3- Si recibe una \u201cz\u201d indi ca que el m\u00f3dulo inal\u00e1mbric o ha recibido ese dato \ncorrectamente. \n4- Si el m\u00f3dulo inalambrico ha configur ado su m\u00f3dulo Xbee y tiene el tiempo de \nmuestreo, se escribe el dato del sensor por pa ntalla y se ejecuta la funci\u00f3n alerta. Esta \ncompara la temperatura con un m\u00e1ximo y un m\u00ednimo y da una se\u00f1al de alarma. \n Si la variable dispositivo no conectado to ma valor 1, significa que hace m\u00e1s de 60 \nsegundos que no se ha recibido un dato del di spositivo inal\u00e1mbrico, por lo que se muestra \npor pantalla del LCD la se\u00f1a de DI SPOSITIVO NO CONECTADO O BAJA BATER\u00cdA. \n El c\u00f3digo completo se encuentra en el cap\u00edtulo de Anexos. \n \n     \n \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   833.3 Bater\u00eda M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico \nPara la alimentaci\u00f3n del m\u00f3dulo 1 se ha escogido un bater\u00eda de 3\u20196V, 2600mA, AA. \n Aunque existen en el mercado las pilas ti po bot\u00f3n, de menor ta ma\u00f1o, he considerado \nque al ser un prototipo susceptible de mejo ras y al que se le podr\u00edan a\u00f1adir nuevos \ncomponentes, la bater\u00eda a escoge r deb\u00eda estar sobredimensionada. \n La duraci\u00f3n aproximada de la bater\u00eda, en  funcionamiento continuo, y realizando un \nmuestreo de temperatura cada minuto ser\u00eda el siguiente: \n \nCaracter\u00edsticas de la pila:  Tensi\u00f3n: 3\u20196 V  Capacidad: 2600 mA/h  Elementos conectados y consumos:  \nModo Normal Modo bajo consumo\n11 2,50\n200 0,10\n45000 10\n45211 12,6(uA)\nDispositivos\nTotales (uA) =  PIC 18LF2525\nMCP9804\nXbee\n \nTabla 16. Consumos en modo normal y bajo consumo \n Suponiendo que el usuario desea una mues tra de temperatura cada minuto, y que \nadquirir esa muestra en el peor de los casos conllevar\u00e1 que los componentes funcionen en \nmodo normal durante menos de un segundo. \n Siendo: Tmn = tiempo (s) funcionamiento en modo normal Imn = consumo en modo normal Tbc = tiempo (s) funcionamiento en modo bajo consumo \nIbc = consumo en modo bajo consumo \n Suponemos Tmn = 1 s y Tbc=59s.  El consumo del equipo ser\u00e1: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   84Tbc TmnIbc Tbcn TmnConsumo+\u22c5+\u22c5=Im  (10) \n \nSustituyendo obtenemos un consumo de 0\u201977mA.  Dividiendo la capacidad de la bater\u00eda (mA/h) entre el consumo (mA), obtenemos las \nhoras de funcionamiento. \n El resultado son 3395 horas, aproxi madamente 4 meses y medio. \n Esta es la duraci\u00f3n del equipo si su func ionamiento fuese continuo. Si el uso \ndom\u00e9stico fuese igual que el de los term\u00f3metro s, su uso ser\u00eda espor\u00e1dico, por lo que el \ndispositivo podr\u00eda durar a\u00f1os con la misma bater\u00eda. \n Suponiendo su uso 10 d\u00edas al mes, durante 8 horas seguidas hacen un total de 80 \nhoras. Diviendo entre las 3395 horas, nos salen 42 meses, aproximadamente tres a\u00f1os y \nmedio. \n                  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   853.4 Datos experimentales \nSe ha comprobado el correcto funcionamien to del sensor y el envio de datos al \nm\u00f3dulo de sobremesa comparando la temperatura dada con la obtenida mediante un term\u00f3metro digital de farmacia. \n En la siguiente tabla se muestran los resultados obtenidos:  \nSensor Term\u00f3metro farmacia error\n36,18 36,2 0,02\n36,00 36 0,00\n36,05 36,1 0,05\n36,25 36,2 -0,0536,34 36,2 -0,14\u00ba C\n \nTabla 17.  Comparativa valores obtenidos. \n  Las muestras se han obtenido en diferentes d\u00edas. \n                \n \n   Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   864 PLANOS \n \nLa relaci\u00f3n de planos  es la siguiente: \n \nN\u00ba PLANO\nPlano n\u00ba 1\nPlano n\u00ba 2Plano n\u00ba 3Plano n\u00ba 4\nPlano n\u00ba 5\nPlano n\u00ba 6Disposici\u00f3n de elementos M\u00f3dulo 2: M\u00f3dulo de sobremesa\nFotograf\u00eda M\u00f3dulo 1\nFotograf\u00eda M\u00f3dulo 2Descripci\u00f3n\nEsquema M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico\nEsquema M\u00f3dulo 2: M\u00f3dulo de sobremesa\nDisposici\u00f3n elementos M\u00f3dulo 1: M\u00f3dulo Inal\u00e1mbrico\n \nTabla 18.  Relaci\u00f3n de planos. \n    \n \n                    Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n         8 7\n          N\u00ba Plano: Plano 1\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Esquema M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0V1 + 3V\nC6\n1nFV1 + 3VU7\nMCP9804SDA1\nSCL2\nAlert3\nGND4Vdd8\nA07\nA16\nA25\nSDASCLR10\n10k R910kV1 + 3V\nV1 + 3VV1 + 3V\nSDA\nSCL\nV1+3 '6VSWITCHV1 + 3V\nD3\nBAT54/SOT\nSW5\nV1 + 3VR11\n10kU5\nXBeeVcc1\nDout2\nDin3\nGND10SLEEP_RQ9U6\nPIC18LF2525MCLR/VPP/THV1RA0/AN02\nRA1/AN13\nRA2/AN2/VREF-4\nRA3/AN3/VREF+5\nRA4/T0CKI6\nRA5/SS/AN47\nGND8OSC1/CLKIN9OSC2/CLKOUT10RC0/T1OSO/T1CKI11\nRC1/T1OSI/CCP212\nRC2/CCP113\nRC3/SCK/SCL14\nRC4/SDI/SDA15\nRC5/SDO16\nRC6/TX /CK17\nRC7/RX /DT18\nGND19VDD20RB0/INT21\nRB122\nRB223\nRB3/PGM24\nRB425\nRB526\nRB6/PGC27\nRB7/PGD28RXTX\nTXRX\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   88 N\u00ba Plano: Plano 2\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Esquema M\u00f3dulo 2: M\u00f3dulo de sobremesa\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0U1\nPIC18LF2525MCLR/VPP/THV1RA0/AN02\nRA1/AN13\nRA2/AN2/VREF-4\nRA3/AN3/VREF+5\nRA4/T0CKI6\nRA5/SS/AN47\nGND8OSC1/CLKIN9OSC2/CLKOUT10RC0/T1OSO/T1CKI11\nRC1/T1OSI/CCP212\nRC2/CCP113\nRC3/SCK/SCL14\nRC4/SDI/SDA15\nRC5/SDO16\nRC6/TX /CK17\nRC7/RX /DT18GND19VDD20RB0/INT21\nRB122\nRB223\nRB3/PGM24\nRB425\nRB526\nRB6/PGC27\nRB7/PGD28+9V DC\nBNC12\nSW1SWITCH 1\nR1\n330\nD1LEDD2\nBAT48\nC1\n0.1uFC21uFU2 LM317/TO220\nVIN3\nADJ1VOUT2\nR8\n330\nR2\n10kV1 + 3'2VV2\nSW2 SW3V2 U3 7805\nVIN1VOUT3\nC3\n1uFC410uFV3 +5V\nR3\n10kR410k R510k\nV1 + 3'2V V1 + 3'2V V1 + 3'2V\nTX RX\nV1 + 3'2VSW4\nV1 + 3'2VR6\n10kJ2 LCD_PIN OUT 1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\nR710kV3 +5VR12\n10kQ1\nNPN BCELS1\nBUZZER12\nC5\n1nFV1 + 3'2V\nU4XBee\nVcc1\nDout2\nDin3\nGND10SLEEP_RQ9V1 + 3'2V\nTXRX\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   89 N\u00ba Plano: Plano 3\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Disposici\u00f3n elementos M\u00f3dulo 1: M\u00f3dulo Inal\u00e1mbrico\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0Pila 3'6V\nD3SwitchPIC 18LF2525\nXbeePort BPort C Port ASW5\nC8\nR10R11\nR9\nC6 UARTSensor\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   90 N\u00ba Plano: Plano 4\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Disposici\u00f3n de elementos M\u00f3dulo 2: M\u00f3dulo de sobremesa\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0D1C2\nD2\nU2 R8\nR2 SW4C1\nR6Port C\nPort BPortB LCDPortA\nU1 PIC 18LF2525\nUART\nC5\n+3'2V\nR12+9V\nBuzzerQ1U3C4C3R7R5R4R3SW2SW1\nSW3Xbee+3'2V UART+9 Vdc\nSwitch1R1\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   91 N\u00ba Plano: Plano 5\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Fotograf\u00eda M\u00f3dulo 1\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   92 N\u00ba Plano: Plano 6\nT\u00edtulo:\nEscala Proyecto: Versi\u00f3n\nFecha: 01/06/2011 Hoja 1/1Fotograf\u00eda M\u00f3dulo 2\nMonitorizaci\u00f3n wireless de las constantes\n vitales de un beb\u00e9 --:-- 0\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n    5 PRESUPUESTO \n5.1 Mediciones \nLas mediciones son el conjunto de todos los conceptos necesarios pa ra la ejecuci\u00f3n del \nproyecto, agrupando por separado todas a quellas unidades que s ean objeto del mismo \nprecio. \n \nLas mediciones del proyect o son las siguientes: \nITEM UNIDAD DESCRIPCI \u00d3NC A N T I D A D\n1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V,\n2400mAh1\n2 ud Suministro y montaje de KEYSTONE - 2460 - BATTERY HOLDER 1\n3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP - 8-\nBIT MCU, 48K FLASH, PDIP282\n4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\",\n28V\u00cdAS2\n5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR\nOSCILANTE, SPDT, ON-ON 2\n6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB,\n2.55N2\n7 ud Suministro y montaje de Resistencia 10 k \u2126, 0'25W, 1% 8\n8 ud Suministro y montaje de placa a topos de 160x100mm. 19 ud Suministro y montaje de sensor de temperatura MCP9804-E/MS. 1\n10 ud Suministro y montaje de placa MSOP a DIP para sensor. 1\n11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 2\n12 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 213 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS,\nMONTAJE PCB .1\n14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N,\n1.35mm.1\n15 ud Suministro y montaje de condensador electrol\u00edtico 0,1 uF, 16V. 1\n16 ud Suministro y montaje de condensador electrol\u00edtico 1 uF, 16V. 217 ud Suministro y montaje de condensador electrol\u00edtico 10 uF, 16V. 118 ud Suministro y montaje de condensador 1 nF. 219 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY,\nPEQUE\u00d1A SE\u00d1AL2\n20 ud Suministro y montaje de Resistencia 330 k \u2126, 0'25W, 1% 2\n21 ud Suministro y montaje de ptenciometro multivuelta 10 k \u2126.1\n22 ud Suministro y montaje de Interruptor MSP 121C N/A 650mA Negro 323 ud Suministro y montaje de led estandar amarillo 1\n24 ud Suministro y montaje de regulador de tensi\u00f3n LM317. 1\n25 ud Suministro y montaje de regulador de tensi\u00f3n 7805. 126 ud Suministro y montaje de LCD alfanum\u00e9rico de 2x16 127 ud Suministro, montaje y mecanizado de caja pl\u00e1stica.120x60x40mm. 128 Pa Peque\u00f1o material, cables\u2026 1MEDICIONES\n \n \n5.2 Cuadro de Precios Unitarios \nEn los Precios Unitarios figuran en letra y cifra los precios totales de cada una de las \nunidades que aparecen en la obra sin detallar su descomposici\u00f3n. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   94ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL\n1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V,\n2400mAh13 , 6 4 3 , 6 4\n(TRES EUROS Y SESENTA Y CUATRO C\u00c9NTIMOS )\n2 ud Suministro y monta je de KEYSTONE - 2460 - BATTERY HOLDER 1 1,53 1,53\n(UN EURO Y CINCUENTA Y TRES C\u00c9NTIMOS )\n3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP -\n8-BIT MCU , 48K FLASH , PDIP2816 , 4 7 6 , 4 7\n(SEIS EUROS Y CUARENTA Y SIETE EUROS )\n4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL,\n0.6\", 28V\u00cdAS11 , 5 8 1 , 5 8\n(UN EURO Y CINCUENTA Y OCHO C\u00c9NTIMOS )\n5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR\nOSCILANTE , SPDT , ON-ON 12 , 0 2 2 , 0 2\n(DOS EUROS Y DOS C\u00c9NTIMOS )\n6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB,\n2.55N10 , 8 9 0 , 8 9\n(OCHENTA Y NUEVE C\u00c9NTIMOS )\n7 ud Suministro y monta je de Resistencia 10 k \u2126, 0'25W, 1% 1 0,27 0,27\n(VEINTISIETE C\u00c9NTIMOS )\n8 ud Suministro y monta je de placa a to pos de 160x100mm. 1 4 4\n(CUATRO EUROS )\n9 ud Suministro y monta je de sensor de tem peratura MCP9804-E/MS. 1 4,15 4,15\n(CUATRO EUROS Y QUINCE C\u00c9NTIMOS )\n10 ud Suministro y monta je de placa MSOP a DIP para sensor. 1 1,55 1,55\n(UN EURO Y CINCUENTA Y CINCO C\u00c9NTIMOS )\n11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 1 17 17\n(DIECISIETE EUROS )\n12 ud Suministro y monta je de placa DIP para m\u00f3dulo Xbee. 1 2,7 2,7\n(DOS EUROS Y SETENTA C\u00c9NTIMOS )\n13 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS,\nMONTAJE PCB .11 , 7 9 1 , 7 9\n(UN EURO Y SETENTA Y NUEVE C\u00c9NTIMOS )\n14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N,\n1.35mm.11 , 41 , 4\n(UN EURO Y CUARENTA C\u00c9NTIMOS )\n15 ud Suministro y monta je de condensador electrol\u00edtico 0,1 uF, 16V. 1 0,75 0,75\n(SETENTA Y CINCO C\u00c9NTIMOS )\n16 ud Suministro y monta je de condensador electrol\u00edtico 1 uF, 16V. 1 0,75 0,75\n(SETENTA Y CINCO C\u00c9NTIMOS )\n17 ud Suministro y monta je de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,75\n(SETENTA Y CINCO C\u00c9NTIMOS )\n18 ud Suministro y monta je de condensador 1 nF. 1 0,75 0,75\n(SETENTA Y CINCO C\u00c9NTIMOS )\n19 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO,\nSCHOTTKY , PEQUE\u00d1A SE\u00d1AL10 , 7 1 0 , 7 1\n(SETENTA Y UN C\u00c9NTIMOS )\n20 ud Suministro y monta je de Resistencia 330 k \u2126, 0'25W, 1% 1 0,27 0,27\n(VEINTISIETE C\u00c9NTIMOS )PRECIOS DESCOMPUESTOS\n \n \n   Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   95ITEM UNIDAD DESCRIPCI \u00d3N CANTIDAD Prec. Unitario TOTAL\n21 ud Suministro y monta je de potenciometro multivuelta 10 k \u2126. 1 0,61 0,61\n(SESENTA Y UN C\u00c9NTIMOS )\n22 ud Suministro y monta je de Interru ptor MSP 121C N/A 650mA Ne gro 1 2,19 2,19\n(DOS EUROS CON DIECINUEVE C\u00c9NTIMOS )\n23 ud Suministro y monta je de led estandar amarillo 1 0,49 0,49\n(CUARENTA Y NUEVE C\u00c9NTIMOS )\n24 ud Suministro y monta je de re gulador de tensi\u00f3n LM317. 1 1,55 1,55\n(UN EURO CON CINCUENTA Y CINCO C\u00c9NTIMOS )\n25 ud Suministro y monta je de re gulador de tensi\u00f3n 7805. 1 1,27 1,27\n(UN EURO Y VEINTISIETE C\u00c9NTIMOS )\n26 ud Suministro y monta je de LCD alfanum\u00e9rico de 2x16 1 7,33 7,33\n(SIETE EUROS Y TREINTA Y TRES C\u00c9NTIMOS )\n27 ud Suministro, monta je y mecanizado de ca ja pl\u00e1stica.120x60x40mm. 1 16 16\n(DIECISEIS C\u00c9NTIMOS )\n28 Pa Pe que\u00f1o material, cables\u2026 1 4,6 4,6\n(CUATRO EUROS Y SEIS C\u00c9NTIMOS )PRECIOS DESCOMPUESTOS\n \n5.3 Cuadro de Precios Descompuestos \nEn el cuadro de precios descompuestos se de talla la descomposici\u00f3n de cada uno de los \nprecios que figura en el Cuad ro de Precios Unitarios. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   96ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL\n1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V,\n2400mAh13 , 6 4 3 , 6 4\nMaterial:\nud OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V, 2400mAh 1 3,64 3,64\nMano de obra:\nhr Horas traba jadas 0 12 0\nTotal 3,64\n2 ud Suministro y monta je de KEYSTONE - 2460 - BATTERY HOLDER 1 1,53 1,53\nMaterial:\nud KEYSTONE - 2460 - BATTERY HOLDER 1 0,93 0,93\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,53\n3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP -\n8-BIT MCU , 48K FLASH , PDIP282 6,47 12,94\nMaterial:\nud MICROCHIP - PIC18LF2525-I/SP - 8-BIT MCU, 48K FLASH, PDIP28 1 6,47 6,47\nMano de obra:\nhr Horas traba jadas 0 12 0\nTotal 6,47\n4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL,\n0.6\", 28V\u00cdAS21 , 5 8 3 , 1 6\nMaterial:\nud MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS 1 0,98 0,98\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,58\n5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR\nOSCILANTE , SPDT , ON-ON 22 , 0 2 4 , 0 4\nMaterial:\nud NKK SWITCHES - GW12RHP - INTERRUPTOR OSCILANTE, SPDT, ON-ON 1 1,42 1,42\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 2,02\n6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB,\n2.55N20 , 8 9 1 , 7 8\nMaterial:\nud ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N 1 0,29 0,29\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 0,89\n7 ud Suministro y monta je de Resistencia 10 k \u2126, 0'25W, 1% 8 0,27 2,16\nMaterial:\nud Resistencia 10 k \u2126, 0'25W, 1% 1 0,03 0,03\nMano de obra:\nhr Horas traba jadas 0,02 12 0,24\nTotal 0,27\n8 ud Suministro y monta je de placa a to pos de 160x100mm. 1 4 4\nMaterial:\nud placa a topos de 160x100mm. 1 44\nMano de obra:\nhr Horas traba jadas 0 12 0\nTotal 4PRECIOS DESCOMPUESTOS\n \n \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   97ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL\n9 ud Suministro y monta je de sensor de tem peratura MCP9804-E/MS. 1 4,15 4,15\nMaterial:\nud sensor de temperatura MCP9804-E/MS. 1 1,75 1,75\nMano de obra:\nhr Horas traba jadas 0,2 12 2,4\nTotal 4,15\n10 ud Suministro y monta je de placa MSOP a DIP para sensor. 1 1,55 1,55\nMaterial:\nud placa MSOP a DIP para sensor. 1 0,95 0,95\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,55\n11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 2 17 34\nMaterial:\nud m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 1 16,4 16,4\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 17\n12 ud Suministro y monta je de placa DIP para m\u00f3dulo Xbee. 2 2,7 5,4\nMaterial:\nud placa DIP para m\u00f3dulo Xbee. 1 2,1 2,1\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 2,7\n13 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS,\nMONTAJE PCB .11 , 7 9 1 , 7 9\nMaterial:\nud LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB . 1 1,19 1,19\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,79\n14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N,\n1.35mm.11 , 41 , 4\nMaterial:\nud LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N, 1.35mm. 1 0,8 0,8\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,4\n15 ud Suministro y monta je de condensador electrol\u00edtico 0,1 uF, 16V. 1 0,75 0,75\nMaterial:\nud condensador electrol\u00edtico 0,1 uF, 16V. 1 0,15 0,15\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 0,75\n16 ud Suministro y monta je de condensador electrol\u00edtico 1 uF, 16V. 2 0,75 1,5\nMaterial:\nud condensador electrol\u00edtico 1 uF, 16V. 1 0,15 0,15\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 0,75\n17 ud Suministro y monta je de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,75\nMaterial:\nud condensador electrol\u00edtico 10 uF, 16V. 1 0,15 0,15\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 0,75PRECIOS DESCOMPUESTOS\n \n \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   98ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL\n18 ud Suministro y monta je de condensador 1 nF. 2 0,75 1,5\nMaterial:\nud condensador 1 nF. 1 0,15 0,15\nMano de obra:\nhr Horas trabajadas 0,05 12 0,6\nTotal 0,75\n19 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO,\nSCHOTTKY , PEQUE\u00d1A SE\u00d1AL2 0,71 1,42\nMaterial:\nud STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL 1 0,11 0,11\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 0,71\n20 ud Suministro y monta je de Resistencia 330 k \u2126, 0'25W, 1% 2 0,27 0,54\nMaterial:\nud Resistencia 330 k \u2126, 0'25W, 1% 1 0,03 0,03\nMano de obra:\nhr Horas traba jadas 0,02 12 0,24\nTotal 0,27\n21 ud Suministro y monta je de potenciometro multivuelta 10 k \u2126. 1 0,61 0,61\nMaterial:\nud potenciometro multivuelta 10 k \u2126.1 0,25 0,25\nMano de obra:\nhr Horas traba jadas 0,03 12 0,36\nTotal 0,61\n22 ud Suministro y monta je de Interru ptor MSP 121C N/A 650mA Ne gro 3 2,19 6,57\nMaterial:\nud Interruptor MSP 121C N/A 650mA Negro 1 1,95 1,95\nMano de obra:\nhr Horas traba jadas 0,02 12 0,24\nTotal 2,19\n23 ud Suministro y monta je de led estandar amarillo 1 0,49 0,49\nMaterial:\nud led estandar amarillo 1 0,25 0,25\nMano de obra:\nhr Horas traba jadas 0,02 12 0,24\nTotal 0,49\n24 ud Suministro y monta je de re gulador de tensi\u00f3n LM317. 1 1,55 1,55\nMaterial:\nud regulador de tensi\u00f3n LM317. 1 0,95 0,95\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 1,55\n25 ud Suministro y monta je de re gulador de tensi\u00f3n 7805. 1 1,27 1,27\nMaterial:\nud re gulador de tensi\u00f3n 7805. 1 0,67 0,67\nMano de obra:\nhr Horas trabajadas 0,05 12 0,6\nTotal 1,27\n26 ud Suministro y monta je de LCD alfanum\u00e9rico de 2x16 1 7,33 7,33\nMaterial:\nud LCD alfanum\u00e9rico de 2x16 1 6,13 6,13\nMano de obra:\nhr Horas traba jadas 0,1 12 1,2\nTotal 7,33\n27 ud Suministro, monta je y mecanizado de ca ja pl\u00e1stica.120x60x40mm. 1 16 16\nMaterial:\nud ca ja pl\u00e1stica.120x60x40mm. 1 44\nMano de obra:\nhr Horas trabajadas 1 12 12\nTotal 16\n28 Pa Pe que\u00f1o material, cables\u2026 1 4,6 4,6\nMaterial:\nud Cable, conectores, esta\u00f1o \u2026 1 44\nMano de obra:\nhr Horas traba jadas 0,05 12 0,6\nTotal 4,6PRECIOS DESCOMPUESTOS\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   995.4 Presupuesto \nEl presupuesto es el siguiente: \nITEM UNIDAD DESCRIPCI \u00d3N CANTIDAD PRECIO UNITARIO PRECIO TOTAL\nM\u00f3dulo 1 : Equipo a bater\u00eda con sensor de \ntemperatura\n1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA,\nLITIO, AA, 3'6V, 2400mAh1 3,64 3,64\n2 ud Suministro y montaje de KEYSTONE - 2460 - BATTERY\nHOLDER1 1,53 1,53\n3 ud Suministro y montaje de microcontrolador de MICROCHIP -\nPIC18LF2525-I/SP - 8-BIT MCU, 48K FLASH, PDIP281 6,47 6,47\n4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1\n- Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS1 1,58 1,58\n5 ud Suministro y montaje de NKK SWITCHES - GW12RHP -\nINTERRUPTOR OSCILANTE, SPDT, ON-ON 1 2,02 2,02\n6 ud Suministro y montaje de condensador electrol\u00edtico 10uF, 16V. 1 0,75 0,757 ud Suministro y montaje de STMICROELECTRONICS - BAT48 -\nDIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL1 0,71 0,71\n8 ud Suministro y montaje de ALPS - SKHHARA010 -\nINTERRUPTOR, T\u00c1CTIL, PCB, 2.55N1 0,89 0,89\n9 ud Suministro y montaje de Resistencia 10 k \u2126, 0'25W, 1% 3 0,27 0,81\n10 ud Suministro y montaje de placa a topos de 160x100mm. 0,5 4 2\n11 ud Suministro y montaje de sensor de temperatura MCP9804-\nE/MS.1 4,15 4,15\n12 ud Suministro y montaje de placa MSOP a DIP para sensor. 1 1,55 1,55\n13 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW\ncon chip antena.11 7 1 7\n14 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 1 2,70 2,7\n15 Pa Peque\u00f1o material, cables\u2026 0,5 4,6 2,3\nTOTAL M\u00d3DULO 1 48,1\nM\u00f3dulo 2 : Equipo de sobremesa\n1 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA,\nCC, 90 GRADOS, MONTAJE PCB .1 1,79 1,79\n2 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO,\nBAJA TENSI \u00d3N, 1.35mm.11 , 4 1 , 4\n3 ud Suministro y montaje de microcontrolador de MICROCHIP -\nPIC18LF2525-I/SP - 8-BIT MCU, 48K FLASH, PDIP281 6,47 6,47\n4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1\n- Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS1 1,58 1,58\n5 ud Suministro y montaje de NKK SWITCHES - GW12RHP -\nINTERRUPTOR OSCILANTE, SPDT, ON-ON 1 2,02 2,02\n6 ud Suministro y montaje de condensador electrol\u00edtico 0,1 uF,\n16V.1 0,75 0,75\n7 ud Suministro y montaje de condensador electrol\u00edtico 1 uF, 16V. 2 0,75 1,5\n8 ud Suministro y montaje de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,759 ud Suministro y montaje de condensador 1 nF. 1 0,75 0,75\n10 ud Suministro y montaje de STMICROELECTRONICS - BAT48 -\nDIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL1 0,71 0,71\n11 ud Suministro y montaje de ALPS - SKHHARA010 -\nINTERRUPTOR, T\u00c1CTIL, PCB, 2.55N1 0,89 0,89\n12 ud Suministro y montaje de Resistencia 330 k \u2126, 0'25W, 1% 2 0,27 0,54\n13 ud Suministro y montaje de Resistencia 10 k \u2126, 0'25W, 1% 5 0,27 1,35\n14 ud Suministro y montaje de ptenciometro multivuelta 10 k \u2126. 1 0,61 0,61\n15 ud Suministro y montaje de placa a topos de 160x100mm. 1 4 4\n16 ud Suministro y montaje de Interruptor MSP 121C N/A 650mA\nNegro3 2,19 6,57\n17 ud Suministro y montaje de led estandar amarillo 1 0,49 0,49\n18 ud Suministro y montaje de regulador de tensi\u00f3n LM317. 1 1,55 1,55\n19 ud Suministro y montaje de regulador de tensi\u00f3n 7805. 1 1,27 1,2720 ud Suministro y montaje de LCD alfanum\u00e9rico de 2x16 1 7,33 7,33\n21 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW\ncon chip antena.11 7 1 7\n22 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 1 2,70 2,7\n23 ud Suministro, montaje y mecanizado de caja\npl\u00e1stica.120x60x40mm.11 6 1 6\n24 Pa Peque\u00f1o material, cables\u2026 0,5 4,6 2,3\nTOTAL M\u00d3DULO 2 80,32\nTOTAL PRESUPUESTO 128,42\n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   1005.5 Resumen del Presupuesto \nEl presupuesto para la ejecuci\u00f3n de los prototipos incluyendo el  material y la mano de obra \nde montaje asciende a 128\u201942 \u20ac. \n(CIENTO VEINTIOCHO EUROS CON CUARENTA Y DOS C\u00c9NTIMOS)  No se ha contemplado en el presupuesto las horas de dise\u00f1o y programaci\u00f3n de los \nprototipos. \n En caso de su fabricaci\u00f3n a gran escala el  precio de montaje descender\u00eda notablemente \ndebido sobre todo a: \n \n-\n Un mejor precio en la compra de los mate riales. La compra de grandes cantidades \nprovoca que los proveedores ajustan m\u00e1s sus precios. \nPor ejemplo:  \nPIC 18LF2525 :  1 ud 6\u201947 euros    100 ud 4\u201907 euros \nSe logra una rebaja en el precio de compra de un 37%. \n \n-\n Disminuci\u00f3n de la mano de obra en la fabricaci\u00f3n. En un proceso totalmente \nautomatizado la mano de obra para la fabricaci\u00f3n ser\u00eda pr\u00e1cticamente nula. \nPor ejemplo:  En este proyecto, la mano de obra imputada al total del presupuesto hace \nincrementar el total en un 26\u20197%. \n Considero que una producci\u00f3n en masa  podr\u00eda significar una reducci\u00f3n del \npresupuesto en un 53%, alcanzando un total de unos 59 euros los dos m\u00f3dulos. \n         Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   1016  CONCLUSIONES \nEl objetivo principal de este proyecto ha si do realizar un sistema de monitorizaci\u00f3n de \nla temperatura para bebes wire less. Este tipo de equipos no ex isten en el mercado actual a \nnivel dom\u00e9stico, aunque si se pueden en contrar aplicaciones espec\u00edficas a nivel \nhospitalario. \n Como objetivos secundarios se  pretend\u00eda conseguir que los equipos dise\u00f1ados tuviesen \nun coste, consumo de energ\u00eda  y tama\u00f1o m\u00ednimo. \n \nEl proyecto ha presentado dos fases bien diferenciadas. Una primera etapa en la que se \nha tenido que decidir la estruc tura de los m\u00f3dulos, se ha de finido el funcionamiento de \nambos y se han escogido los componentes adec uados. Y una segunda etap a en la que se ha \nrealizado la implementaci\u00f3n en una versi\u00f3 n de prototipo de los m\u00f3dulos y se ha \ncomprobado su funcionamiento.  \n Se ha dise\u00f1ado e implementado un m\u00f3dulo inal \u00e1mbrico, el cual dispone de un sensor \nde temperatura y funciona alimentado median te bater\u00eda, y un m\u00f3dulo de sobremesa, \nencargado de mostrar la lectura de temper atura y realizar un aviso sonoro en caso de \nalarma. En el m\u00f3dulo inal\u00e1mbrico la gesti\u00f3n de  la energ\u00eda ha sido un  factor determinante \nya que de ello depend\u00eda la  duraci\u00f3n de la bater\u00eda. \n Para la comunicaci\u00f3n wireles se  ha utilizado la tecnolog\u00eda Zigbee. Esta tecnolog\u00eda ha \nsido dise\u00f1ada para aplicaciones de  bajo consumo y baja tasa de transferencia de datos, por \nlo que la hac\u00eda ideal  para esta aplicaci\u00f3n. Se ha profundizado en la comunicaci\u00f3n mediante \nesta tecnolog\u00eda as\u00ed como en  la programaci\u00f3n de los micr ocontroladores en lenguaje C. \n Experimentalmente se ha comprobado el  correcto funcionamiento del sensor \ncomparando sus medidas con un term\u00f3metro digital de farmacia. Tambi\u00e9n se ha comprobado el rango de dist ancia alzanzado en la comuni caci\u00f3n, siendo los resultados \nsatisfactorios y mostrados en el proyecto. \n Se puede afirmar que se ha alcanzado el objetivo principal del proyecto de manera \nsatisfactoria. \n La posible producci\u00f3n de estos m\u00f3dulos a nivel comercial supondr\u00eda  rellenar un hueco \nen el mercado de los term\u00f3metros todav\u00eda si n explotar. Gracias a estos m\u00f3dulos, se puede \nmejorar el control de la temperatura en beb\u00e9 s. Por extensi\u00f3n, tambi\u00e9n se podr\u00eda aplicar a \nadultos enfermos o con minusval\u00edas. \n Durante el desarrollo del proyecto han surgido m\u00faltiples aplicaciones adem\u00e1s de la \ninicial y posibles mejoras. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   102Como posibles mejoras y aplicaciones indi car que la tecnolog\u00ed a Zigbee permite la \nrealizaci\u00f3n de redes de com unicaci\u00f3n con un \u00fanico m\u00f3dulo coordi nador, en nuestro caso el \nm\u00f3dulo de sobremesa. Con este tipo de red, se podr\u00eda monito rizar desde enfermer\u00eda a todos \nlos pacientes de una planta hospitalaria de ma nera continua, o una madre podr\u00eda controlar a \ntodos sus hijos. \n Otras posibles mejoras ser\u00eda la incorporaci\u00f3n  de nuevos sensores capaces de medir el \nritmo card\u00edaco, el ritmo resp iratorio e incluso la tensi \u00f3n sangu\u00ednea. Con estos nuevos \nsensores se podr\u00eda monitorizar las principales constantes vitales de beb\u00e9s, de enfermos, o \nincluso de deportistas de \u00e9lite. \n La muerte s\u00fabita causa m\u00faltiples muertes en los beb\u00e9s as\u00ed como en los deportistas de \n\u00e9lite. Los m\u00f3dulos multisensor podr\u00edan avisar  al personal m\u00e9dico cuando alguna de las \nconstantes vitales comenzasen a fallar, anticip\u00e1ndose el personal m\u00e9dico a la muerte s\u00fabita. \n \nConsidero que queda justificada la necesidad  de continuar desarrollando los prototipos \ndise\u00f1ados, mejor\u00e1ndolos en tama\u00f1o, precio y operatividad. \n A nivel personal he decidido realizar este proyecto ya que considero que una de las \nv\u00edas hacia una mejor atenci\u00f3n sanitaria tant o a nivel hospitalario como dom\u00e9stico, se \nrealiza a trav\u00e9s de  la prevenci\u00f3n y la vigilanc ia estrecha de las constantes vitales de los \nbeb\u00e9s y pacientes.  \n Por este motivo he pretendido desarrollar una herramienta que facilite a los padres la \nvigilancia de sus beb\u00e9s cuando estos se encuentren enfermos. \n          Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   1037 ANEXOS \n7.1 Programa en CCS M\u00f3dulo 1. \n \n#include <18F2525.h> \n#device adc=10//La resoluci\u00f3n del m\u00f3dulo A/D es de 8 bits. \n// SIN RELOJ EXTERNO #fuses INTRC_IO,PUT,BROWNOUT,NOWDT,NOPROTECT,NOLVP,NOMCLR,NOLVP #use delay(clock=4000000) #use RS232(BAUD=9600,XMIT=PIN_C6,RCV=PIN_C7) \n#use i2c(master,sda=PIN_C4,scl=PIN_C3,FORCE_HW) \n// LIBRERIAS #include <stdlib.h> // DECLARO FUNCIONES void inicio_Xbee(); \nvoid inicio_TIMER1(); \nvoid muestrea(); void envia(); void convierte_a_T(); // DECLARO VARIABLES \nint contador_TIMER1; \nint muestrea_envia; int indice; int Upper_data; int Low_data; \nfloat T; \nint dato_recibido; char dato[8]; char aux[8]; int tiempo_de_muestreo; \nint indi; \n // DECLARO REGISTROS #byte OSCCON=0xFD3   //Registro configuraci\u00f3n modo sleep() #bit IDLE=OSCCON.7 \n#bit SCS1=OSCCON.1 \n#bit SCS2=OSCCON.0  // DECLARO INTERRUPCIONES Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   104#int_rda           //Vector de interrupcion de la recepcion de datos \nvoid rda_isr(void)     //por el usart \n{     if (kbhit())    {          dato[indi]=getc(); \n         aux[indi]=dato[indi]; \n         indi++;          dato_recibido=1;      ;    } } \n \n#int_TIMER1             //Vector de interrupci\u00f3n por TIMER1 \n(temporizador) \nvoid TIMER1_isr(void) { \n   contador_TIMER1++; \n   if (contador_TIMER1>tiempo_de_muestreo) // 500msx60=30s segundos \n(500ms*tiempo_de_muestreo =xx segundos) \n      {          muestrea_envia=1;          contador_TIMER1=0; \n      } \n   set_timer1(0x0BDC);  //Carga el timer1 }  //FUNCION PRINCIPAL \nvoid main() \n{    dato_recibido=0;    indice=0;    indi=0; \n   inicio_Xbee(); \n   while (dato_recibido==0)       {}    printf(\"z\");               // se\u00f1al para el coordinador de fin de \nconfiguracion \n   delay_ms(1000); \n   tiempo_de_muestreo=((aux[0]-48)*10)+(aux[1]-48);    delay_ms(1000);    muestrea(); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   105   envia(); \n   inicio_TIMER1(); \n   do    {       if (muestrea_envia==1)       { \n         output_low(PIN_C5);  // PIN_C5 est\u00e1 conectado al SLEEP_RQ del \nXBee, si C5=0, lo despierta \n         delay_ms(20);        // El Xbee tarda 13'2 ms en despertarse, \nespero 20 ms \n         muestrea(); \n         envia(); \n         output_high(PIN_C5); // Si C5=1->SLEEP_RQ=1, Xbee entra en modo \nsleep (<10 uA de consumo) \n         muestrea_envia=0;       } \n      else \n      {        SCS1=1;        SCS2=0;        IDLE=1;        sleep();            // Duermo el microcontrolador pero dejo \nfuncionando el TIMER1, cuando provoque interrupci\u00f3n despierta. \n      }    }while (TRUE); }  \n//FUNCIONES \n void convierte_a_T() { \n//T = Temperatura ambiente ( \u001f\u00baC) \nT=0; \nif (bit_test(Low_data,0))    {T=T+0.0625;} if (bit_test(Low_data,1)) \n   {T=T+0.125;} \nif (bit_test(Low_data,2))    {T=T+0.25;} if (bit_test(Low_data,3))    {T=T+0.5;} Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   106if (bit_test(Low_data,4)) \n   {T=T+1;} \nif (bit_test(Low_data,5))    {T=T+2;} if (bit_test(Low_data,6))    {T=T+4;} \nif (bit_test(Low_data,7)) \n   {T=T+8;} if (bit_test(Upper_data,0))    {T=T+16;} if (bit_test(Upper_data,1)) \n   {T=T+32;} \nif (bit_test(Upper_data,2))    {T=T+64;} if (bit_test(Upper_data,3))    {T=T+128;} \n} \n  void envia() { printf(\"%2.2f\",T); \nprintf(\"f\"); \n}  void muestrea() { \n// Direcci\u00f3n sensor - lectura : 0x3F \n// Direcci\u00f3n sesnor - escritura: 0x3E // Config register - 0x01 i2c_start();         // Inicio comunicaci\u00f3n i2c_write(0x3E);     // Direcci\u00f3n escritura \ni2c_write(0x01);     // Direcci\u00f3n Conig register \ni2c_write(0x00);     // Sensor en modo continuo i2c_write(0x00);      i2c_stop(); delay_ms(5);          // Fin trama \n// Resolution register - 0x08 \ni2c_start();         // Inicio comunicaci\u00f3n i2c_write(0x3E);     // Direcci\u00f3n escritura Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   107i2c_write(0x08);     // Direcci\u00f3n Conig register \ni2c_write(0x03);     // Resolucion: 0'0625\u00baC  \ni2c_stop();          // Fin trama // Espero conversi\u00f3n delay_ms(350); // Leo conversi\u00f3n \ni2c_start(); // send START command \ni2c_write (0x3E); //WRITE Command (see Section 4.1.4) i2c_write(0x05); // Write TA Register Address i2c_start(); //Repeat START i2c_write(0x3F); // READ Command (see Section 4.1.4) \nUpper_data = i2c_read(1); // READ 8 bits \nLow_data = i2c_read(0); // READ 8 bits i2c_stop(); // send STOP command delay_ms(5); // Lectura realizada, duermo el sensor. \ni2c_start();         // Inicio comunicaci\u00f3n \ni2c_write(0x3E);     // Direcci\u00f3n escritura i2c_write(0x01);     // Direcci\u00f3n Conig register i2c_write(0x01);     // Sensor en modo shutdown i2c_write(0x00);      i2c_stop(); \ndelay_ms(5); \n// Convierto dato a grados cent\u00edgrados convierte_a_T();  } \n \nvoid inicio_TIMER1() { contador_TIMER1=0; muestrea_envia=0; \nsetup_timer_1(T1_INTERNAL|T1_DIV_BY_8);   //Setup timer: Reloj interno, \npreescaler= 8   \nenable_interrupts(INT_TIMER1);            //Habilito interrupci\u00f3n \nparticular del TIMER1   \nenable_interrupts(GLOBAL);                //Habilito interrupciones \nglobales \n// Desbordamiento_TIMER1=(4/frecuencia_oscilador)*Preescaler*(65536-TMR1) // Provocamos un desbordamiento del TIMER1 cada 500 ms. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   108set_timer1(0x0BDC);//Carga del TMR1 con el valor 3036, 0x0BDC en \nhexadecimal \n}  void inicio_Xbee() //Configuro Xbee { \n   enable_interrupts(int_rda); \n   enable_interrupts(global);    //Entro en modo comando    printf(\"+++\");    delay_ms(1500); \n   //La direcci\u00f3n  del m\u00f3dulo es BBBB \n   printf(\"ATMYBBBB\\r\");    delay_ms(1500);    // La direcci\u00f3n del m\u00f3dulo de destino es 0xAAAA    printf(\"ATDLAAAA\\r\"); \n   delay_ms(1500); \n   // La PAN ID es 0x3332    printf(\"ATID3332\\r\");    delay_ms(1500);    // Comunicaci\u00f3n entre el HOST y el MODEM es 9600 baudios    printf(\"ATBD3\\r\"); \n   delay_ms(1500); \n   // Se elige el canal 0x0C, canal 12.    printf(\"ATCHC\\r\");    delay_ms(1500);    // Se elige MODO SLEEP 1 controlado por un pin (1=sleep / 0=wake up). \n   printf(\"ATSM1\\r\"); \n   delay_ms(1500);    // Graba todos los par\u00e1metros en memoria     printf(\"ATWR\\r\");    delay_ms(1500); \n   // Sale del modo comando \n   printf(\"ATCN\\r\");    delay_ms(3000);    printf(\"x\");               // se\u00f1al para el coordinador de fin de \nconfiguracion \n} \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   1097.2 Programa en CCS M\u00f3dulo 2. \n#include <18F2525.h> \n// CON RELOJ EXTERNO \n//#fuses XT,NOWDT,NOPROTECT,NOLVP,PUT,BROWNOUT,MCLR // SIN RELOJ EXTERNO #fuses INTRC_IO,NOPUT,NOBROWNOUT,NOWDT,NOPROTECT,NOLVP,MCLR,NOLVP #use delay(clock=4000000) \n#use RS232(BAUD=9600,XMIT=PIN_C6,RCV=PIN_C7) \n// Conexiones uC con el LCD #define LCD_RS_PIN      PIN_B7 #define LCD_RW_PIN      PIN_B6 #define LCD_ENABLE_PIN  PIN_B5 \n#define LCD_DATA4       PIN_B4 \n#define LCD_DATA5       PIN_B3 #define LCD_DATA6       PIN_B2 #define LCD_DATA7       PIN_B1  \n \n// LIBRERIAS #include \"lcd_mod.c\" #include <stdlib.h> #include <internal_eeprom.c> \n \n// Valores predeterminados float const Tmax_default_valor=38.00;     // valor predeterminado como \nm\u00e1xima temperatura para alarma \nfloat const Tmin_default_valor=35.50;     // valor predeterminado como \nminima temperatura para alarma \nint const Sample_default_valor=60;        // valor mediante el cual se \nconfigura el tiempo de muestreo 60*500ms=30s \nint const Tmax_default_adress=0x0A;       // direcci\u00f3n de EEPROM donde se \nguarda la T\u00aa maxima elegida por el usuario \nint const Tmin_default_adress=0x14;       // direcci\u00f3n de EEPROM donde se \nguarda la T\u00aa minima elegida por el usuario \nint const Sample_default_adress=0x1E;       // direcci\u00f3n de EEPROM donde \nse guarda el tiempo de muestreo de la T\u00aa \nlong const pulsacion=300;                 // tiempo en ms que espera para \nevitar rebotes en los pulsadores \nint const primer_adress=0x28;             // direccion donde guardo si el \nprograma se ejecuta por primera vez \n // DECLARO FUNCIONES Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   110void inicio_LCD(); \nvoid inicio_Xbee(); \nvoid inicio_variables(); void escribe_dato_LCD(); void opciones_menu(); void t_config(); \nvoid inicio_TIMER1(); \nvoid alerta(); void activar_al(); void termometro();  \n// DECLARO VARIABLES \nchar dato[8]; char aux[8]; int fin_mensaje; int fin; \nint respuesta; \nint indice; int index; int comando; int temperatura; int recibido; \nint menu; \nfloat T_max; float T_min; float T_real; int alarma; \nint aceptar_opcion; \nint salir; int temp_maxima; long C3; int contador_TIMER1; \nint disp_no_conectado; \nint comienza; int contador_alarma; int activar_alarma; int t_muestreo; \nint ini_xbee; \n// DECLARO INTERRUPCIONES Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   111#int_TIMER1             //Vector de interrupci\u00f3n por TIMER1 \n(temporizador) \nvoid TIMER1_isr(void) {    contador_TIMER1++;    if ((alarma==1)&&(activar_alarma==1)) \n      { \n         if (contador_alarma==1)             {             output_high(PIN_C2);             contador_alarma=0; \n            } \n         else          {             if (contador_alarma==0)                { \n               output_low(PIN_C2); \n               contador_alarma=1;                }          }       }    if (contador_TIMER1>180) // 60 segundos (500ms*120=60 segundos) \n      { \n         disp_no_conectado=1;          contador_TIMER1=0;       }    set_timer1(0x0BDC);  //Carga el timer1 \n} \n #int_rda                   //Vector de interrupcion de la recepcion de \ndatos \nvoid rda_isr()     //por el usart \n{  \n   if (comando==1)    {      if (kbhit())       { \n      dato[indice]= getc();     //Se lee el dato recibido \n      indice++;       } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   112   } \n   if (comando==0) \n   {      if (kbhit())       {          dato[indice]=getc(); \n         aux[indice]=dato[indice]; \n         indice++;          recibido=1;       }    }   \n} \n //PROGRAMA PRINCIPAL void main() { \n   set_tris_c(00111000);   //0 = salida, 1 = entrada (Pin7,6,5,4,3,2,1,0) \n   int xbee_ok=0;    int sensor_ok=0;    int ini_xbee=0;    inicio_LCD();    inicio_variables(); \n   inicio_Xbee(); \n   inicio_TIMER1();    do    {       // Si presiona el boton Menu (PIN C3) entra en Menu. \n      if (input(PIN_C3)) \n         {          if (C3==-1)             C3++;          else{ \n            opciones_menu(); \n             }           }        // Si recibo dato del sensor...       if ((recibido==1)) \n         { \n            contador_TIMER1=0;      // El contador de sensor no conectado \nvuelve a cero.                                         Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   113            index=0; \n            // Si recibido la '+', indica que el Xbee del m\u00f3dulo sensor \nse est\u00e1 configurando \n            if (dato[0]=='+')                ini_xbee=0;             // Si recibido la 'x', envio t_muestreo e indico que el Xbee \ndel m\u00f3dulo sensor est\u00e1 configurado \n            if (dato[0]=='x')             {                if (xbee_ok==1)                   {   \n                     sensor_ok=0; \n                     printf(\"%d\",t_muestreo);                      ini_xbee=1;                    }                else \n                  { \n                     xbee_ok=1;                      printf(\"%d\",t_muestreo);                      ini_xbee=1;                   }                for (index=0;index<8;index++) \n               {dato[index]='f';} \n            }             // Si recibido la 'z', el m\u00f3dulo sensor ha recibido el tiempo \nde muestreo \n            if (dato[0]=='z') \n            { \n               sensor_ok=1;                for (index=0;index<8;index++)                   {dato[index]='f';}             } \n            //Si del m\u00f3dulo sensor el Xbee y el sensor est\u00e1n \nconfigurados, recibo la temperatura y la muestro por pantalla. \n            if ((ini_xbee==1)&&(xbee_ok==1)&&(sensor_ok==1))              {                  lcd_putc(\"\\f   Temp=\"); \n               escribe_dato_lcd(); \n               T_real=((aux[0]-48)*10)+(aux[1]-48)+((aux[3]-\n48)*0.1)+((aux[4]-48)*0.01); \n               alerta(); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   114            } \n            index=0; \n            T_real=0;             delay_us(15);             recibido=0;             indice=0; \n         } \n    if (disp_no_conectado==1)       {       lcd_putc(\"\\fSENSOR NO CONECT\\n\"); \n      lcd_putc(\"o BAJA BATERIA\\n\"); \n      disp_no_conectado=0;       }    }while (TRUE); } \n \n// FUNCIONES     void alerta() {    if (T_real<T_min) \n   { \n      alarma=1;       lcd_putc(\"\\n   TEMP.BAJA!\");    }    else \n   { \n      if (T_real>t_max)       {          alarma=1;          lcd_putc(\"\\n   TEMP.ALTA!\"); \n      } \n      else       {          alarma=0;          lcd_putc(\"\\n    TEMP.OK\"); \n      }   \n   } } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   115 \nvoid inicio_TIMER1() \n{ contador_TIMER1=0; setup_timer_1(T1_INTERNAL|T1_DIV_BY_8);   //Setup timer: Reloj interno, \npreescaler= 8   \nenable_interrupts(INT_TIMER1);            //Habilito interrupci\u00f3n \nparticular del TIMER1   \nenable_interrupts(GLOBAL);                //Habilito interrupciones \nglobales \n// Desbordamiento_TIMER1=(4/frecuencia_oscilador)*Preescaler*(65536-TMR1) \n// Provocamos un desbordamiento del TIMER1 cada 500 ms. \nset_timer1(0x0BDC);//Carga del TMR1 con el valor 3036, 0x0BDC en \nhexadecimal \n}  \nvoid inicio_LCD() \n{    delay_ms(1000);    lcd_init();    lcd_putc(\"\\fXBee Coordinador\\n\");    delay_ms(2000); \n} \n void inicio_Xbee() {    lcd_putc(\"\\fSetup: uC-->XBee\\n\"); \n   delay_ms(1000); \n   enable_interrupts(int_rda);    enable_interrupts(global);    comando=1;    //Entro en modo comando \n   printf(\"+++\"); \n   delay_ms(1500);    printf (lcd_putc,\"\\f%d)+++\\n \",comando);    indice=0;    escribe_dato_LCD(); \n   //La direcci\u00f3n  del m\u00f3dulo es AAAA \n   printf(\"ATMYAAAA\\r\");    delay_ms(1500);    printf (lcd_putc,\"\\fATMYAAAA\\n\"); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   116   indice=0; \n   escribe_dato_LCD(); \n   // La direcci\u00f3n del m\u00f3dulo de destino es 0xBBBB     printf(\"ATDLBBBB\\r\");    delay_ms(1500);    printf (lcd_putc,\"\\fATDLBBBB\\n\"); \n   indice=0; \n   escribe_dato_LCD();    // La PAN ID es 0x3332    printf(\"ATID3332\\r\");    delay_ms(1500); \n   printf (lcd_putc,\"\\fATID3332\\n\"); \n   indice=0;    escribe_dato_LCD();    // Comunicaci\u00f3n entre el HOST y el MODEM es 9600 baudios    printf(\"ATBD3\\r\"); \n   delay_ms(1500); \n   printf (lcd_putc,\"\\fATBD3\\n\");    indice=0;    escribe_dato_LCD();    // Se elige el canal 0x0C, canal 12.    printf(\"ATCHC\\r\"); \n   delay_ms(1500); \n   printf (lcd_putc,\"\\fATCHC\\n\");    indice=0;    escribe_dato_LCD();    // Graba todos los par\u00e1metros en memoria  \n   printf(\"ATWR\\r\"); \n   delay_ms(1000);    printf (lcd_putc,\"\\fATWR\\n\");    indice=0;    escribe_dato_LCD(); \n   // Sale del modo comando \n   printf(\"ATCN\\r\\f\");    delay_ms(1000);    printf (lcd_putc,\"\\fATCN\\n\");    indice=0; \n   escribe_dato_LCD(); \n   delay_ms(1000);    comando=0; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   117   lcd_putc(\"\\f.esperando dato.\\n\"); \n} \n void escribe_dato_LCD() { index=0; \n   for (index=0;index<8;index++) \n   {       if (dato[index]!='f')       {          printf (lcd_putc,\"%c\",dato[index]); \n         dato[index]='f'; \n      }    } }  \nvoid inicio_variables() \n{    activar_alarma=0;    contador_alarma=0;    aceptar_opcion=0;    C3=-1; \n   menu=0; \n   fin=0;    recibido=0;    temperatura=0;    fin_mensaje=0; \n   comando=1; \n   index=0;    indice=0;    respuesta=0;       // Inicializo las temperaturas m\u00e1xima y m\u00ednima de alarma. Un byte \nde la eeprom viene de f\u00e1brica con valor entero -1. Leo una posici\u00f3n de \nmemoria a la que llamo \n      // \"primer\", si vale -1 es que se ejecuta por primera vez el \nprograma y cargo las temperaturas iniciales, si es diferente de -1, cargo las que tenga guardada la eeprom. \nint primer; \nprimer=read_eeprom(primer_adress); if (primer==-1)    { Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   118   write_float_eeprom(Tmax_default_adress,Tmax_default_valor); \n   write_float_eeprom(Tmin_default_adress,Tmin_default_valor); \n   write_eeprom(Sample_default_adress,Sample_default_valor);    T_max=read_float_eeprom(Tmax_default_adress);    T_min=read_float_eeprom(Tmin_default_adress);    t_muestreo=read_eeprom(Sample_default_adress); \n   write_eeprom(primer_adress,5); \n   } else    {    T_max=read_float_eeprom(Tmax_default_adress); \n   T_min=read_float_eeprom(Tmin_default_adress); \n   t_muestreo=read_eeprom(Sample_default_adress);    }  alarma=0;    disp_no_conectado=0; \n   for (index=0;index<8;index++) \n   {   dato[index]='f';    }    index=0;    comienza=0; } \nvoid opciones_menu() \n{ lcd_putc(\"\\fConfiguracion:  \\n\"); long C4, C5; long opcion, sig, prev; \nint aceptar; \nC3=-1; C4=-1; C5=-1; opcion=100; \nsig=10; \nprev=10; aceptar=0; menu=1;  \ndo \n{    if (input (PIN_C3)) Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   119   { \n      if (C3==-1) \n         C3++;       else          aceptar=1;       } \n   if (input (PIN_C4)) \n   {       if (C4==-1)          C4++;       else \n         opcion=opcion+sig; \n      }    if (input (PIN_C5))    {       if (C5==-1) \n         C5++; \n      else          opcion=opcion-prev;       }    switch (opcion){       case 100: \n         lcd_gotoxy(1,2); \n         lcd_putc(\"1/4-> Alarma    \");          delay_ms(pulsacion);          if (aceptar==0){             prev=-40; \n            sig=10;} \n         else{             opcion=101;             aceptar=0;}          break; \n      case 101: \n         lcd_gotoxy(1,2);          lcd_putc(\"1/4->T. Max:    \");          delay_ms(pulsacion);          prev=-3; \n         sig=1; \n         if (aceptar==1){             temp_maxima=1; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   120            t_config(); \n            aceptar=0;} \n         break;       case 102:          lcd_gotoxy(1,2);          lcd_putc(\"2/4->T. Min:    \"); \n         delay_ms(pulsacion); \n         prev=1;          sig=1;          if (aceptar==1){             temp_maxima=0; \n            t_config(); \n            aceptar=0;}          break;       case 103:          lcd_gotoxy(1,2); \n         lcd_putc(\"3/4->Act Alarma \"); \n         delay_ms(pulsacion);          if (aceptar==0){             prev=1;             sig=1;}          else { \n            activar_al(); \n            aceptar=0;}          break;       case 104:          lcd_gotoxy(1,2); \n         lcd_putc(\"4/4-> Salir     \"); \n         delay_ms(pulsacion);          if (aceptar==0){             prev=1;             sig=-3;} \n         else { \n            opcion=100;             aceptar=0;}          break;         case 120: \n         lcd_gotoxy(1,2); \n         lcd_putc(\"2/4->Termometro \");          delay_ms(pulsacion); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   121         if (aceptar==0){ \n            prev=10; \n            sig=10;}          else {             termometro();             aceptar=0;} \n         break; \n      case 130:          lcd_gotoxy(1,2);          lcd_putc(\"3/4->Save conf. \");          delay_ms(pulsacion); \n         if (aceptar==0){ \n            prev=10;             sig=10;}          else{             write_float_eeprom(Tmax_default_adress,T_max); \n            delay_ms(2); \n            write_float_eeprom(Tmin_default_adress,T_min);             delay_ms(2);             write_eeprom(Sample_default_adress,t_muestreo);             delay_ms(2);             lcd_gotoxy(1,2); \n            lcd_putc(\"2/3-> SALVADO!  \"); \n            delay_ms(2000);             lcd_gotoxy(1,2);             int segundo;             segundo=(t_muestreo/10)*5; \n            printf (lcd_putc,\"%f,%f,%ds  \",T_max,T_min,segundo); \n            delay_ms(2000);             opcion=120;             aceptar=0;          } \n         break;                        \n      case 140:          lcd_gotoxy(1,2);          lcd_putc(\"4/4-> Salir     \");          delay_ms(pulsacion); \n         if (aceptar==0){ \n            prev=10;             sig=-40;} Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   122         else{ \n            menu=0; \n            aceptar=0;          }          break;       default: \n         break;} \n}while (menu==1); lcd_gotoxy(1,2); lcd_putc(\"Fin Menu        \"); delay_ms(3000); \nlcd_putc(\"\\f.esperando dato.\\n\"); \nC3=0; }  void activar_al() \n{ \nlong C4, C5; C3=-1; C4=-1; C5=-1; salir=1; \ndo { \n      if (input (PIN_C3))          {             if (C3==-1)                C3++; \n            else{ \n               salir=0;                delay_ms(pulsacion);}          }       if (input (PIN_C4)) \n         { \n            if (C4==-1)                C4++;             else{                if (activar_alarma==0) \n                  { \n                  activar_alarma=1;                   } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   123               else \n                  { \n                  activar_alarma=0;                   output_low(PIN_C2);                   }                delay_ms(pulsacion);} \n         } \n      if (input (PIN_C5))          {             if (C5==-1)                C5++; \n            else{ \n               if (activar_alarma==0)                   {                   activar_alarma=1;                   } \n               else \n                  {                   activar_alarma=0;                   output_low(PIN_C2);                   }                delay_ms(pulsacion);} \n            } \n         if (activar_alarma==0)          {              lcd_gotoxy(1,2);              lcd_putc(\"Alarma = NO     \"); \n         } \n         else          {              lcd_gotoxy(1,2);              lcd_putc(\"Alarma = SI     \"); \n         }       \n      }while (salir);    \n \n  Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   124} \n \nvoid t_config() { long C4, C5; C3=-1; \nC4=-1; \nC5=-1; if (temp_maxima) // Configuro la variable de la temperatura m\u00e1xima.    {    salir=1; \n   do { \n      if (input (PIN_C3))          {             if (C3==-1)                C3++; \n            else{ \n               salir=0;                delay_ms(pulsacion);}          }       if (input (PIN_C4))          { \n            if (C4==-1) \n               C4++;             else{                T_max=T_max+0.1;                delay_ms(200);} \n         } \n      if (input (PIN_C5))          {             if (C5==-1)                C5++; \n            else{ \n               T_max=T_max-0.1;                delay_ms(pulsacion);}           }       lcd_gotoxy(1,2); \n      printf (lcd_putc,\"T.Max Al.=%f\",T_max); \n      }while (salir);    } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   125else             // Configuro la variable de la temperatura m\u00ednima. \n   { \n   salir=1;    do {       if (input (PIN_C3))          { \n            if (C3==-1) \n               C3++;             else{                salir=0;                delay_ms(pulsacion);} \n         } \n      if (input (PIN_C4))          {             if (C4==-1)                C4++; \n            else{ \n               T_min=T_min+0.1;                delay_ms(pulsacion);}          }       if (input (PIN_C5))          { \n            if (C5==-1) \n               C5++;             else{                T_min=T_min-0.1;                delay_ms(pulsacion);} \n          } \n      lcd_gotoxy(1,2);       printf (lcd_putc,\"T.Min Al.=%f\",T_min);       }while (salir);    } \n} \n void termometro() { long C4, C5; \nint segundos; \nC3=-1; C4=-1; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   126C5=-1; \nsalir=1; \n   do {       if (input (PIN_C3))          {             if (C3==-1) \n               C3++; \n            else{                salir=0;                delay_ms(pulsacion);}          } \n      if (input (PIN_C4)) \n         {             if (C4==-1)                C4++;             else{ \n               t_muestreo=t_muestreo+10; \n               delay_ms(200);                if (t_muestreo>120)                   t_muestreo=10;                   }          } \n      if (input (PIN_C5)) \n         {             if (C5==-1)                C5++;             else{ \n               t_muestreo=t_muestreo-10; \n               delay_ms(pulsacion);                if (t_muestreo<10)                   t_muestreo=120;                 } \n          } \n      segundos=(t_muestreo/10)*5;       lcd_gotoxy(1,2);       printf (lcd_putc,\"T. temp(s)= %d   \",segundos);       }while (salir); \n} \n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9                              Autom\u00e1tica y Electr\u00f3nica Industrial  \n \n   1277.3 Ficheros \nEn el cd adjunto al proyecto se encuentr an todos los ficheros de programaci\u00f3n as\u00ed \ncomo las hojas de caracter\u00edsticas t\u00e9cnicas de los equipos empleados. \n ", "language": "PDF", "image": "PDF", "pagetype": "PDF", "links": "PDF"}